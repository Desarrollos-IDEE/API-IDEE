(()=>{var t={970:t=>{t.exports='<div id="m-beautytoc-container" class="m-control m-container m-beautytoc-container m-beautytoc">\n    <div class="m-beautytoc-panel" id="m-beautytoc-panel">\n        <div class="title">{{translations.layers}}</div>\n        <ul class="m-beautytoc-content">\n            <div class="vector-container">\n                <p>{{translations.vectoriallayers}}</p>\n                {{#each layers}}\n                    {{#if isOrtofoto }}\n                    {{else}}\n                        <li class="{{#if disabled}}disabled{{/if}} {{#if visible}}visible{{/if}}">\n                            <table class="{{#if visible}}active{{^}}{{/if}}">\n                                <tbody>\n                                    <tr>\n                                        <td class="m-title"><span>{{title}}</span></td>\n                                        <td class="m-beautytoc-eye"><span data-layer-name="{{id}}" class="{{#if visible}}icon-eye active{{^}}icon-eye-off{{/if}}"></span></td>\n                                    </tr>\n                                </tbody>\n                            </table>\n                        </li>\n                    {{/if}}\n                {{/each}}\n            </div>\n            <div class="historic-container">\n                <p>{{translations.ortofotos}}</p>\n                {{#each layers}}\n                    {{#if isOrtofoto }}\n                        <li class="{{#if disabled}}disabled{{/if}} {{#if visible}}visible{{/if}}">\n                            <table class="{{#if visible}}active{{^}}{{/if}}">\n                                <tbody>\n                                    <tr>\n                                        <td class="m-title"><span>{{title}}</span></td>\n                                        <td class="m-beautytoc-eye"><span data-layer-name="{{id}}" class="{{#if visible}}icon-eye active{{^}}icon-eye-off{{/if}}"></span></td>\n                                    </tr>\n                                </tbody>\n                            </table>\n                        </li>\n                    {{/if}}\n                {{/each}}\n            </div>\n        </ul>\n    </div>\n</div>'}},e={};function n(o){var r=e[o];if(void 0!==r)return r.exports;var i=e[o]={exports:{}};return t[o](i,i.exports,n),i.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";const t=JSON.parse('{"Pu":{"name":"BeautyTOC","description":"Table of contents of the map. Pretty design version","text":"Tabla de contenidos de fototeca. Consulta cobertura de vuelo sobre la vista","version":"2.0.0","date":"18/11/2019","author":"Guadaltel","org":"CNIG","tags":"mapea,plugin","icon":"./facade/assets/icons/icons.svg"}}');function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,r(o.key),o)}}function r(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,n||"default");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==e(n)?n:n+""}function i(t,n,o){return n=l(n),function(t,n){if(n&&("object"==e(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,a()?Reflect.construct(n,o||[],l(t).constructor):n.apply(t,o))}function a(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(a=function(){return!!t})()}function c(){return c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var o=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},c.apply(null,arguments)}function l(t){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},l(t)}function u(t,e){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},u(t,e)}var s=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),i(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e)}(e,M.impl.Control),n=e,(r=[{key:"addTo",value:function(t,n){c(l(e.prototype),"addTo",this).call(this,t,n)}},{key:"setScale",value:function(t){var e=[559082264.0287178,279541132.0143589,139770566.0071794,69885283.00358972,34942641.50179486,17471320.75089743,8735660.375448715,4367830.187724357,2183915.093862179,1091957.546931089,545978.7734655447,272989.3867327723,136494.6933663862,68247.34668319309,34123.67334159654,17061.83667079827,8530.918335399136,4265.459167699568,2132.729583849784],n=e.reduce((function(e,n){return Math.abs(n-t)<Math.abs(e-t)?n:e})),o=[156543.033928041,78271.51696402048,39135.75848201023,19567.87924100512,9783.93962050256,4891.96981025128,2445.98490512564,1222.99245256282,611.49622628141,305.7481131407048,152.8740565703525,76.43702828517624,38.21851414258813,19.10925707129406,9.554628535647032,4.777314267823516,2.388657133911758,1.194328566955879,.5971642834779395][e.indexOf(n)];this.facadeMap_.getMapImpl().getView().setResolution(o)}},{key:"reproject",value:function(t,e,n){return ol.proj.getTransform(e,n)(t)}},{key:"isLayerLoaded",value:function(t){return null!==t.getImpl().getOL3Layer()&&null!==t.getImpl().getOL3Layer().getSource()}},{key:"isLayerAvailable",value:function(t){var e=t.getImpl().getOL3Layer().getExtent(),n=this.facadeMap_.getBbox();return ol.extent.intersects([n.x.min,n.y.min,n.x.max,n.y.max],e)}}])&&o(n.prototype,r),a&&o(n,a),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,a}(),f=n(970),p=n.n(f);const y=JSON.parse('{"exception":{"cobertura":"Checking coverage in the area...","nocobertura":"This layer has no coverage in this area"},"tooltip":"Additional Layers","layers":"Additional Layers","vectoriallayers":"Vectorial layers","ortofotos":"Orthophotos","warning":"WARNING"}'),b=JSON.parse('{"exception":{"cobertura":"Comprobando cobertura en la zona...","nocobertura":"Esta capa no tiene cobertura en esta zona"},"tooltip":"Capas Adicionales","layers":"Capas Adicionales","vectoriallayers":"Capas vectoriales","ortofotos":"Ortofotos","warning":"AVISO"}');var d={en:y,es:b},v=function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e="es","function"==typeof M.language.getLang&&(e=M.language.getLang()),e),o=function(t){return"es"===t||"en"===t?d[t]:M.language.getTranslation(t).beautytoc}(n),r="";return M.utils.isNullOrEmpty(o)?console.warn("The translation '".concat(n,"' has not been defined.")):r=t.split(".").reduce((function(t,e){return t[e]}),o),r};function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function h(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,g(o.key),o)}}function g(t){var e=function(t,e){if("object"!=m(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=m(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==m(e)?e:e+""}function w(t,e,n){return e=T(e),function(t,e){if(e&&("object"==m(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,O()?Reflect.construct(e,n||[],T(t).constructor):e.apply(t,n))}function O(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(O=function(){return!!t})()}function S(){return S="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var o=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=T(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},S.apply(null,arguments)}function T(t){return T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},T(t)}function _(t,e){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_(t,e)}var j=function(t,e,n,o){var r=t.querySelectorAll(e);Array.prototype.forEach.call(r,(function(t){return t.addEventListener(n,(function(t){return o(t)}))}))},P=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),w(this,e,[new s,"BeautyTOC"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_(t,e)}(e,M.Control),n=e,o=[{key:"createView",value:function(t){var e=this;return this.map_=t,new Promise((function(t,n){var o=e.getTemplateVariables(),r=M.template.compileSync(p(),{vars:o});e.panelHTML_=r,t(r),j(e.panelHTML_,"li","click",(function(t){return e.toogleVisible(t)}))}))}},{key:"getTemplateVariables",value:function(){return{layers:this.map_.getWMS().concat(this.map_.getWMTS()).filter((function(t){return!1!==t.transparent&&!0===t.displayInLayerSwitcher})).map((function(t){return{visible:t instanceof M.layer.WMTS?!0===t.options.visibility:t.isVisible(),id:t.name,title:t.legend||t.name,type:t.type,url:t.url,isOrtofoto:"https://www.ign.es/wms/pnoa-historico?"===t.url}})),translations:{layers:v("layers"),vectoriallayers:v("vectoriallayers"),ortofotos:v("ortofotos")}}}},{key:"getLayerDisabled",value:function(t){var e=!1;return this.getImpl().isLayerLoaded(t)&&(e=e||!t.inRange()||!this.getImpl().isLayerAvailable(t)),e}},{key:"render",value:function(t){var e=this,n=this.getTemplateVariables(),o=M.template.compileSync(p(),{vars:n});this.panelHTML_.innerHTML=o.innerHTML,j(this.panelHTML_,"li","click",(function(t){return e.toogleVisible(t)})),void 0!==t&&(document.querySelector("#m-beautytoc-panel").scrollTop=t)}},{key:"toogleVisible",value:function(t){var e=this,n=this.map_.getBbox(),o=[n.x.min,n.y.min,n.x.max,n.y.max],r=document.querySelector("#m-beautytoc-panel").scrollTop,i=t.currentTarget.querySelector(".m-beautytoc-eye span").dataset.layerName,a=this.map_.getLayers({name:i}).filter((function(t){return t.displayInLayerSwitcher})),c=a.length>0?a[0]:null;if(null===c||"https://www.ign.es/wms/pnoa-historico?"!==c.url||c.isVisible()){if(null!==c){var l=c instanceof M.layer.WMTS?c.options.visibility:c.isVisible();c.setVisible(!l),c.options.visibility=!l,this.render(r)}}else{var u=document.querySelector(".m-mapea-container").offsetWidth,s=document.querySelector(".m-mapea-container").offsetHeight,f=c.url.concat("SERVICE=WMS&VERSION=").concat(c.version).concat("&REQUEST=GetMap&FORMAT=image/png&TRANSPARENT=true&LAYERS=").concat(c.name).concat("&TILED=true&CRS=").concat(this.map_.getProjection().code).concat("&STYLES=&WIDTH=").concat(u).concat("&HEIGHT=").concat(s).concat("&BBOX=").concat(o.join(","));M.dialog.info(v("exception.cobertura")),setTimeout((function(){document.querySelector("div.m-dialog > div > div > div.m-button").innerHTML=""}),10),M.proxy(!1),M.remote.get(f).then((function(t){M.proxy(!0);var n=Buffer.from(t.text).toString("base64"),o=document.createElement("img");if(o.src="data:image/png;base64,".concat(n),o.outerHTML.length>u*s/100){var i=document.querySelectorAll("div.m-dialog");Array.prototype.forEach.call(i,(function(t){t.parentElement.removeChild(t)}));var a=c instanceof M.layer.WMTS?c.options.visibility:c.isVisible();c.setVisible(!a),c.options.visibility=!a,e.render(r)}else setTimeout((function(){M.dialog.error(v("exception.nocobertura"),v("warning"))}),10)})).catch((function(t){M.proxy(!0)}))}}},{key:"activate",value:function(){S(T(e.prototype),"activate",this).call(this)}},{key:"deactivate",value:function(){S(T(e.prototype),"deactivate",this).call(this)}},{key:"getActivationButton",value:function(t){return t.querySelector(".m-beautytoc button")}},{key:"equals",value:function(t){return t instanceof e}}],o&&h(n.prototype,o),r&&h(n,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,o,r}();function E(t){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E(t)}function L(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,x(o.key),o)}}function x(t){var e=function(t,e){if("object"!=E(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=E(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==E(e)?e:e+""}function k(t,e,n){return e=C(e),function(t,e){if(e&&("object"==E(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,R()?Reflect.construct(e,n||[],C(t).constructor):e.apply(t,n))}function R(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(R=function(){return!!t})()}function C(t){return C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},C(t)}function A(t,e){return A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},A(t,e)}var B=function(e){function n(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(e=k(this,n)).map_=null,e.controls_=[],e.position_=o.position||"TR",e.collapsed_=!0===o.collapsed,e.metadata_=t.Pu,e.tooltip_=o.tooltip||v("tooltip"),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&A(t,e)}(n,M.Plugin),o=n,i=[{key:"getJSONTranslations",value:function(t){return"en"===t||"es"===t?"en"===t?y:b:M.language.getTranslation(t).beautytoc}}],(r=[{key:"addTo",value:function(t){var e=this;this.control=new P,this.map_=t,this.panel_=new M.ui.Panel("panelBeautyTOC",{collapsible:!0,position:M.ui.position[this.position_],collapsedButtonClass:"icon-capas2",className:"m-plugin-beautytoc",tooltip:this.tooltip_,collapsed:this.collapsed_}),this.panel_.addControls([this.control]),t.addPanels(this.panel_),t.on(M.evt.ADDED_LAYER,(function(){e.control.render()})),t.on(M.evt.COMPLETED,(function(){e.control.render()}))}},{key:"position",get:function(){return this.position_}},{key:"name",get:function(){return"beautytoc"}},{key:"collapsed",get:function(){return this.panel_.isCollapsed()}},{key:"getAPIRest",value:function(){return"".concat(this.name,"=").concat(this.position,"*").concat(this.collapsed)}},{key:"equals",value:function(t){return t instanceof n}},{key:"getMetadata",value:function(){return this.metadata_}},{key:"destroy",value:function(){this.map_.removeControls(this.control);var t=[null,null,null];this.map_=t[0],this.control=t[1],this.panel_=t[2]}}])&&L(o.prototype,r),i&&L(o,i),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,r,i}();window.M.plugin||(window.M.plugin={}),window.M.control||(window.M.control={}),window.M.plugin.BeautyTOC=B,window.M.control.BeautyTOCControl=P})()})();
//# sourceMappingURL=beautytoc.ol.min.js.map
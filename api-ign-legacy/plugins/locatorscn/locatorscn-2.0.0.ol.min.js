(()=>{var e={799:e=>{e.exports='{{#if noresults}}\r\n<p class="m-ignsearchlocatorscn-noresults">{{translations.noresults}}</p>\r\n{{else}}\r\n<ul id="m-ignsearchlocatorscn-results-list">\r\n    {{#each places}}\r\n        {{#if this.address}}\r\n            {{#printType this.type this.address this.id this.municipality this.cps}}\r\n            {{/printType}}\r\n        {{else}}\r\n            {{#printType this.type this.title this.id this.municipality this.cps}}\r\n            {{/printType}}\r\n        {{/if}}\r\n    {{/each}}\r\n</ul>\r\n{{/if}}'},251:e=>{e.exports='<div class="m-ignsearchlocatorscn-popup">\r\n    <div class="m-ignsearchlocatorscn-small">\r\n        {{#if addressData.id}}\r\n        <div>Id: {{addressData.id}}</div>\r\n        {{/if}}\r\n        {{#if addressData.native.properties.layer}}\r\n        <div>Capa: {{addressData.native.properties.layer}}</div>\r\n        {{/if}}\r\n        {{#if addressData.geom}}\r\n        <div>{{addressData.geom}}</div>\r\n        {{/if}}\r\n    </div>\r\n    <b class="m-ignsearchlocatorscn-bold"></span> {{addressData.address}}</b>\r\n    <hr>\r\n    <div class="m-ignsearchlocatorscn-standard">\r\n        {{#if addressData.native.properties.name}}\r\n        <div><span>NOMVIA: </span> {{addressData.native.properties.street}}</div>\r\n        {{/if}}\r\n        {{#if addressData.portalNumber}}\r\n        <div><span>NUMERO: </span> {{addressData.portalNumber}}</div>\r\n        {{/if}}\r\n        {{#if addressData.postalCode}}\r\n        <div><span>CODPOSTAL: </span> {{addressData.postalCode}}</div>\r\n        {{/if}}\r\n        {{#if addressData.comunidadAutonoma}}\r\n        <div><span>CA: </span> {{addressData.comunidadAutonoma}}</div>\r\n        {{/if}}\r\n        {{#if addressData.province}}\r\n        <div><span>PROVINCIA: </span> {{addressData.province}}</div>\r\n        {{/if}}\r\n        {{#if addressData.muni}}\r\n        <div><span>MUNICIPIO: </span> {{addressData.muni}}</div>\r\n        {{/if}}\r\n        {{#if addressData.native.properties.locality}}\r\n        <div><span>NIVEL1: </span> {{addressData.native.properties.locality}}</div>\r\n        {{/if}}\r\n        {{#if addressData.native.properties.neighbourhood}}\r\n        <div><span>NIVEL2: </span> {{addressData.native.properties.neighbourhood}}</div>\r\n        {{/if}}\r\n        {{#if addressData.native.properties.source}}\r\n        <div><span>PROVEEDOR: </span> {{addressData.native.properties.source}}</div>\r\n        {{/if}}\r\n        {{#if addressData.lng}}\r\n        <div><span>LONGITUD: </span> {{addressData.lng}}</div>\r\n        {{/if}}\r\n        {{#if addressData.lat}}\r\n        <div><span>LATITUD: </span> {{addressData.lat}}</div>\r\n        {{/if}}\r\n    </div>\r\n    <hr>\r\n    <div id="m-ignsearchlocatorscn-addendum" class="m-ignsearchlocatorscn-standard">\r\n    </div>\r\n</div>'},846:e=>{e.exports='<div id="m-ignsearch-panel">\r\n    <input type="text" tabindex="0" id="m-ignsearchlocatorscn-search-input" class="m-input-search" autocomplete="off" title="{{placeholder}}" placeholder="{{placeholder}}" />\r\n    {{#if reverse}}\r\n    <button type="button" tabindex="0" id="m-ignsearchlocatorscn-locate-button" title="{{translations.get_direction}}">\r\n        <i class="locatorscn-icon-locate"></i>\r\n    </button>\r\n    {{/if}}\r\n    <button type="button" tabindex="0" id="m-ignsearchlocatorscn-clean-button" title="{{translations.clean}}">\r\n        <i class="locatorscn-icon-remove"></i> {{translations.clean}}\r\n    </button>\r\n    <div id="m-ignsearchlocatorscn-results">\r\n        \x3c!-- Here goes the list of search results --\x3e\r\n    </div>\r\n</div>'},4:e=>{e.exports='<div aria-label="Plugin Locatorscn" role="menuitem" id="div-contenedor-locatorscn" class="m-control m-container m-locatorscn">\n    {{#if showTitle}}\n        <div role="heading" tabindex="0" id="m-locatorscn-title">{{translations.headertitle}}</div>\n    {{/if}}\n    <div id="m-locatorscn-previews" class="m-hidden">\n        {{#if byPlaceAddressPostal}}\n            <div tabindex="0" id="m-locatorscn-ignsearch" title="{{translations.ignsearch}}" class="locatorscn-icon-ignsearch m-hidden"></div>\n        {{/if}}\n    </div>\n</div>'}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var i=t[o]={exports:{}};return e[o](i,i.exports,r),i.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=r(846),t=r.n(e),o=r(799),n=r.n(o),i=r(251),a=r.n(i);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function c(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,l(o.key),o)}}function l(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=s(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==s(t)?t:t+""}function u(e,t,r){return t=d(t),function(e,t){if(t&&("object"==s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,p()?Reflect.construct(t,r||[],d(e).constructor):t.apply(e,r))}function p(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(p=function(){return!!e})()}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}function h(e,t){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},h(e,t)}var f=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=u(this,t)).facadeMap_=e,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(t,M.impl.Control),r=t,(o=[{key:"readFromWKT",value:function(e){var t=(new ol.format.WKT).readFeature(e.geom,{dataProjection:"EPSG:4326",featureProjection:this.facadeMap_.getProjection().code}),r=e;return t.setId("f".concat((new Date).getTime())),t.setProperties(r),this.wrapComplexFeature(t),t}},{key:"wrapComplexFeature",value:function(e){var t=e.getGeometry();if(t.getType()===M.geom.wkt.type.POLYGON||t.getType()===M.geom.wkt.type.MULTI_POLYGON){var r;r=t.getType()===M.geom.wkt.type.POLYGON?t.getInteriorPoint():t.getInteriorPoints();var o=new ol.geom.GeometryCollection([r,t]);e.setGeometry(o)}}},{key:"reprojectReverse",value:function(e,t,r){return ol.proj.getTransform(t,r)(e)}},{key:"reproject",value:function(e,t){var r=ol.proj.get(e),o=ol.proj.get(this.facadeMap_.getProjection().code),n=ol.proj.transform(t,r,o);return n=[this.normalizeNumber(t[0],n[0]),this.normalizeNumber(t[1],n[1])]}},{key:"normalizeNumber",value:function(e,t){var r=e;return 0!==e&&(r=parseFloat(t.toFixed(9))),r}}])&&c(r.prototype,o),n&&c(r,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o,n}();const y=JSON.parse('{"exception":{"impl":"The implementation used cannot create LocatorscnControl.","impl_infocatastro":"The implementation used cannot create InfoCatastroControl.","impl_xylocatorscn":"The implementation used cannot create XYLocatorscnControl.","impl_ignsearchlocatorscn":"The implementation used cannot create IGNSearchLocatorscnControl.","no_controls":"The Locatorscn plugin needs to activate at least one control.","wrong_coords":"The coordinates entered are not correct.","transforming":"Error performing the transformation.","wrong_values":"Some value entered are not correct. Remember that minutes and seconds must be between 0 and 59 and degrees between 0 and 180.","mapeaerror":"It is not possible to establish a connection with the Cadastre server.","no_province":"You must select a province.","no_mun":"You must select a municipality.","no_polygon":"You must select an polygon.","no_parcel":"You must select a parcel.","json_invalid":"The response is not a valid JSON:","no_refcatastro":"You must enter a cadastral reference.","noInfo":"NO REFERENCES AVAILABLE FOR THESE COORDINATES","noresults":"No results found","no_direction":"No address","error_findjsonp":"Error in the findJSONp service request.","error_candidates":"Error in the candidatesJSONp service request."},"tooltip":"Locatorscn","xylocatorscn":"Search by coordinates","geographic":"Geographic","zone":"zone","dms":"DMS","dd":"DD","srs":"Coordinate system","longitude":"Longitude","latitude":"Latitude","locate":"Locate","clean":"Delete","north":"North","south":"South","east":"East","west":"West","infocatastro":"Search parcel/cadastre","plot":"Parcel","searchplot":"Search parcel","searchcadastre":"Search cadastre","province":"Province","selectprov":"Select a province","municipality":"Municipality","selectmuni":"Select a municipality","estate":"Polygon","search":"Search","refCastatro":"Cadastral reference","insertCadastre":"Insert cadastre","notaRef":"Parcel code (first 14 digits). Ex.9977715VK3797F (IGN building)","consultReference":"Consult Reference","exact":"Exact address","aprox":"Approximate address","cadastral_information":"Cadastre information","reference":"Cadastral reference","description":"Description","noReference":"No reference","ignsearch":"Search places","search_direction":"Place name or address","get_direction":"Get direction at a point on the map","toponimo":"Place name"}'),m=JSON.parse('{"exception":{"impl":"La implementación usada no puede crear controles LocatorscnControl.","impl_infocatastro":"La implementación usada no puede crear controles InfoCatastroControl.","impl_xylocatorscn":"La implementación usada no puede crear controles XYLocatorscnControl.","impl_ignsearchlocatorscn":"La implementación usada no puede crear controles IGNSearchLocatorscnControl.","no_controls":"El plugin Locatorscn necesita activar al menos un control.","wrong_coords":"Las coordenadas introducidas no son correctas.","transforming":"Error realizando la transformación.","wrong_values":"Algún valor introducido no es correcto. Recuerda que los minutos y los segundos tienen que tener un valor entre 0 y 59 y los grados entre 0 y 180.","mapeaerror":"No es posible establecer la conexión con el servidor de Catastro.","no_province":"Debe seleccionar una provincia.","no_mun":"Debe seleccionar un municipio.","no_polygon":"Debe seleccionar un polígono.","no_parcel":"Debe seleccionar una parcela.","json_invalid":"La respuesta no es un JSON válido:","no_refcatastro":"Debe introducir una referencia catastral.","noInfo":"PARA ESAS COORDENADAS NO HAY REFERENCIA DISPONIBLE","noresults":"No se han encontrado resultados","no_direction":"No existe dirección","error_findjsonp":"Error en la petición del servicio findJSONp.","error_candidates":"Error en la petición del servicio candidatesJSONp."},"tooltip":"Localizador","xylocatorscn":"Buscar por coordenadas","geographic":"Geográficas","zone":"huso","dms":"GMS","dd":"GD","srs":"Sistema de coordenadas","longitude":"Longitud","latitude":"Latitud","locate":"Localizar","clean":"Eliminar","north":"Norte","south":"Sur","east":"Este","west":"Oeste","infocatastro":"Buscar parcela/catastro","plot":"Parcela","searchplot":"Buscar parcela","searchcadastre":"Buscar catastro","province":"Provincia","selectprov":"Seleccione provincia","municipality":"Municipio","selectmuni":"Seleccione municipio","estate":"Polígono","search":"Buscar","refCastatro":"Referencia catastral","insertCadastre":"Insertar catastro","notaRef":"Código de parcela (14 primeros dígitos). Ej.9977715VK3797F (edificio del IGN)","consultReference":"Consultar Referencia","exact":"Dirección exacta","aprox":"Dirección aproximada","cadastral_information":"Información catastral","reference":"Referencia catastral","description":"Descripción","noReference":"No hay referencia","ignsearch":"Buscar por lugares","search_direction":"Topónimo o dirección","get_direction":"Obtener dirección en un punto del mapa","toponimo":"Toponimo"}');var v,g={en:y,es:m},b=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t="es","function"==typeof M.language.getLang&&(t=M.language.getLang()),t),o=function(e){return"es"===e||"en"===e?g[e]:M.language.getTranslation(e).locatorscn}(r),n="";return M.utils.isNullOrEmpty(o)?console.warn("The translation '".concat(r,"' has not been defined.")):n=e.split(".").reduce((function(e,t){return e[t]}),o),n};function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){_(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _(e,t,r){return(t=E(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,E(o.key),o)}}function E(e){var t=function(e,t){if("object"!=w(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=w(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==w(t)?t:t+""}function x(e,t,r){return t=L(t),function(e,t){if(t&&("object"==w(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,C()?Reflect.construct(t,r||[],L(e).constructor):t.apply(e,r))}function C(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(C=function(){return!!e})()}function L(e){return L=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},L(e)}function j(e,t){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},j(e,t)}var k=function(e){function r(e,t,o,n,i,a,s){var c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),M.utils.isUndefined(f)&&M.exception(b("exception.impl_ignsearchlocatorscn")),(c=x(this,r,[new f(e),"IGNSearchLocatorscnImpl"])).zoom=t,c.reverse=!!M.utils.isUndefined(n.reverse)||n.reverse,c.resultVisibility=!!M.utils.isUndefined(n.resultVisibility)||n.resultVisibility,c.autocompleteLayers=n.layers||"address,street,venue",c.autocompleteSize=n.size||10,c.addendumField=n.addendum||"iderioja",c.urlAutocomplete=n.urlAutocomplete||"https://geocoder.larioja.org/v1/autocomplete",c.urlReverse=n.urlReverse||"https://geocoder.larioja.org/v1/reverse",c.reverseRadius=n.radius||100,c.reverseSources=n.sources||"",c.pointStyle=o;var l=n.peliasCoords;return M.utils.isString(l)&&(l=l.split(","),l=[Number.parseFloat(l[0]),Number.parseFloat(l[1])]),c.peliasCoords=l||[],c.reverseActivated=!1,c.useProxy=i,c.statusProxy=a,c.positionPlugin=s,c.map=e,c}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j(e,t)}(r,M.Control),o=r,i=[{key:"initializateAddress",value:function(e){var t=this;if((this.locationID&&this.locationID.length>0||this.requestStreet&&this.requestStreet.length>0||this.geocoderCoords&&2===this.geocoderCoords.length)&&this.active(e),this.locationID&&this.locationID.length>0&&(this.createGeometryStyles(),this.drawNomenclatorResult(this.locationID,!1)),this.requestStreet&&this.requestStreet.length>0&&(M.proxy(this.useProxy),M.remote.get(this.requestStreet).then((function(e){var r=e.text.substring(9,e.text.length-1);t.createGeometryStyles(),t.drawGeocoderResult(r)})).catch(),M.proxy(this.statusProxy)),this.geocoderCoords&&2===this.geocoderCoords.length){var r=this.getImpl().reproject("EPSG:4326",this.geocoderCoords);this.showReversePopUp({coord:r,fake:!0},!0)}}},{key:"active",value:function(e){this.html_=e;var r=this.html_.querySelector("#m-locatorscn-ignsearch").classList.contains("activated");if(this.deactive(),!r){"TC"===this.positionPlugin&&(document.querySelector(".m-plugin-locatorscn").classList.remove("m-plugin-locatorscn-tc"),document.querySelector(".m-plugin-locatorscn").classList.add("m-plugin-locatorscn-tc-withpanel")),this.html_.querySelector("#m-locatorscn-ignsearch").classList.add("activated");var o=M.template.compileSync(t(),{vars:{reverse:this.reverse,placeholder:b("search_direction"),translations:{search_direction:b("search_direction"),get_direction:b("get_direction"),clean:b("clean")}}});document.querySelector("#div-contenedor-locatorscn").appendChild(o),this.resultsBox=this.html_.querySelector("#m-ignsearch-panel>#m-ignsearchlocatorscn-results"),this.searchInput=this.html_.querySelector("#m-ignsearch-panel>#m-ignsearchlocatorscn-search-input"),this.addEvents()}}},{key:"deactive",value:function(){this.html_.querySelector("#m-locatorscn-ignsearch").classList.remove("activated");var e=this.html_.querySelector("#m-ignsearch-panel");e&&(this.clearResults(),document.querySelector("#div-contenedor-locatorscn").removeChild(e))}},{key:"addEvents",value:function(){var e=this;this.html_.querySelector("#m-ignsearch-panel>#m-ignsearchlocatorscn-search-input").addEventListener("keyup",(function(t){return e.createTimeout(t)})),this.html_.querySelector("#m-ignsearch-panel>#m-ignsearchlocatorscn-search-input").addEventListener("click",(function(){return e.openRecentsResults()})),this.reverse&&(this.html_.querySelector("#m-ignsearch-panel>#m-ignsearchlocatorscn-search-input").style.width="160px",this.html_.querySelector("#m-ignsearch-panel>#m-ignsearchlocatorscn-locate-button").addEventListener("click",this.activateDeactivateReverse.bind(this)),this.clickReverseEvent=this.map.on(M.evt.CLICK,(function(t){return e.showReversePopUp(t)}))),this.html_.querySelector("#m-ignsearch-panel>#m-ignsearchlocatorscn-clean-button").addEventListener("click",(function(){return e.clearResults()}))}},{key:"activateDeactivateReverse",value:function(){this.reverseActivated?(this.reverseActivated=!1,this.html_.querySelector("#m-ignsearchlocatorscn-locate-button").style.color="#7A7A73",document.removeEventListener("keyup",this.checkEscKey),document.getElementsByTagName("body")[0].style.cursor="auto"):(this.invokeEscKey(),this.reverseActivated=!0,this.html_.querySelector("#m-ignsearchlocatorscn-locate-button").style.color="#71a7d3",document.addEventListener("keyup",this.checkEscKey.bind(this)),document.getElementsByTagName("body")[0].style.cursor="url(".concat(M.utils.concatUrlPaths([M.config.THEME_URL,"/img/pushpin.svg"]),") 0 20, auto"))}},{key:"invokeEscKey",value:function(){try{document.dispatchEvent(new window.KeyboardEvent("keyup",{key:"Escape",keyCode:27,code:"",which:69,shiftKey:!1,ctrlKey:!1,metaKey:!1}))}catch(e){console.error(e)}}},{key:"checkEscKey",value:function(e){"Escape"===e.key&&(this.reverseActivated=!1,this.html_.querySelector("#m-ignsearchlocatorscn-locate-button").style.color="#7A7A73",document.removeEventListener("keyup",this.checkEscKey),document.getElementsByTagName("body")[0].style.cursor="auto")}},{key:"showReversePopUp",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.reverseActivated||r){var o=this.map.getProjection().code,n=this.getImpl().reprojectReverse([e.coord[0],e.coord[1]],o,"EPSG:4258"),i="point.lon=".concat(n[0],"&point.lat=").concat(n[1],"&size=1&boundary.circle.radius=").concat(this.reverseRadius).concat(this.reverseSources?"&sources=".concat(this.reverseSources.replace(",","%2C")):""),a="".concat(this.urlReverse,"?").concat(i),s=e.coord;this.peliasCoords=n;var c=[n[1],n[0]],l={};M.proxy(this.useProxy),M.remote.get(a).then((function(r){if(r.text){var o=JSON.parse(r.text).features;l=t.parsePeliasToGeocoder(o[0])}else l={};t.showPopUp(l,s,c,null,e,!1)})),M.proxy(this.statusProxy)}}},{key:"createFullAddress",value:function(e){var t=null===e.tip_via||void 0===e.tip_via?"":e.tip_via,r=null===e.address||void 0===e.address?"":e.address,o=null===e.extension||void 0===e.extension?"":e.extension.trim(),n="".concat(t," ").concat(r);return M.utils.isNullOrEmpty(o)||(n+=" ".concat(o)),"".concat(n)}},{key:"createTimeout",value:function(e){var t=this;clearTimeout(v),v=setTimeout((function(){return t.searchInputValue(e)}),500)}},{key:"openRecentsResults",value:function(){var e=this;if(!this.html_.querySelector("#m-ignsearch-panel>#m-ignsearchlocatorscn-search-input").value&&!this.html_.querySelector("#m-ignsearchlocatorscn-results-list")){var t=window.localStorage.getItem("recents");if(t&&t.length>0){var r=M.template.compileSync(n(),{vars:{noresults:!1,places:JSON.parse(t),translations:{noresults:b("exception.noresults")}}});r.querySelectorAll("li").forEach((function(t){t.addEventListener("click",(function(){e.goToLocation(t,!0)}))})),this.resultsBox.appendChild(r)}}}},{key:"searchInputValue",value:function(e){var t=this,r=e.target.value.replace(","," ");this.searchValue=r,this.resultsBox.innerHTML="",r.length>2&&(this.resultsBox.classList.add("locatorscn-icon-spinner"),this.peliasCandidates=[],this.candidatesFinished=!1,this.showCandidatesResults(),this.getCandidatesData(r,this.peliasCandidates).then((function(){t.candidatesFinished=!0,t.showCandidatesResults()})))}},{key:"generateBoundaryParams",value:function(){var e=this.map.getBbox(),t=this.getImpl().reprojectReverse([e.x.min,e.y.min],"EPSG:3857","EPSG:4326"),r=this.getImpl().reprojectReverse([e.x.max,e.y.max],"EPSG:3857","EPSG:4326"),o={min_lon:t[0],max_lon:r[0],min_lat:t[1],max_lat:r[1]};return"boundary.rect.min_lon=".concat(o.min_lon,"&boundary.rect.max_lon=").concat(o.max_lon,"&boundary.rect.min_lat=").concat(o.min_lat,"&boundary.rect.max_lat=").concat(o.max_lat)}},{key:"getCandidatesData",value:function(e,t){var r=this,o=window.encodeURIComponent(e);return new Promise((function(e){var n=r.generateBoundaryParams(),i="text=".concat(o,"&size=").concat(r.autocompleteSize,"&layers=").concat(r.autocompleteLayers.replace(",","%2C"),"&").concat(n),a="".concat(r.urlAutocomplete,"?").concat(i);M.proxy(r.useProxy),M.remote.get(a).then((function(r){if(404===r.code||500===r.code)M.dialog.error(b("exception.error_candidates"));else for(var o=JSON.parse(r.text).features,n=0;n<o.length;n+=1)t.push(o[n]);e()})),M.proxy(r.statusProxy)}))}},{key:"parsePeliasToGeocoder",value:function(e){var t=e.properties,r=e.geometry.coordinates,o=e.geometry.type;return{native:e,address:t.label,comunidadAutonoma:t.macroregion,countryCode:t.country_code,extension:t.extension,geom:"".concat(o.toUpperCase(),"(").concat(r[0]," ").concat(r[1],")"),id:t.id,lng:r[0],lat:r[1],muni:t.localadmin,municode:t.localadmin_gid,noNumber:null,poblacion:t.localadmin,portalNumber:t.housenumber,postalCode:t.postalcode,province:t.region,provinceCode:t.region_gid,refCatastral:null,state:0,stateMsg:"",tip_via:null,type:""}}},{key:"showCandidatesResults",value:function(){var e=this;this.allCandidates=[];for(var t=0;t<this.peliasCandidates.length;t+=1){var r=this.peliasCandidates[t];this.allCandidates.push(this.parsePeliasToGeocoder(r))}this.resultsBox.innerHTML="",this.resultsBox.classList.remove("locatorscn-icon-spinner");var o=M.template.compileSync(n(),{vars:{noresults:0===this.allCandidates.length&&this.candidatesFinished,places:this.allCandidates,translations:{noresults:b("exception.noresults")}}});this.allCandidates.length>0&&o.querySelectorAll("li").forEach((function(t){t.addEventListener("click",(function(){e.goToLocation(t)}))})),this.resultsBox.appendChild(o)}},{key:"goToLocation",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.currentElement=e;var o=e.querySelector("#info").innerHTML;this.html_.querySelector("#m-ignsearchlocatorscn-search-input").value=o;var n=(r?JSON.parse(window.localStorage.getItem("recents")):this.allCandidates).filter((function(e){return e.id===t.currentElement.getAttribute("id")}))[0];this.setRecents(n),this.createGeometryStyles(),Object.prototype.hasOwnProperty.call(n,"address")&&n&&this.drawPeliasResult(n),this.resultsBox.innerHTML=""}},{key:"setRecents",value:function(e){var t=JSON.parse(window.localStorage.getItem("recents"));t&&0!==t.length?this.checkDuplicateRecent(e)||(5===t.length?(t.pop(),t.unshift(e)):t.unshift(e)):t=[e],window.localStorage.setItem("recents",JSON.stringify(t))}},{key:"checkDuplicateRecent",value:function(e){var t=JSON.parse(window.localStorage.getItem("recents")),r=!1;return t.forEach((function(t){t.id===e.id&&(r=!0)})),r}},{key:"createGeometryStyles",value:function(){"pinAzul"===this.pointStyle?this.point=new M.style.Point({radius:5,icon:{src:M.utils.concatUrlPaths([M.config.THEME_URL,"/img/marker.svg"]),scale:1.4,fill:{color:"#71a7d3"},stroke:{width:30,color:"white"},anchor:[.5,1]}}):"pinRojo"===this.pointStyle?this.point=new M.style.Point({radius:5,icon:{src:M.utils.concatUrlPaths([M.config.THEME_URL,"/img/pinign.svg"]),anchor:[.5,1]}}):"pinMorado"===this.pointStyle&&(this.point=new M.style.Point({radius:5,icon:{src:M.utils.concatUrlPaths([M.config.THEME_URL,"/img/m-pin-24.svg"]),anchor:[.5,1]}})),this.simple=new M.style.Polygon({fill:{color:"black",opacity:0}})}},{key:"zoomInLocation",value:function(e,t,r,o){var n=this;if(this.html_&&(this.resultsList=this.html_.querySelector("#m-ignsearchlocatorscn-results-list")),this.clickedElementLayer instanceof M.layer.Vector){if("n"===e&&"Point"===t)this.clickedElementLayer.calculateMaxExtent().then((function(e){n.map.setBbox(e),n.map.setZoom(r),n.fire("ignsearchlocatorscn:entityFound",[e])}));else{var i=this.clickedElementLayer.getImpl().getOL3Layer().getSource().getExtent();this.map.setBbox(i),this.fire("ignsearchlocatorscn:entityFound",[i])}setTimeout((function(){M.config.MOVE_MAP_EXTRACT=!0;var e=[o.lng,o.lat],t=o.state;n.showSearchPopUp(o,e,t)}),300)}}},{key:"drawPeliasResult",value:function(e){var t=this;this.map.removeLayers(this.clickedElementLayer);var r=this.getImpl().readFromWKT(e),o=M.impl.Feature.olFeature2Facade(r),n=e;this.coordinates="".concat(n.lat,", ").concat(n.lng),this.clickedElementLayer=new M.layer.GeoJSON({name:"searchresult",source:{type:"FeatureCollection",features:[]}},{displayInLayerSwitcher:!1}),this.clickedElementLayer.displayInLayerSwitcher=!1;var i=o.getGeometry().type;this.clickedElementLayer.on(M.evt.LOAD,(function(){t.clickedElementLayer.addFeatures(o),t.zoomInLocation("g",i,t.zoom,n)})),this.map.addLayers(this.clickedElementLayer),"Point"===i&&this.clickedElementLayer.setStyle(this.point),(i.indexOf("Polygon")>-1||i.indexOf("Collection")>-1)&&this.clickedElementLayer.setStyle(new M.style.Polygon({fill:{color:"#3399CC",opacity:0},stroke:{color:"#3399CC",width:2}})),this.clickedElementLayer.setZIndex(9999999999999),this.resultVisibility||this.clickedElementLayer.setStyle(this.simple)}},{key:"showSearchPopUp",value:function(e,t,r){var o,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=this.map.getProjection().code,a=this.getImpl().reprojectReverse([t[0],t[1]],"EPSG:4326",i);o=b(1!==r?"aprox":"exact"),this.showPopUp(e,a,t,o,n)}},{key:"showPopUp",value:function(e,t,r){var o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],n={content:"",title:""},i=e.native.properties.addendum[this.addendumField],s=Object.keys(i);s.sort();var c=s.filter((function(e){return i[e]})).map((function(e){return"<span>".concat(e.toUpperCase(),": </span> ").concat(i[e])})),l=M.template.compileSync(a(),{vars:{addressData:P(P({},e),{},{geom:e.geom.replace("POINT","")}),addendum:i,addendumHTML:c},parseToHtml:!0}),u=l.querySelector("#m-ignsearchlocatorscn-addendum");c.forEach((function(e){var t=document.createElement("div");t.innerHTML=e,u.appendChild(t)})),n.content=l.innerHTML;var p=new M.Popup({});p.addTab(n),this.map.addPopup(p,[t[0],t[1]]),this.popup=p,o&&"pinAzul"===this.pointStyle?this.popup.getImpl().setOffset([0,-30]):o&&"pinRojo"===this.pointStyle?this.popup.getImpl().setOffset([2,-30]):o&&"pinMorado"===this.pointStyle&&this.popup.getImpl().setOffset([1,-20]),this.lat=t[1],this.lng=t[0]}},{key:"equals",value:function(e){return e instanceof r}},{key:"clearResults",value:function(){this.searchInput.value="",this.resultsBox.innerHTML="",this.searchValue="",this.reverse&&(this.reverseActivated=!1,this.html_.querySelector("#m-ignsearchlocatorscn-locate-button").style.color="#7A7A73",document.removeEventListener("keyup",this.checkEscKey),document.getElementsByTagName("body")[0].style.cursor="auto"),this.map.removeLayers(this.clickedElementLayer),this.map.removePopup(this.map.getPopup())}},{key:"destroy",value:function(){document.getElementsByTagName("body")[0].style.cursor="auto",document.removeEventListener("keyup",this.checkEscKey),this.map.removeLayers(this.clickedElementLayer),this.map.removePopup(this.map.getPopup())}}],i&&O(o.prototype,i),s&&O(o,s),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,i,s}(),T=r(4),R=r.n(T);function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}function N(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,I(o.key),o)}}function I(e){var t=function(e,t){if("object"!=D(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=D(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==D(t)?t:t+""}function A(e,t,r){return t=G(t),function(e,t){if(t&&("object"==D(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,q()?Reflect.construct(t,r||[],G(e).constructor):t.apply(e,r))}function q(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(q=function(){return!!e})()}function B(){return B="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=G(e)););return e}(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}},B.apply(null,arguments)}function G(e){return G=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},G(e)}function U(e,t){return U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},U(e,t)}var z=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),A(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&U(e,t)}(t,M.impl.Control),r=t,(o=[{key:"addTo",value:function(e,r){B(G(t.prototype),"addTo",this).call(this,e,r),this.facadeMap_=e}}])&&N(r.prototype,o),n&&N(r,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o,n}();function F(e){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F(e)}function V(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,K(o.key),o)}}function K(e){var t=function(e,t){if("object"!=F(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=F(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==F(t)?t:t+""}function J(e,t,r){return t=Y(t),function(e,t){if(t&&("object"==F(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,H()?Reflect.construct(t,r||[],Y(e).constructor):t.apply(e,r))}function H(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(H=function(){return!!e})()}function Y(e){return Y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Y(e)}function W(e,t){return W=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},W(e,t)}var X=function(e){function t(e,r,o,n,i,a,s,c){var l;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),M.utils.isUndefined(z)&&M.exception(b("exception.impl")),(l=J(this,t,[new z,"Locatorscn"])).searchOptions_=n,l.isDraggable_=e,l.zoom_=r,l.pointStyle_=o,l.order=i,l.useProxy=a,l.statusProxy=s,l.position=c||"TR",l.control=null,l}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&W(e,t)}(t,M.Control),r=t,(o=[{key:"createView",value:function(e){var t=this;return this.map_=e,new Promise((function(e,r){var o=M.template.compileSync(R(),{vars:{showTitle:"TC"!==t.position,byParcelCadastre:t.byParcelCadastre_,byPlaceAddressPostal:t.searchOptions_,translations:{headertitle:b("tooltip"),ignsearch:b("ignsearch")}}});t.html=o,t.searchOptions_&&(t.ignsearchControl=new k(t.map_,t.zoom_,t.pointStyle_,t.searchOptions_,t.useProxy,t.statusProxy,t.position),t.on(M.evt.ADDED_TO_MAP,(function(){t.ignsearchControl.initializateAddress(o),t.control=t.ignsearchControl,t.deactive(o,"ignsearch"),t.ignsearchControl.active(o),t.control=t.ignsearchControl})),t.ignsearchControl.on("ignsearchlocatorscn:entityFound",(function(e){t.fire("ignsearchlocatorscn:entityFound",[e])}))),t.isDraggable_&&M.utils.draggabillyPlugin(t.getPanel(),"#m-locatorscn-title"),t.accessibilityTab(o),e(o)}))}},{key:"equals",value:function(e){return e instanceof t}},{key:"deactive",value:function(e,t){var r=e.querySelectorAll("#m-locatorscn-previews .activated")[0];if("TC"===this.position&&(document.querySelector(".m-plugin-locatorscn").classList.remove("m-plugin-locatorscn-tc-withpanel"),document.querySelector(".m-plugin-locatorscn").classList.add("m-plugin-locatorscn-tc")),r&&!r.id.includes(t)){this.control.clearResults(),r.classList.remove("activated");var o=document.querySelector("#div-contenedor-locatorscn");"TC"===this.position&&o&&o.children.length>1?o.removeChild(o.children[1]):o&&o.children.length>2&&o.removeChild(o.children[2])}}},{key:"accessibilityTab",value:function(e){var t=this;e.querySelectorAll('[tabindex="0"]').forEach((function(e){return e.setAttribute("tabindex",t.order)}))}},{key:"destroy",value:function(){M.utils.isNullOrEmpty(this.ignsearchControl)||this.ignsearchControl.destroy()}}])&&V(r.prototype,o),n&&V(r,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o,n}();function Z(e){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Z(e)}function Q(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,$(o.key),o)}}function $(e){var t=function(e,t){if("object"!=Z(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=Z(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Z(t)?t:t+""}function ee(e,t,r){return t=re(t),function(e,t){if(t&&("object"==Z(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,te()?Reflect.construct(t,r||[],re(e).constructor):t.apply(e,r))}function te(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(te=function(){return!!e})()}function re(e){return re=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},re(e)}function oe(e,t){return oe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},oe(e,t)}var ne=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=ee(this,t)).map_=null,e.controls_=[],e.name="locatorscn",e.options=r,e.position_=r.position||"TR",e.collapsed=!!M.utils.isUndefined(r.collapsed)||r.collapsed,e.collapsible=!!M.utils.isUndefined(r.collapsible)||r.collapsible,e.tooltip_=r.tooltip||b("tooltip"),e.searchOptions=r.searchOptions||{},e.isDraggable=!M.utils.isUndefined(r.isDraggable)&&r.isDraggable,e.zoom=r.zoom||16,e.pointStyle=r.pointStyle||"pinAzul",e.order=r.order>=-1?r.order:null,e.useProxy=!!M.utils.isUndefined(r.useProxy)||r.useProxy,e.statusProxy=M.useproxy,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oe(e,t)}(t,M.Plugin),r=t,n=[{key:"getJSONTranslations",value:function(e){return"en"===e||"es"===e?"en"===e?y:m:M.language.getTranslation(e).locatorscn}}],(o=[{key:"addTo",value:function(e){this.controls_.push(new X(this.isDraggable,this.zoom,this.pointStyle,this.searchOptions,this.order,this.useProxy,this.statusProxy,this.position_)),this.map_=e,"TC"===this.position_&&(this.collapsible=!1),this.panel_=new M.ui.Panel("panelLocatorscn",{collapsible:this.collapsible,collapsed:this.collapsed,position:M.ui.position[this.position_],className:"m-plugin-locatorscn",tooltip:this.tooltip_,collapsedButtonClass:"locatorscn-icon-localizacion2",order:this.order}),this.panel_.addControls(this.controls_),e.addPanels(this.panel_)}},{key:"getIGNSearchLocatorscn",value:function(){return{servicesToSearch:"",maxResults:10,noProcess:"",countryCode:"",reverse:!0,resultVisibility:!0,urlCandidates:"",urlFind:"",urlReverse:"",urlPrefix:"",urlAssistant:"",urlDispatcher:"",searchPosition:""}}},{key:"getAPIRest",value:function(){return"".concat(this.name,"=").concat(this.position_,"*").concat(this.collapsed,"*").concat(this.collapsible,"*").concat(this.tooltip_,"*").concat(this.zoom,"*").concat(this.pointStyle,"\n    *").concat(this.isDraggable,"*").concat(this.searchOptions,"*").concat(this.useProxy)}},{key:"getAPIRestBase64",value:function(){return"".concat(this.name,"=base64=").concat(M.utils.encodeBase64(this.options))}},{key:"destroy",value:function(){this.map_.removeControls(this.controls_),this.map_=null,this.controls_=null,this.panel_=null,this.name=null}},{key:"equals",value:function(e){return e instanceof t}}])&&Q(r.prototype,o),n&&Q(r,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o,n}();window.M.control||(window.M.control={}),window.M.plugin||(window.M.plugin={}),window.M.impl||(window.M.impl={}),window.M.impl.control||(window.M.impl.control={}),window.M.control.IGNSearchLocatorscnControl=k,window.M.plugin.Locatorscn=ne,window.M.control.LocatorscnControl=X,window.M.impl.control.IGNSearchLocatorscnControl=f,window.M.impl.control.LocatorscnControl=z})()})();
//# sourceMappingURL=locatorscn.ol.min.js.map
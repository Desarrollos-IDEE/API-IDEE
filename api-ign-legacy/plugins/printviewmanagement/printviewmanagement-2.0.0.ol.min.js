/*! For license information please see printviewmanagement.ol.min.js.LICENSE.txt */
(()=>{var e={162:function(e,t,r){var n,i,a;i=[],void 0===(a="function"==typeof(n=function(){"use strict";function t(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function n(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){s(n.response,t,r)},n.onerror=function(){console.error("could not download file")},n.send()}function i(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function a(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(r){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var o="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof r.g&&r.g.global===r.g?r.g:void 0,s=o.saveAs||("object"!=typeof window||window!==o?function(){}:"download"in HTMLAnchorElement.prototype?function(e,t,r){var s=o.URL||o.webkitURL,l=document.createElement("a");t=t||e.name||"download",l.download=t,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?a(l):i(l.href)?n(e,t,r):a(l,l.target="_blank")):(l.href=s.createObjectURL(e),setTimeout((function(){s.revokeObjectURL(l.href)}),4e4),setTimeout((function(){a(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,r,o){if(r=r||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,o),r);else if(i(e))n(e,r,o);else{var s=document.createElement("a");s.href=e,s.target="_blank",setTimeout((function(){a(s)}))}}:function(e,t,r,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof e)return n(e,t,r);var a="application/octet-stream"===e.type,s=/constructor/i.test(o.HTMLElement)||o.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||a&&s)&&"object"==typeof FileReader){var c=new FileReader;c.onloadend=function(){var e=c.result;e=l?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=e:location=e,i=null},c.readAsDataURL(e)}else{var u=o.URL||o.webkitURL,p=u.createObjectURL(e);i?i.location=p:location.href=p,i=null,setTimeout((function(){u.revokeObjectURL(p)}),4e4)}});o.saveAs=s.saveAs=s,e.exports=s})?n.apply(t,i):n)||(e.exports=a)},166:e=>{e.exports='<section class="m-container m-georefimage m-georefimage-container">\n    <h3 class="m-plugin-printviewmanagement-title-view">{{translations.nameTitle}}</h3>\n\n    <div class="m-georefimage-titleFormat">\n        <label style="display: none;" tabindex="0" for="title-georefimage" title="{{translations.title}}" aria-label="{{translations.format}}">{{translations.title}}"</label>\n        <input tabindex="0" type="text" id="m-georefimage-title" aria-label="{{translations.title}}" title="{{translations.title}}" name="title-georefimage" placeholder="{{translations.title}}">\n\n        <label style="display: none;" tabindex="0" for="format-georefimage" title="{{translations.format}}" aria-label="{{translations.format}}">Formato de Descarga</label>\n        <select tabindex="0" id="m-georefimage-format" name="format-georefimage" title="{{translations.format}}" aria-label="{{translations.format}}">\n            <option value="jpeg">JPEG</option>\n            <option value="png">PNG</option>\n        </select>\n\n    </div>\n    <div class="georefimage-jgwKeppview">\n        <div>\n            <label tabindex="0" for="m-georefimage-wld" title="{{translations.georefimageWld}}" aria-label="{{translations.georefimageWld}}">{{translations.georefimageWld}}</label>\n            <input tabindex="0" value="wld" type="checkbox" title="{{translations.georefimageWld}}" id="m-georefimage-wld" aria-label="{{translations.georefimageWld}}">\n        </div>\n\n        <div class="keepview">\n            <labe tabindex="0" for="m-georefimage-dpi" aria-label="DPI" title="DPI">DPI</labe>\n            <input type="number" aria-label="DPI" title="DPI" id="m-georefimage-dpi" min="120" max="300" value="120" placeholder="120">\n        </div>\n    </div>\n\n    <fieldset id="m-georefimage-fieldset" class="typeImagen" title="{{translations.typeDownload}}">\n        <legend tabindex="0">{{translations.typeDownload}}</legend>\n        <div class="m-georefimage-fieldsetInput">\n            <div>\n                <label tabindex="0" for="client">{{translations.typeClient}} <button id="m-georefimage-clipboard" class="printviewmanagement-icon-clipboard" title="{{translations.clipBoard}}"></button></label>\n                <input tabindex="0" name="typeDownload" value="client" type="radio" id="client" title="{{translations.typeClient}}">\n            </div>\n\n            <div>\n                <label tabindex="0" for="server">{{translations.typeServer}} <a aria-activedescendant="modal" aria-label="Servicios geoprint" title="Servicios geoprint" id="m-georefimage-listServices" href="#">(&#x2139;)</a></label>\n                <input tabindex="0" title="{{translations.typeServer}}" name="typeDownload" value="server" type="radio" id="server" checked>\n            </div>\n        </div>\n\n        <h3 tabindex="0" id="m-georefimage-projection" class="m-georefimage-projection" title="EPSG"></h3>\n    </fieldset>\n</section>'},339:e=>{e.exports='<section class="m-georefimageepsg-container">\n  <h3 class="m-plugin-printviewmanagement-title-list">{{translations.nameTitle}}</h3>\n  <label for="m-georefimageepsg-select" class="m-georefimageepsg-label">{{translations.selectLayer}}</label>\n  <select id="m-georefimageepsg-select" title="{{translations.selectLayer}}">\n    {{#each layers}}\n      <option value=\'{{name}}\'>{{legend}}</option>\n    {{/each}}\n  </select>\n</section>\n'},431:(e,t,r)=>{e.exports='<div>\n   <h2 style="text-align: center; color: #fff; background-color: #364b5f; padding: 8px 10px;">PRINTERVIEWMANAGEMENT <img style="vertical-align: bottom; filter: invert(100%);" src="'+r(914)+'" width="30" height="30"></h2>\n   <div>\n      <p>{{translations.help1}}</p>\n      <p>{{translations.help2}}</p>\n      <img src="{{urlImages}}printviewmanagement_0.png" style="max-width:70%; margin: 0 auto; display: block">\n      <p>{{translations.help3}}</p>\n      <p>{{translations.help4}}</p>\n      <p>{{translations.help5}}</p>\n      <img src="{{urlImages}}printviewmanagement_1.png" style="max-width:70%; margin: 0 auto; display: block">\n      <p>{{translations.help6}}</p>\n      <p>{{translations.help7}}</p>\n      <p>{{translations.help8}}</p>\n      <p>{{translations.help9}}</p>\n      <img src="{{urlImages}}printviewmanagement_2.png" style="max-width:70%; margin: 0 auto; display: block">\n      <p>{{translations.help10}}</p>\n      <p>{{translations.help11}}</p>\n      <img src="{{urlImages}}printviewmanagement_3.png" style="max-width:70%; margin: 0 auto; display: block">\n      <p>{{translations.help12}}: <a tabindex="0" href="https://github.com/IGN-CNIG/API-CNIG/tree/master/api-ign-js/src/plugins/printviewmanagement" target="_blank">https://github.com/IGN-CNIG/API-CNIG/tree/master/api-ign-js/src/plugins/printviewmanagement</a></p>\n      <p>{{translations.help13}}: <a tabindex="0" href="https://componentes.cnig.es/api-core/printviewmanagement.jsp?language=es" target="_blank">https://componentes.cnig.es/api-core/printviewmanagement.jsp?language=es</a></p>\n   </div>\n</div>\n'},76:e=>{e.exports='<main class="m-container m-printermap m-printermap-container">\n    <h3 class="m-plugin-printviewmanagement-title-map">{{translations.nameTitle}}</h3>\n\n    <section class="m-printermap-titleFormat">\n        \x3c!-- Selección del título --\x3e\n        <label tabindex="0" for="m-printermap-title" role="text" aria-label="{{translations.title}}">{{translations.title}} </label>\n        <input tabindex="0" id="m-printermap-title" aria-label="{{translations.title}}" type="text" title="{{translations.title}}" placeholder="{{translations.title}}">\n\n        \x3c!-- Selección del formato --\x3e\n        <label tabindex="0" for="m-printermap-format" role="text" aria-label="{{translations.format}}">{{translations.format}} </label>\n        <select tabindex="0" role="select" id="m-printermap-format" title="{{translations.format}}">\n            {{#each format}}\n                <option value="{{name}}" {{#if default}} selected{{/if}}>{{name}}</option>\n            {{/each}}\n        </select>\n    </section>\n\n\n    \x3c!-- Selección de la descripción --\x3e\n    <label class="m-printermap-labelTextarea" tabindex="0" for="m-printermap-description" role="text" aria-label="{{translations.description}}">{{translations.description}} </label>\n    {{#if fixedDescription}}\n        <textarea class="m-printermap-textarea" id="m-printermap-description" tabindex="0" aria-label="{{translations.fixeddescription}}" disabled title="{{translations.description}}">{{translations.fixeddescription}}</textarea>\n        {{^}}\n            <textarea class="m-printermap-textarea" id="m-printermap-description" tabindex="0" aria-label="{{translations.description}}" placeholder="{{translations.description}}" title="{{translations.description}}"></textarea>\n    {{/if}}\n\n    <section class="m-printermap-params">\n        \x3c!-- Selección de layout --\x3e\n        <label class="m-printermap-paramsLabel" tabindex="0" role="text" aria-label="{{translations.layout}}">{{translations.layout}}</label>\n        <select tabindex="0" role="select" id="m-printermap-layout" title="{{translations.layout}}">\n            {{#each layouts}}\n                <option value="{{name}}" {{#if default}} selected{{/if}}>{{name}}</option>\n            {{/each}}\n        </select>\n\n        \x3c!-- Selección de DPI --\x3e\n        <div>\n            <label tabindex="0" role="text" aria-label="DPI">DPI </label>\n            <select tabindex="0" role="select" aria-label="DPI" id="m-printermap-dpi" title="DPI">\n                {{#each dpis}}\n                    <option value="{{value}}" {{#if default}} selected{{/if}}>{{value}}</option>\n                {{/each}}\n            </select>\n        </div>\n    </section>\n    <label>* {{translations.maintain_view}}</label>\n</main>'},329:e=>{e.exports='<div aria-label="Plugin View Management" role="menuitem" id="div-contenedor-printviewmanagement" class="m-control m-container m-printviewmanagement">\n     \x3c!-- Título del plugin --\x3e\n    <header role="heading" tabindex="0" id="m-printviewmanagement-title" class="m-printviewmanagement-title">{{translations.headertitle}}</header>\n\n    \x3c!-- Contenedor de controles --\x3e\n    <section id="m-printviewmanagement-previews" class="m-printviewmanagement-previews">\n        {{#if printermap}}\n        <button tabindex="0" id="m-printviewmanagement-printermap" title="{{translations.printermap}}" class="printviewmanagement-icon-flecha-historial"></button>\n        {{/if}}\n        {{#if georefImage}}\n        <button tabindex="0" id="m-printviewmanagement-georefImage" title="{{translations.georefImage}}" class="printviewmanagement-icon-zoom-extension"></button>\n        {{/if}}\n        {{#if georefImageEpsg}}\n        <button tabindex="0" id="m-printviewmanagement-georefImageEpsg" title="{{translations.tooltipGeorefImageEpsg}}" class="printviewmanagement-georefImageEpsg"></button>\n        {{/if}}\n    </section>\n\n     \x3c!-- Contenedor de controles --\x3e\n    <section id="m-printviewmanagement-controls" class="m-printviewmanagement-controls"></section>\n\n    \x3c!-- Botones para descargar --\x3e\n    <div class="m-georefimage-download-button" id="m-georefimage-download-button" style="display: none;">\n        <button tabindex="0" id="m-printviewmanagement-print" class="print" title="{{translations.downImg}}">{{translations.downImg}}</button>\n        <button tabindex="0" id="m-printviewmanagement-remove" class="remove" title="{{translations.delete}}">{{translations.delete}}</button>\n    </div>\n\n    \x3c!-- Listado de descargas --\x3e\n    <footer style="display: none;" class="m-printviewmanagement-queue">\n      <ul class="queue-container" id="m-georefimage-queue-container"></ul>\n    </footer>\n</div>'},733:(e,t,r)=>{var n=r(155);e.exports=function e(t,r,n){function i(o,s){if(!r[o]){if(!t[o]){if(a)return a(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=r[o]={exports:{}};t[o][0].call(c.exports,(function(e){return i(t[o][1][e]||e)}),c,c.exports,e,t,r,n)}return r[o].exports}for(var a=void 0,o=0;o<n.length;o++)i(n[o]);return i}({1:[function(e,t,r){"use strict";var n=e("./utils"),i=e("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(e){for(var t,r,i,o,s,l,c,u=[],p=0,f=e.length,d=f,h="string"!==n.getTypeOf(e);p<e.length;)d=f-p,i=h?(t=e[p++],r=p<f?e[p++]:0,p<f?e[p++]:0):(t=e.charCodeAt(p++),r=p<f?e.charCodeAt(p++):0,p<f?e.charCodeAt(p++):0),o=t>>2,s=(3&t)<<4|r>>4,l=1<d?(15&r)<<2|i>>6:64,c=2<d?63&i:64,u.push(a.charAt(o)+a.charAt(s)+a.charAt(l)+a.charAt(c));return u.join("")},r.decode=function(e){var t,r,n,o,s,l,c=0,u=0,p="data:";if(e.substr(0,p.length)===p)throw new Error("Invalid base64 input, it looks like a data url.");var f,d=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===a.charAt(64)&&d--,e.charAt(e.length-2)===a.charAt(64)&&d--,d%1!=0)throw new Error("Invalid base64 input, bad content length.");for(f=i.uint8array?new Uint8Array(0|d):new Array(0|d);c<e.length;)t=a.indexOf(e.charAt(c++))<<2|(o=a.indexOf(e.charAt(c++)))>>4,r=(15&o)<<4|(s=a.indexOf(e.charAt(c++)))>>2,n=(3&s)<<6|(l=a.indexOf(e.charAt(c++))),f[u++]=t,64!==s&&(f[u++]=r),64!==l&&(f[u++]=n);return f}},{"./support":30,"./utils":32}],2:[function(e,t,r){"use strict";var n=e("./external"),i=e("./stream/DataWorker"),a=e("./stream/Crc32Probe"),o=e("./stream/DataLengthProbe");function s(e,t,r,n,i){this.compressedSize=e,this.uncompressedSize=t,this.crc32=r,this.compression=n,this.compressedContent=i}s.prototype={getContentWorker:function(){var e=new i(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),t=this;return e.on("end",(function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),e},getCompressedWorker:function(){return new i(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},s.createWorkerFrom=function(e,t,r){return e.pipe(new a).pipe(new o("uncompressedSize")).pipe(t.compressWorker(r)).pipe(new o("compressedSize")).withStreamInfo("compression",t)},t.exports=s},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,r){"use strict";var n=e("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},r.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,r){"use strict";var n=e("./utils"),i=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==n.getTypeOf(e)?function(e,t,r,n){var a=i,o=n+r;e^=-1;for(var s=n;s<o;s++)e=e>>>8^a[255&(e^t[s])];return~e}(0|t,e,e.length,0):function(e,t,r,n){var a=i,o=n+r;e^=-1;for(var s=n;s<o;s++)e=e>>>8^a[255&(e^t.charCodeAt(s))];return~e}(0|t,e,e.length,0):0}},{"./utils":32}],5:[function(e,t,r){"use strict";r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(e,t,r){"use strict";var n=null;n="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:n}},{lie:37}],7:[function(e,t,r){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,i=e("pako"),a=e("./utils"),o=e("./stream/GenericWorker"),s=n?"uint8array":"array";function l(e,t){o.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}r.magic="\b\0",a.inherits(l,o),l.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(a.transformTo(s,e.data),!1)},l.prototype.flush=function(){o.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},r.compressWorker=function(e){return new l("Deflate",e)},r.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,r){"use strict";function n(e,t){var r,n="";for(r=0;r<t;r++)n+=String.fromCharCode(255&e),e>>>=8;return n}function i(e,t,r,i,o,u){var p,f,d=e.file,h=e.compression,m=u!==s.utf8encode,g=a.transformTo("string",u(d.name)),y=a.transformTo("string",s.utf8encode(d.name)),v=d.comment,b=a.transformTo("string",u(v)),_=a.transformTo("string",s.utf8encode(v)),w=y.length!==d.name.length,x=_.length!==v.length,S="",O="",k="",E=d.dir,M=d.date,C={crc32:0,compressedSize:0,uncompressedSize:0};t&&!r||(C.crc32=e.crc32,C.compressedSize=e.compressedSize,C.uncompressedSize=e.uncompressedSize);var T=0;t&&(T|=8),m||!w&&!x||(T|=2048);var I=0,P=0;E&&(I|=16),"UNIX"===o?(P=798,I|=function(e,t){var r=e;return e||(r=t?16893:33204),(65535&r)<<16}(d.unixPermissions,E)):(P=20,I|=function(e){return 63&(e||0)}(d.dosPermissions)),p=M.getUTCHours(),p<<=6,p|=M.getUTCMinutes(),p<<=5,p|=M.getUTCSeconds()/2,f=M.getUTCFullYear()-1980,f<<=4,f|=M.getUTCMonth()+1,f<<=5,f|=M.getUTCDate(),w&&(O=n(1,1)+n(l(g),4)+y,S+="up"+n(O.length,2)+O),x&&(k=n(1,1)+n(l(b),4)+_,S+="uc"+n(k.length,2)+k);var j="";return j+="\n\0",j+=n(T,2),j+=h.magic,j+=n(p,2),j+=n(f,2),j+=n(C.crc32,4),j+=n(C.compressedSize,4),j+=n(C.uncompressedSize,4),j+=n(g.length,2),j+=n(S.length,2),{fileRecord:c.LOCAL_FILE_HEADER+j+g+S,dirRecord:c.CENTRAL_FILE_HEADER+n(P,2)+j+n(b.length,2)+"\0\0\0\0"+n(I,4)+n(i,4)+g+S+b}}var a=e("../utils"),o=e("../stream/GenericWorker"),s=e("../utf8"),l=e("../crc32"),c=e("../signature");function u(e,t,r,n){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=r,this.encodeFileName=n,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(u,o),u.prototype.push=function(e){var t=e.meta.percent||0,r=this.entriesCount,n=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,o.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:r?(t+100*(r-n-1))/r:100}}))},u.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var r=i(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:r.fileRecord,meta:{percent:0}})}else this.accumulate=!0},u.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,r=i(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(r.dirRecord),t)this.push({data:function(e){return c.DATA_DESCRIPTOR+n(e.crc32,4)+n(e.compressedSize,4)+n(e.uncompressedSize,4)}(e),meta:{percent:100}});else for(this.push({data:r.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},u.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var r=this.bytesWritten-e,i=function(e,t,r,i,o){var s=a.transformTo("string",o(i));return c.CENTRAL_DIRECTORY_END+"\0\0\0\0"+n(e,2)+n(e,2)+n(t,4)+n(r,4)+n(s.length,2)+s}(this.dirRecords.length,r,e,this.zipComment,this.encodeFileName);this.push({data:i,meta:{percent:100}})},u.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},u.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()})),e.on("error",(function(e){t.error(e)})),this},u.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},u.prototype.error=function(e){var t=this._sources;if(!o.prototype.error.call(this,e))return!1;for(var r=0;r<t.length;r++)try{t[r].error(e)}catch(e){}return!0},u.prototype.lock=function(){o.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=u},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,r){"use strict";var n=e("../compressions"),i=e("./ZipFileWorker");r.generateWorker=function(e,t,r){var a=new i(t.streamFiles,r,t.platform,t.encodeFileName),o=0;try{e.forEach((function(e,r){o++;var i=function(e,t){var r=e||t,i=n[r];if(!i)throw new Error(r+" is not a valid compression method !");return i}(r.options.compression,t.compression),s=r.options.compressionOptions||t.compressionOptions||{},l=r.dir,c=r.date;r._compressWorker(i,s).withStreamInfo("file",{name:e,dir:l,date:c,comment:r.comment||"",unixPermissions:r.unixPermissions,dosPermissions:r.dosPermissions}).pipe(a)})),a.entriesCount=o}catch(e){a.error(e)}return a}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,r){"use strict";function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new n;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(n.prototype=e("./object")).loadAsync=e("./load"),n.support=e("./support"),n.defaults=e("./defaults"),n.version="3.10.1",n.loadAsync=function(e,t){return(new n).loadAsync(e,t)},n.external=e("./external"),t.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,r){"use strict";var n=e("./utils"),i=e("./external"),a=e("./utf8"),o=e("./zipEntries"),s=e("./stream/Crc32Probe"),l=e("./nodejsUtils");function c(e){return new i.Promise((function(t,r){var n=e.decompressed.getContentWorker().pipe(new s);n.on("error",(function(e){r(e)})).on("end",(function(){n.streamInfo.crc32!==e.decompressed.crc32?r(new Error("Corrupted zip : CRC32 mismatch")):t()})).resume()}))}t.exports=function(e,t){var r=this;return t=n.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),l.isNode&&l.isStream(e)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then((function(e){var r=new o(t);return r.load(e),r})).then((function(e){var r=[i.Promise.resolve(e)],n=e.files;if(t.checkCRC32)for(var a=0;a<n.length;a++)r.push(c(n[a]));return i.Promise.all(r)})).then((function(e){for(var i=e.shift(),a=i.files,o=0;o<a.length;o++){var s=a[o],l=s.fileNameStr,c=n.resolve(s.fileNameStr);r.file(c,s.decompressed,{binary:!0,optimizedBinaryString:!0,date:s.date,dir:s.dir,comment:s.fileCommentStr.length?s.fileCommentStr:null,unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions,createFolders:t.createFolders}),s.dir||(r.file(c).unsafeOriginalName=l)}return i.zipComment.length&&(r.comment=i.zipComment),r}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,r){"use strict";var n=e("../utils"),i=e("../stream/GenericWorker");function a(e,t){i.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}n.inherits(a,i),a.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",(function(e){t.push({data:e,meta:{percent:0}})})).on("error",(function(e){t.isPaused?this.generatedError=e:t.error(e)})).on("end",(function(){t.isPaused?t._upstreamEnded=!0:t.end()}))},a.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,r){"use strict";var n=e("readable-stream").Readable;function i(e,t,r){n.call(this,t),this._helper=e;var i=this;e.on("data",(function(e,t){i.push(e)||i._helper.pause(),r&&r(t)})).on("error",(function(e){i.emit("error",e)})).on("end",(function(){i.push(null)}))}e("../utils").inherits(i,n),i.prototype._read=function(){this._helper.resume()},t.exports=i},{"../utils":32,"readable-stream":16}],14:[function(e,t,r){"use strict";t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,r){"use strict";function n(e,t,r){var n,i=a.getTypeOf(t),s=a.extend(r||{},l);s.date=s.date||new Date,null!==s.compression&&(s.compression=s.compression.toUpperCase()),"string"==typeof s.unixPermissions&&(s.unixPermissions=parseInt(s.unixPermissions,8)),s.unixPermissions&&16384&s.unixPermissions&&(s.dir=!0),s.dosPermissions&&16&s.dosPermissions&&(s.dir=!0),s.dir&&(e=m(e)),s.createFolders&&(n=h(e))&&g.call(this,n,!0);var p="string"===i&&!1===s.binary&&!1===s.base64;r&&void 0!==r.binary||(s.binary=!p),(t instanceof c&&0===t.uncompressedSize||s.dir||!t||0===t.length)&&(s.base64=!1,s.binary=!0,t="",s.compression="STORE",i="string");var y=null;y=t instanceof c||t instanceof o?t:f.isNode&&f.isStream(t)?new d(e,t):a.prepareContent(e,t,s.binary,s.optimizedBinaryString,s.base64);var v=new u(e,y,s);this.files[e]=v}var i=e("./utf8"),a=e("./utils"),o=e("./stream/GenericWorker"),s=e("./stream/StreamHelper"),l=e("./defaults"),c=e("./compressedObject"),u=e("./zipObject"),p=e("./generate"),f=e("./nodejsUtils"),d=e("./nodejs/NodejsStreamInputAdapter"),h=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},m=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},g=function(e,t){return t=void 0!==t?t:l.createFolders,e=m(e),this.files[e]||n.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function y(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var v={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,r,n;for(t in this.files)n=this.files[t],(r=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(r,n)},filter:function(e){var t=[];return this.forEach((function(r,n){e(r,n)&&t.push(n)})),t},file:function(e,t,r){if(1!==arguments.length)return e=this.root+e,n.call(this,e,t,r),this;if(y(e)){var i=e;return this.filter((function(e,t){return!t.dir&&i.test(e)}))}var a=this.files[this.root+e];return a&&!a.dir?a:null},folder:function(e){if(!e)return this;if(y(e))return this.filter((function(t,r){return r.dir&&e.test(t)}));var t=this.root+e,r=g.call(this,t),n=this.clone();return n.root=r.name,n},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var r=this.filter((function(t,r){return r.name.slice(0,e.length)===e})),n=0;n<r.length;n++)delete this.files[r[n].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,r={};try{if((r=a.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=r.type.toLowerCase(),r.compression=r.compression.toUpperCase(),"binarystring"===r.type&&(r.type="string"),!r.type)throw new Error("No output type specified.");a.checkSupport(r.type),"darwin"!==r.platform&&"freebsd"!==r.platform&&"linux"!==r.platform&&"sunos"!==r.platform||(r.platform="UNIX"),"win32"===r.platform&&(r.platform="DOS");var n=r.comment||this.comment||"";t=p.generateWorker(this,r,n)}catch(e){(t=new o("error")).error(e)}return new s(t,r.type||"string",r.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=v},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,r){"use strict";t.exports=e("stream")},{stream:void 0}],17:[function(e,t,r){"use strict";var n=e("./DataReader");function i(e){n.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(i,n),i.prototype.byteAt=function(e){return this.data[this.zero+e]},i.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),i=e.charCodeAt(3),a=this.length-4;0<=a;--a)if(this.data[a]===t&&this.data[a+1]===r&&this.data[a+2]===n&&this.data[a+3]===i)return a-this.zero;return-1},i.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),i=e.charCodeAt(3),a=this.readData(4);return t===a[0]&&r===a[1]&&n===a[2]&&i===a[3]},i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],18:[function(e,t,r){"use strict";var n=e("../utils");function i(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,r=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)r=(r<<8)+this.byteAt(t);return this.index+=e,r},readString:function(e){return n.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=i},{"../utils":32}],19:[function(e,t,r){"use strict";var n=e("./Uint8ArrayReader");function i(e){n.call(this,e)}e("../utils").inherits(i,n),i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,r){"use strict";var n=e("./DataReader");function i(e){n.call(this,e)}e("../utils").inherits(i,n),i.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},i.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},i.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],21:[function(e,t,r){"use strict";var n=e("./ArrayReader");function i(e){n.call(this,e)}e("../utils").inherits(i,n),i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,r){"use strict";var n=e("../utils"),i=e("../support"),a=e("./ArrayReader"),o=e("./StringReader"),s=e("./NodeBufferReader"),l=e("./Uint8ArrayReader");t.exports=function(e){var t=n.getTypeOf(e);return n.checkSupport(t),"string"!==t||i.uint8array?"nodebuffer"===t?new s(e):i.uint8array?new l(n.transformTo("uint8array",e)):new a(n.transformTo("array",e)):new o(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,r){"use strict";r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\b"},{}],24:[function(e,t,r){"use strict";var n=e("./GenericWorker"),i=e("../utils");function a(e){n.call(this,"ConvertWorker to "+e),this.destType=e}i.inherits(a,n),a.prototype.processChunk=function(e){this.push({data:i.transformTo(this.destType,e.data),meta:e.meta})},t.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,r){"use strict";var n=e("./GenericWorker"),i=e("../crc32");function a(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(a,n),a.prototype.processChunk=function(e){this.streamInfo.crc32=i(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,r){"use strict";var n=e("../utils"),i=e("./GenericWorker");function a(e){i.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}n.inherits(a,i),a.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}i.prototype.processChunk.call(this,e)},t.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,r){"use strict";var n=e("../utils"),i=e("./GenericWorker");function a(e){i.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then((function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=n.getTypeOf(e),t.isPaused||t._tickAndRepeat()}),(function(e){t.error(e)}))}n.inherits(a,i),a.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,r){"use strict";function n(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var r=0;r<this._listeners[e].length;r++)this._listeners[e][r].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.end()})),e.on("error",(function(e){t.error(e)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=n},{}],29:[function(e,t,r){"use strict";var n=e("../utils"),i=e("./ConvertWorker"),a=e("./GenericWorker"),o=e("../base64"),s=e("../support"),l=e("../external"),c=null;if(s.nodestream)try{c=e("../nodejs/NodejsStreamOutputAdapter")}catch(e){}function u(e,t){return new l.Promise((function(r,i){var a=[],s=e._internalType,l=e._outputType,c=e._mimeType;e.on("data",(function(e,r){a.push(e),t&&t(r)})).on("error",(function(e){a=[],i(e)})).on("end",(function(){try{var e=function(e,t,r){switch(e){case"blob":return n.newBlob(n.transformTo("arraybuffer",t),r);case"base64":return o.encode(t);default:return n.transformTo(e,t)}}(l,function(e,t){var r,n=0,i=null,a=0;for(r=0;r<t.length;r++)a+=t[r].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(i=new Uint8Array(a),r=0;r<t.length;r++)i.set(t[r],n),n+=t[r].length;return i;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(s,a),c);r(e)}catch(e){i(e)}a=[]})).resume()}))}function p(e,t,r){var o=t;switch(t){case"blob":case"arraybuffer":o="uint8array";break;case"base64":o="string"}try{this._internalType=o,this._outputType=t,this._mimeType=r,n.checkSupport(o),this._worker=e.pipe(new i(o)),e.lock()}catch(e){this._worker=new a("error"),this._worker.error(e)}}p.prototype={accumulate:function(e){return u(this,e)},on:function(e,t){var r=this;return"data"===e?this._worker.on(e,(function(e){t.call(r,e.data,e.meta)})):this._worker.on(e,(function(){n.delay(t,arguments,r)})),this},resume:function(){return n.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(n.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new c(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=p},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,r){"use strict";if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,r.nodebuffer="undefined"!=typeof Buffer,r.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)r.blob=!1;else{var n=new ArrayBuffer(0);try{r.blob=0===new Blob([n],{type:"application/zip"}).size}catch(e){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(n),r.blob=0===i.getBlob("application/zip").size}catch(e){r.blob=!1}}}try{r.nodestream=!!e("readable-stream").Readable}catch(e){r.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,r){"use strict";for(var n=e("./utils"),i=e("./support"),a=e("./nodejsUtils"),o=e("./stream/GenericWorker"),s=new Array(256),l=0;l<256;l++)s[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function c(){o.call(this,"utf-8 decode"),this.leftOver=null}function u(){o.call(this,"utf-8 encode")}s[254]=s[254]=1,r.utf8encode=function(e){return i.nodebuffer?a.newBufferFrom(e,"utf-8"):function(e){var t,r,n,a,o,s=e.length,l=0;for(a=0;a<s;a++)55296==(64512&(r=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(n=e.charCodeAt(a+1)))&&(r=65536+(r-55296<<10)+(n-56320),a++),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=i.uint8array?new Uint8Array(l):new Array(l),a=o=0;o<l;a++)55296==(64512&(r=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(n=e.charCodeAt(a+1)))&&(r=65536+(r-55296<<10)+(n-56320),a++),r<128?t[o++]=r:(r<2048?t[o++]=192|r>>>6:(r<65536?t[o++]=224|r>>>12:(t[o++]=240|r>>>18,t[o++]=128|r>>>12&63),t[o++]=128|r>>>6&63),t[o++]=128|63&r);return t}(e)},r.utf8decode=function(e){return i.nodebuffer?n.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,r,i,a,o=e.length,l=new Array(2*o);for(t=r=0;t<o;)if((i=e[t++])<128)l[r++]=i;else if(4<(a=s[i]))l[r++]=65533,t+=a-1;else{for(i&=2===a?31:3===a?15:7;1<a&&t<o;)i=i<<6|63&e[t++],a--;1<a?l[r++]=65533:i<65536?l[r++]=i:(i-=65536,l[r++]=55296|i>>10&1023,l[r++]=56320|1023&i)}return l.length!==r&&(l.subarray?l=l.subarray(0,r):l.length=r),n.applyFromCharCode(l)}(e=n.transformTo(i.uint8array?"uint8array":"array",e))},n.inherits(c,o),c.prototype.processChunk=function(e){var t=n.transformTo(i.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var a=t;(t=new Uint8Array(a.length+this.leftOver.length)).set(this.leftOver,0),t.set(a,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var o=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;0<=r&&128==(192&e[r]);)r--;return r<0||0===r?t:r+s[e[r]]>t?r:t}(t),l=t;o!==t.length&&(i.uint8array?(l=t.subarray(0,o),this.leftOver=t.subarray(o,t.length)):(l=t.slice(0,o),this.leftOver=t.slice(o,t.length))),this.push({data:r.utf8decode(l),meta:e.meta})},c.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:r.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},r.Utf8DecodeWorker=c,n.inherits(u,o),u.prototype.processChunk=function(e){this.push({data:r.utf8encode(e.data),meta:e.meta})},r.Utf8EncodeWorker=u},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,r){"use strict";var n=e("./support"),i=e("./base64"),a=e("./nodejsUtils"),o=e("./external");function s(e){return e}function l(e,t){for(var r=0;r<e.length;++r)t[r]=255&e.charCodeAt(r);return t}e("setimmediate"),r.newBlob=function(e,t){r.checkSupport("blob");try{return new Blob([e],{type:t})}catch(r){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return n.append(e),n.getBlob(t)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var c={stringifyByChunk:function(e,t,r){var n=[],i=0,a=e.length;if(a<=r)return String.fromCharCode.apply(null,e);for(;i<a;)"array"===t||"nodebuffer"===t?n.push(String.fromCharCode.apply(null,e.slice(i,Math.min(i+r,a)))):n.push(String.fromCharCode.apply(null,e.subarray(i,Math.min(i+r,a)))),i+=r;return n.join("")},stringifyByChar:function(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},applyCanBeUsed:{uint8array:function(){try{return n.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return n.nodebuffer&&1===String.fromCharCode.apply(null,a.allocBuffer(1)).length}catch(e){return!1}}()}};function u(e){var t=65536,n=r.getTypeOf(e),i=!0;if("uint8array"===n?i=c.applyCanBeUsed.uint8array:"nodebuffer"===n&&(i=c.applyCanBeUsed.nodebuffer),i)for(;1<t;)try{return c.stringifyByChunk(e,n,t)}catch(e){t=Math.floor(t/2)}return c.stringifyByChar(e)}function p(e,t){for(var r=0;r<e.length;r++)t[r]=e[r];return t}r.applyFromCharCode=u;var f={};f.string={string:s,array:function(e){return l(e,new Array(e.length))},arraybuffer:function(e){return f.string.uint8array(e).buffer},uint8array:function(e){return l(e,new Uint8Array(e.length))},nodebuffer:function(e){return l(e,a.allocBuffer(e.length))}},f.array={string:u,array:s,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return a.newBufferFrom(e)}},f.arraybuffer={string:function(e){return u(new Uint8Array(e))},array:function(e){return p(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:s,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return a.newBufferFrom(new Uint8Array(e))}},f.uint8array={string:u,array:function(e){return p(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:s,nodebuffer:function(e){return a.newBufferFrom(e)}},f.nodebuffer={string:u,array:function(e){return p(e,new Array(e.length))},arraybuffer:function(e){return f.nodebuffer.uint8array(e).buffer},uint8array:function(e){return p(e,new Uint8Array(e.length))},nodebuffer:s},r.transformTo=function(e,t){if(t=t||"",!e)return t;r.checkSupport(e);var n=r.getTypeOf(t);return f[n][e](t)},r.resolve=function(e){for(var t=e.split("/"),r=[],n=0;n<t.length;n++){var i=t[n];"."===i||""===i&&0!==n&&n!==t.length-1||(".."===i?r.pop():r.push(i))}return r.join("/")},r.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":n.nodebuffer&&a.isBuffer(e)?"nodebuffer":n.uint8array&&e instanceof Uint8Array?"uint8array":n.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(e){if(!n[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(e){var t,r,n="";for(r=0;r<(e||"").length;r++)n+="\\x"+((t=e.charCodeAt(r))<16?"0":"")+t.toString(16).toUpperCase();return n},r.delay=function(e,t,r){setImmediate((function(){e.apply(r||null,t||[])}))},r.inherits=function(e,t){function r(){}r.prototype=t.prototype,e.prototype=new r},r.extend=function(){var e,t,r={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===r[t]&&(r[t]=arguments[e][t]);return r},r.prepareContent=function(e,t,a,s,c){return o.Promise.resolve(t).then((function(e){return n.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new o.Promise((function(t,r){var n=new FileReader;n.onload=function(e){t(e.target.result)},n.onerror=function(e){r(e.target.error)},n.readAsArrayBuffer(e)})):e})).then((function(t){var u=r.getTypeOf(t);return u?("arraybuffer"===u?t=r.transformTo("uint8array",t):"string"===u&&(c?t=i.decode(t):a&&!0!==s&&(t=function(e){return l(e,n.uint8array?new Uint8Array(e.length):new Array(e.length))}(t))),t):o.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,r){"use strict";var n=e("./reader/readerFor"),i=e("./utils"),a=e("./signature"),o=e("./zipEntry"),s=e("./support");function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(t)+", expected "+i.pretty(e)+")")}},isSignature:function(e,t){var r=this.reader.index;this.reader.setIndex(e);var n=this.reader.readString(4)===t;return this.reader.setIndex(r),n},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=s.uint8array?"uint8array":"array",r=i.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,r,n=this.zip64EndOfCentralSize-44;0<n;)e=this.reader.readInt(2),t=this.reader.readInt(4),r=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(e=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var n=t-r;if(0<n)this.isSignature(t,a.CENTRAL_FILE_HEADER)||(this.reader.zero=n);else if(n<0)throw new Error("Corrupted zip: missing "+Math.abs(n)+" bytes.")},prepareReader:function(e){this.reader=n(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,r){"use strict";var n=e("./reader/readerFor"),i=e("./utils"),a=e("./compressedObject"),o=e("./crc32"),s=e("./utf8"),l=e("./compressions"),c=e("./support");function u(e,t){this.options=e,this.loadOptions=t}u.prototype={isEncrypted:function(){return!(1&~this.bitFlag)},useUTF8:function(){return!(2048&~this.bitFlag)},readLocalPart:function(e){var t,r;if(e.skip(22),this.fileNameLength=e.readInt(2),r=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(r),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in l)if(Object.prototype.hasOwnProperty.call(l,t)&&l[t].magic===e)return l[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=n(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,r,n,i=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<i;)t=e.readInt(2),r=e.readInt(2),n=e.readData(r),this.extraFields[t]={id:t,length:r,value:n};e.setIndex(i)},handleUTF8:function(){var e=c.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=s.utf8decode(this.fileName),this.fileCommentStr=s.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var r=i.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var n=this.findExtraFieldUnicodeComment();if(null!==n)this.fileCommentStr=n;else{var a=i.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(a)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=n(e.value);return 1!==t.readInt(1)||o(this.fileName)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=n(e.value);return 1!==t.readInt(1)||o(this.fileComment)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null}},t.exports=u},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,r){"use strict";function n(e,t,r){this.name=e,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=t,this._dataBinary=r.binary,this.options={compression:r.compression,compressionOptions:r.compressionOptions}}var i=e("./stream/StreamHelper"),a=e("./stream/DataWorker"),o=e("./utf8"),s=e("./compressedObject"),l=e("./stream/GenericWorker");n.prototype={internalStream:function(e){var t=null,r="string";try{if(!e)throw new Error("No output type specified.");var n="string"===(r=e.toLowerCase())||"text"===r;"binarystring"!==r&&"text"!==r||(r="string"),t=this._decompressWorker();var a=!this._dataBinary;a&&!n&&(t=t.pipe(new o.Utf8EncodeWorker)),!a&&n&&(t=t.pipe(new o.Utf8DecodeWorker))}catch(e){(t=new l("error")).error(e)}return new i(t,r,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof s&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var r=this._decompressWorker();return this._dataBinary||(r=r.pipe(new o.Utf8EncodeWorker)),s.createWorkerFrom(r,e,t)},_decompressWorker:function(){return this._data instanceof s?this._data.getContentWorker():this._data instanceof l?this._data:new a(this._data)}};for(var c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],u=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},p=0;p<c.length;p++)n.prototype[c[p]]=u;t.exports=n},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,n){(function(e){"use strict";var r,n,i=e.MutationObserver||e.WebKitMutationObserver;if(i){var a=0,o=new i(u),s=e.document.createTextNode("");o.observe(s,{characterData:!0}),r=function(){s.data=a=++a%2}}else if(e.setImmediate||void 0===e.MessageChannel)r="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var l=new e.MessageChannel;l.port1.onmessage=u,r=function(){l.port2.postMessage(0)}}var c=[];function u(){var e,t;n=!0;for(var r=c.length;r;){for(t=c,c=[],e=-1;++e<r;)t[e]();r=c.length}n=!1}t.exports=function(e){1!==c.push(e)||n||r()}}).call(this,void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,r){"use strict";var n=e("immediate");function i(){}var a={},o=["REJECTED"],s=["FULFILLED"],l=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==i&&d(this,e)}function u(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function p(e,t,r){n((function(){var n;try{n=t(r)}catch(n){return a.reject(e,n)}n===e?a.reject(e,new TypeError("Cannot resolve promise with itself")):a.resolve(e,n)}))}function f(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function d(e,t){var r=!1;function n(t){r||(r=!0,a.reject(e,t))}function i(t){r||(r=!0,a.resolve(e,t))}var o=h((function(){t(i,n)}));"error"===o.status&&n(o.value)}function h(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}(t.exports=c).prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then((function(r){return t.resolve(e()).then((function(){return r}))}),(function(r){return t.resolve(e()).then((function(){throw r}))}))},c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===o)return this;var r=new this.constructor(i);return this.state!==l?p(r,this.state===s?e:t,this.outcome):this.queue.push(new u(r,e,t)),r},u.prototype.callFulfilled=function(e){a.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){p(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){a.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){p(this.promise,this.onRejected,e)},a.resolve=function(e,t){var r=h(f,t);if("error"===r.status)return a.reject(e,r.value);var n=r.value;if(n)d(e,n);else{e.state=s,e.outcome=t;for(var i=-1,o=e.queue.length;++i<o;)e.queue[i].callFulfilled(t)}return e},a.reject=function(e,t){e.state=o,e.outcome=t;for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callRejected(t);return e},c.resolve=function(e){return e instanceof this?e:a.resolve(new this(i),e)},c.reject=function(e){var t=new this(i);return a.reject(t,e)},c.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var o=new Array(r),s=0,l=-1,c=new this(i);++l<r;)u(e[l],l);return c;function u(e,i){t.resolve(e).then((function(e){o[i]=e,++s!==r||n||(n=!0,a.resolve(c,o))}),(function(e){n||(n=!0,a.reject(c,e))}))}},c.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var o,s=-1,l=new this(i);++s<r;)o=e[s],t.resolve(o).then((function(e){n||(n=!0,a.resolve(l,e))}),(function(e){n||(n=!0,a.reject(l,e))}));return l}},{immediate:36}],38:[function(e,t,r){"use strict";var n={};(0,e("./lib/utils/common").assign)(n,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=n},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,r){"use strict";var n=e("./zlib/deflate"),i=e("./utils/common"),a=e("./utils/strings"),o=e("./zlib/messages"),s=e("./zlib/zstream"),l=Object.prototype.toString,c=0,u=-1,p=0,f=8;function d(e){if(!(this instanceof d))return new d(e);this.options=i.assign({level:u,method:f,chunkSize:16384,windowBits:15,memLevel:8,strategy:p,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var r=n.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==c)throw new Error(o[r]);if(t.header&&n.deflateSetHeader(this.strm,t.header),t.dictionary){var h;if(h="string"==typeof t.dictionary?a.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(r=n.deflateSetDictionary(this.strm,h))!==c)throw new Error(o[r]);this._dict_set=!0}}function h(e,t){var r=new d(t);if(r.push(e,!0),r.err)throw r.msg||o[r.err];return r.result}d.prototype.push=function(e,t){var r,o,s=this.strm,u=this.options.chunkSize;if(this.ended)return!1;o=t===~~t?t:!0===t?4:0,"string"==typeof e?s.input=a.string2buf(e):"[object ArrayBuffer]"===l.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new i.Buf8(u),s.next_out=0,s.avail_out=u),1!==(r=n.deflate(s,o))&&r!==c)return this.onEnd(r),!(this.ended=!0);0!==s.avail_out&&(0!==s.avail_in||4!==o&&2!==o)||("string"===this.options.to?this.onData(a.buf2binstring(i.shrinkBuf(s.output,s.next_out))):this.onData(i.shrinkBuf(s.output,s.next_out)))}while((0<s.avail_in||0===s.avail_out)&&1!==r);return 4===o?(r=n.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===c):2!==o||(this.onEnd(c),!(s.avail_out=0))},d.prototype.onData=function(e){this.chunks.push(e)},d.prototype.onEnd=function(e){e===c&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Deflate=d,r.deflate=h,r.deflateRaw=function(e,t){return(t=t||{}).raw=!0,h(e,t)},r.gzip=function(e,t){return(t=t||{}).gzip=!0,h(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,r){"use strict";var n=e("./zlib/inflate"),i=e("./utils/common"),a=e("./utils/strings"),o=e("./zlib/constants"),s=e("./zlib/messages"),l=e("./zlib/zstream"),c=e("./zlib/gzheader"),u=Object.prototype.toString;function p(e){if(!(this instanceof p))return new p(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&!(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var r=n.inflateInit2(this.strm,t.windowBits);if(r!==o.Z_OK)throw new Error(s[r]);this.header=new c,n.inflateGetHeader(this.strm,this.header)}function f(e,t){var r=new p(t);if(r.push(e,!0),r.err)throw r.msg||s[r.err];return r.result}p.prototype.push=function(e,t){var r,s,l,c,p,f,d=this.strm,h=this.options.chunkSize,m=this.options.dictionary,g=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?o.Z_FINISH:o.Z_NO_FLUSH,"string"==typeof e?d.input=a.binstring2buf(e):"[object ArrayBuffer]"===u.call(e)?d.input=new Uint8Array(e):d.input=e,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new i.Buf8(h),d.next_out=0,d.avail_out=h),(r=n.inflate(d,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&m&&(f="string"==typeof m?a.string2buf(m):"[object ArrayBuffer]"===u.call(m)?new Uint8Array(m):m,r=n.inflateSetDictionary(this.strm,f)),r===o.Z_BUF_ERROR&&!0===g&&(r=o.Z_OK,g=!1),r!==o.Z_STREAM_END&&r!==o.Z_OK)return this.onEnd(r),!(this.ended=!0);d.next_out&&(0!==d.avail_out&&r!==o.Z_STREAM_END&&(0!==d.avail_in||s!==o.Z_FINISH&&s!==o.Z_SYNC_FLUSH)||("string"===this.options.to?(l=a.utf8border(d.output,d.next_out),c=d.next_out-l,p=a.buf2string(d.output,l),d.next_out=c,d.avail_out=h-c,c&&i.arraySet(d.output,d.output,l,c,0),this.onData(p)):this.onData(i.shrinkBuf(d.output,d.next_out)))),0===d.avail_in&&0===d.avail_out&&(g=!0)}while((0<d.avail_in||0===d.avail_out)&&r!==o.Z_STREAM_END);return r===o.Z_STREAM_END&&(s=o.Z_FINISH),s===o.Z_FINISH?(r=n.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===o.Z_OK):s!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),!(d.avail_out=0))},p.prototype.onData=function(e){this.chunks.push(e)},p.prototype.onEnd=function(e){e===o.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Inflate=p,r.inflate=f,r.inflateRaw=function(e,t){return(t=t||{}).raw=!0,f(e,t)},r.ungzip=f},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,r){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;r.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])}}return e},r.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,r,n,i){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+n),i);else for(var a=0;a<n;a++)e[i+a]=t[r+a]},flattenChunks:function(e){var t,r,n,i,a,o;for(t=n=0,r=e.length;t<r;t++)n+=e[t].length;for(o=new Uint8Array(n),t=i=0,r=e.length;t<r;t++)a=e[t],o.set(a,i),i+=a.length;return o}},a={arraySet:function(e,t,r,n,i){for(var a=0;a<n;a++)e[i+a]=t[r+a]},flattenChunks:function(e){return[].concat.apply([],e)}};r.setTyped=function(e){e?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,i)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,a))},r.setTyped(n)},{}],42:[function(e,t,r){"use strict";var n=e("./common"),i=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(e){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){a=!1}for(var o=new n.Buf8(256),s=0;s<256;s++)o[s]=252<=s?6:248<=s?5:240<=s?4:224<=s?3:192<=s?2:1;function l(e,t){if(t<65537&&(e.subarray&&a||!e.subarray&&i))return String.fromCharCode.apply(null,n.shrinkBuf(e,t));for(var r="",o=0;o<t;o++)r+=String.fromCharCode(e[o]);return r}o[254]=o[254]=1,r.string2buf=function(e){var t,r,i,a,o,s=e.length,l=0;for(a=0;a<s;a++)55296==(64512&(r=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(i=e.charCodeAt(a+1)))&&(r=65536+(r-55296<<10)+(i-56320),a++),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new n.Buf8(l),a=o=0;o<l;a++)55296==(64512&(r=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(i=e.charCodeAt(a+1)))&&(r=65536+(r-55296<<10)+(i-56320),a++),r<128?t[o++]=r:(r<2048?t[o++]=192|r>>>6:(r<65536?t[o++]=224|r>>>12:(t[o++]=240|r>>>18,t[o++]=128|r>>>12&63),t[o++]=128|r>>>6&63),t[o++]=128|63&r);return t},r.buf2binstring=function(e){return l(e,e.length)},r.binstring2buf=function(e){for(var t=new n.Buf8(e.length),r=0,i=t.length;r<i;r++)t[r]=e.charCodeAt(r);return t},r.buf2string=function(e,t){var r,n,i,a,s=t||e.length,c=new Array(2*s);for(r=n=0;r<s;)if((i=e[r++])<128)c[n++]=i;else if(4<(a=o[i]))c[n++]=65533,r+=a-1;else{for(i&=2===a?31:3===a?15:7;1<a&&r<s;)i=i<<6|63&e[r++],a--;1<a?c[n++]=65533:i<65536?c[n++]=i:(i-=65536,c[n++]=55296|i>>10&1023,c[n++]=56320|1023&i)}return l(c,n)},r.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;0<=r&&128==(192&e[r]);)r--;return r<0||0===r?t:r+o[e[r]]>t?r:t}},{"./common":41}],43:[function(e,t,r){"use strict";t.exports=function(e,t,r,n){for(var i=65535&e,a=e>>>16&65535,o=0;0!==r;){for(r-=o=2e3<r?2e3:r;a=a+(i=i+t[n++]|0)|0,--o;);i%=65521,a%=65521}return i|a<<16}},{}],44:[function(e,t,r){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,r){"use strict";var n=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t,r,i){var a=n,o=i+r;e^=-1;for(var s=i;s<o;s++)e=e>>>8^a[255&(e^t[s])];return~e}},{}],46:[function(e,t,r){"use strict";var n,i=e("../utils/common"),a=e("./trees"),o=e("./adler32"),s=e("./crc32"),l=e("./messages"),c=0,u=4,p=0,f=-2,d=-1,h=4,m=2,g=8,y=9,v=286,b=30,_=19,w=2*v+1,x=15,S=3,O=258,k=O+S+1,E=42,M=113,C=1,T=2,I=3,P=4;function j(e,t){return e.msg=l[t],t}function N(e){return(e<<1)-(4<e?9:0)}function L(e){for(var t=e.length;0<=--t;)e[t]=0}function A(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(i.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function z(e,t){a._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,A(e.strm)}function D(e,t){e.pending_buf[e.pending++]=t}function R(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function F(e,t){var r,n,i=e.max_chain_length,a=e.strstart,o=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-k?e.strstart-(e.w_size-k):0,c=e.window,u=e.w_mask,p=e.prev,f=e.strstart+O,d=c[a+o-1],h=c[a+o];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(c[(r=t)+o]===h&&c[r+o-1]===d&&c[r]===c[a]&&c[++r]===c[a+1]){a+=2,r++;do{}while(c[++a]===c[++r]&&c[++a]===c[++r]&&c[++a]===c[++r]&&c[++a]===c[++r]&&c[++a]===c[++r]&&c[++a]===c[++r]&&c[++a]===c[++r]&&c[++a]===c[++r]&&a<f);if(n=O-(f-a),a=f-O,o<n){if(e.match_start=t,s<=(o=n))break;d=c[a+o-1],h=c[a+o]}}}while((t=p[t&u])>l&&0!=--i);return o<=e.lookahead?o:e.lookahead}function B(e){var t,r,n,a,l,c,u,p,f,d,h=e.w_size;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=h+(h-k)){for(i.arraySet(e.window,e.window,h,h,0),e.match_start-=h,e.strstart-=h,e.block_start-=h,t=r=e.hash_size;n=e.head[--t],e.head[t]=h<=n?n-h:0,--r;);for(t=r=h;n=e.prev[--t],e.prev[t]=h<=n?n-h:0,--r;);a+=h}if(0===e.strm.avail_in)break;if(c=e.strm,u=e.window,p=e.strstart+e.lookahead,d=void 0,(f=a)<(d=c.avail_in)&&(d=f),r=0===d?0:(c.avail_in-=d,i.arraySet(u,c.input,c.next_in,d,p),1===c.state.wrap?c.adler=o(c.adler,u,d,p):2===c.state.wrap&&(c.adler=s(c.adler,u,d,p)),c.next_in+=d,c.total_in+=d,d),e.lookahead+=r,e.lookahead+e.insert>=S)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+S-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<S)););}while(e.lookahead<k&&0!==e.strm.avail_in)}function U(e,t){for(var r,n;;){if(e.lookahead<k){if(B(e),e.lookahead<k&&t===c)return C;if(0===e.lookahead)break}if(r=0,e.lookahead>=S&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+S-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-k&&(e.match_length=F(e,r)),e.match_length>=S)if(n=a._tr_tally(e,e.strstart-e.match_start,e.match_length-S),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=S){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+S-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(z(e,!1),0===e.strm.avail_out))return C}return e.insert=e.strstart<S-1?e.strstart:S-1,t===u?(z(e,!0),0===e.strm.avail_out?I:P):e.last_lit&&(z(e,!1),0===e.strm.avail_out)?C:T}function G(e,t){for(var r,n,i;;){if(e.lookahead<k){if(B(e),e.lookahead<k&&t===c)return C;if(0===e.lookahead)break}if(r=0,e.lookahead>=S&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+S-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=S-1,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-k&&(e.match_length=F(e,r),e.match_length<=5&&(1===e.strategy||e.match_length===S&&4096<e.strstart-e.match_start)&&(e.match_length=S-1)),e.prev_length>=S&&e.match_length<=e.prev_length){for(i=e.strstart+e.lookahead-S,n=a._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-S),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+S-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=S-1,e.strstart++,n&&(z(e,!1),0===e.strm.avail_out))return C}else if(e.match_available){if((n=a._tr_tally(e,0,e.window[e.strstart-1]))&&z(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return C}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=a._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<S-1?e.strstart:S-1,t===u?(z(e,!0),0===e.strm.avail_out?I:P):e.last_lit&&(z(e,!1),0===e.strm.avail_out)?C:T}function W(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}function Z(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=g,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*w),this.dyn_dtree=new i.Buf16(2*(2*b+1)),this.bl_tree=new i.Buf16(2*(2*_+1)),L(this.dyn_ltree),L(this.dyn_dtree),L(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(x+1),this.heap=new i.Buf16(2*v+1),L(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*v+1),L(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function H(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=m,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?E:M,e.adler=2===t.wrap?0:1,t.last_flush=c,a._tr_init(t),p):j(e,f)}function q(e){var t=H(e);return t===p&&function(e){e.window_size=2*e.w_size,L(e.head),e.max_lazy_match=n[e.level].max_lazy,e.good_match=n[e.level].good_length,e.nice_match=n[e.level].nice_length,e.max_chain_length=n[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=S-1,e.match_available=0,e.ins_h=0}(e.state),t}function V(e,t,r,n,a,o){if(!e)return f;var s=1;if(t===d&&(t=6),n<0?(s=0,n=-n):15<n&&(s=2,n-=16),a<1||y<a||r!==g||n<8||15<n||t<0||9<t||o<0||h<o)return j(e,f);8===n&&(n=9);var l=new Z;return(e.state=l).strm=e,l.wrap=s,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=a+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+S-1)/S),l.window=new i.Buf8(2*l.w_size),l.head=new i.Buf16(l.hash_size),l.prev=new i.Buf16(l.w_size),l.lit_bufsize=1<<a+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new i.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=o,l.method=r,q(e)}n=[new W(0,0,0,0,(function(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(B(e),0===e.lookahead&&t===c)return C;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+r;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,z(e,!1),0===e.strm.avail_out))return C;if(e.strstart-e.block_start>=e.w_size-k&&(z(e,!1),0===e.strm.avail_out))return C}return e.insert=0,t===u?(z(e,!0),0===e.strm.avail_out?I:P):(e.strstart>e.block_start&&(z(e,!1),e.strm.avail_out),C)})),new W(4,4,8,4,U),new W(4,5,16,8,U),new W(4,6,32,32,U),new W(4,4,16,16,G),new W(8,16,32,32,G),new W(8,16,128,128,G),new W(8,32,128,256,G),new W(32,128,258,1024,G),new W(32,258,258,4096,G)],r.deflateInit=function(e,t){return V(e,t,g,15,8,0)},r.deflateInit2=V,r.deflateReset=q,r.deflateResetKeep=H,r.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?f:(e.state.gzhead=t,p):f},r.deflate=function(e,t){var r,i,o,l;if(!e||!e.state||5<t||t<0)return e?j(e,f):f;if(i=e.state,!e.output||!e.input&&0!==e.avail_in||666===i.status&&t!==u)return j(e,0===e.avail_out?-5:f);if(i.strm=e,r=i.last_flush,i.last_flush=t,i.status===E)if(2===i.wrap)e.adler=0,D(i,31),D(i,139),D(i,8),i.gzhead?(D(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),D(i,255&i.gzhead.time),D(i,i.gzhead.time>>8&255),D(i,i.gzhead.time>>16&255),D(i,i.gzhead.time>>24&255),D(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),D(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(D(i,255&i.gzhead.extra.length),D(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=s(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(D(i,0),D(i,0),D(i,0),D(i,0),D(i,0),D(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),D(i,3),i.status=M);else{var d=g+(i.w_bits-8<<4)<<8;d|=(2<=i.strategy||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(d|=32),d+=31-d%31,i.status=M,R(i,d),0!==i.strstart&&(R(i,e.adler>>>16),R(i,65535&e.adler)),e.adler=1}if(69===i.status)if(i.gzhead.extra){for(o=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),A(e),o=i.pending,i.pending!==i.pending_buf_size));)D(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){o=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),A(e),o=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,D(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),0===l&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){o=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),A(e),o=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,D(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),0===l&&(i.status=103)}else i.status=103;if(103===i.status&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&A(e),i.pending+2<=i.pending_buf_size&&(D(i,255&e.adler),D(i,e.adler>>8&255),e.adler=0,i.status=M)):i.status=M),0!==i.pending){if(A(e),0===e.avail_out)return i.last_flush=-1,p}else if(0===e.avail_in&&N(t)<=N(r)&&t!==u)return j(e,-5);if(666===i.status&&0!==e.avail_in)return j(e,-5);if(0!==e.avail_in||0!==i.lookahead||t!==c&&666!==i.status){var h=2===i.strategy?function(e,t){for(var r;;){if(0===e.lookahead&&(B(e),0===e.lookahead)){if(t===c)return C;break}if(e.match_length=0,r=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(z(e,!1),0===e.strm.avail_out))return C}return e.insert=0,t===u?(z(e,!0),0===e.strm.avail_out?I:P):e.last_lit&&(z(e,!1),0===e.strm.avail_out)?C:T}(i,t):3===i.strategy?function(e,t){for(var r,n,i,o,s=e.window;;){if(e.lookahead<=O){if(B(e),e.lookahead<=O&&t===c)return C;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=S&&0<e.strstart&&(n=s[i=e.strstart-1])===s[++i]&&n===s[++i]&&n===s[++i]){o=e.strstart+O;do{}while(n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&i<o);e.match_length=O-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=S?(r=a._tr_tally(e,1,e.match_length-S),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(z(e,!1),0===e.strm.avail_out))return C}return e.insert=0,t===u?(z(e,!0),0===e.strm.avail_out?I:P):e.last_lit&&(z(e,!1),0===e.strm.avail_out)?C:T}(i,t):n[i.level].func(i,t);if(h!==I&&h!==P||(i.status=666),h===C||h===I)return 0===e.avail_out&&(i.last_flush=-1),p;if(h===T&&(1===t?a._tr_align(i):5!==t&&(a._tr_stored_block(i,0,0,!1),3===t&&(L(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),A(e),0===e.avail_out))return i.last_flush=-1,p}return t!==u?p:i.wrap<=0?1:(2===i.wrap?(D(i,255&e.adler),D(i,e.adler>>8&255),D(i,e.adler>>16&255),D(i,e.adler>>24&255),D(i,255&e.total_in),D(i,e.total_in>>8&255),D(i,e.total_in>>16&255),D(i,e.total_in>>24&255)):(R(i,e.adler>>>16),R(i,65535&e.adler)),A(e),0<i.wrap&&(i.wrap=-i.wrap),0!==i.pending?p:1)},r.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==E&&69!==t&&73!==t&&91!==t&&103!==t&&t!==M&&666!==t?j(e,f):(e.state=null,t===M?j(e,-3):p):f},r.deflateSetDictionary=function(e,t){var r,n,a,s,l,c,u,d,h=t.length;if(!e||!e.state)return f;if(2===(s=(r=e.state).wrap)||1===s&&r.status!==E||r.lookahead)return f;for(1===s&&(e.adler=o(e.adler,t,h,0)),r.wrap=0,h>=r.w_size&&(0===s&&(L(r.head),r.strstart=0,r.block_start=0,r.insert=0),d=new i.Buf8(r.w_size),i.arraySet(d,t,h-r.w_size,r.w_size,0),t=d,h=r.w_size),l=e.avail_in,c=e.next_in,u=e.input,e.avail_in=h,e.next_in=0,e.input=t,B(r);r.lookahead>=S;){for(n=r.strstart,a=r.lookahead-(S-1);r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+S-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++,--a;);r.strstart=n,r.lookahead=S-1,B(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=S-1,r.match_available=0,e.next_in=c,e.input=u,e.avail_in=l,r.wrap=s,p},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,r){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,r){"use strict";t.exports=function(e,t){var r,n,i,a,o,s,l,c,u,p,f,d,h,m,g,y,v,b,_,w,x,S,O,k,E;r=e.state,n=e.next_in,k=e.input,i=n+(e.avail_in-5),a=e.next_out,E=e.output,o=a-(t-e.avail_out),s=a+(e.avail_out-257),l=r.dmax,c=r.wsize,u=r.whave,p=r.wnext,f=r.window,d=r.hold,h=r.bits,m=r.lencode,g=r.distcode,y=(1<<r.lenbits)-1,v=(1<<r.distbits)-1;e:do{h<15&&(d+=k[n++]<<h,h+=8,d+=k[n++]<<h,h+=8),b=m[d&y];t:for(;;){if(d>>>=_=b>>>24,h-=_,0==(_=b>>>16&255))E[a++]=65535&b;else{if(!(16&_)){if(!(64&_)){b=m[(65535&b)+(d&(1<<_)-1)];continue t}if(32&_){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}w=65535&b,(_&=15)&&(h<_&&(d+=k[n++]<<h,h+=8),w+=d&(1<<_)-1,d>>>=_,h-=_),h<15&&(d+=k[n++]<<h,h+=8,d+=k[n++]<<h,h+=8),b=g[d&v];r:for(;;){if(d>>>=_=b>>>24,h-=_,!(16&(_=b>>>16&255))){if(!(64&_)){b=g[(65535&b)+(d&(1<<_)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(x=65535&b,h<(_&=15)&&(d+=k[n++]<<h,(h+=8)<_&&(d+=k[n++]<<h,h+=8)),l<(x+=d&(1<<_)-1)){e.msg="invalid distance too far back",r.mode=30;break e}if(d>>>=_,h-=_,(_=a-o)<x){if(u<(_=x-_)&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(O=f,(S=0)===p){if(S+=c-_,_<w){for(w-=_;E[a++]=f[S++],--_;);S=a-x,O=E}}else if(p<_){if(S+=c+p-_,(_-=p)<w){for(w-=_;E[a++]=f[S++],--_;);if(S=0,p<w){for(w-=_=p;E[a++]=f[S++],--_;);S=a-x,O=E}}}else if(S+=p-_,_<w){for(w-=_;E[a++]=f[S++],--_;);S=a-x,O=E}for(;2<w;)E[a++]=O[S++],E[a++]=O[S++],E[a++]=O[S++],w-=3;w&&(E[a++]=O[S++],1<w&&(E[a++]=O[S++]))}else{for(S=a-x;E[a++]=E[S++],E[a++]=E[S++],E[a++]=E[S++],2<(w-=3););w&&(E[a++]=E[S++],1<w&&(E[a++]=E[S++]))}break}}break}}while(n<i&&a<s);n-=w=h>>3,d&=(1<<(h-=w<<3))-1,e.next_in=n,e.next_out=a,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=a<s?s-a+257:257-(a-s),r.hold=d,r.bits=h}},{}],49:[function(e,t,r){"use strict";var n=e("../utils/common"),i=e("./adler32"),a=e("./crc32"),o=e("./inffast"),s=e("./inftrees"),l=1,c=2,u=0,p=-2,f=1,d=852,h=592;function m(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function g(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function y(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=f,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new n.Buf32(d),t.distcode=t.distdyn=new n.Buf32(h),t.sane=1,t.back=-1,u):p}function v(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,y(e)):p}function b(e,t){var r,n;return e&&e.state?(n=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?p:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,v(e))):p}function _(e,t){var r,n;return e?(n=new g,(e.state=n).window=null,(r=b(e,t))!==u&&(e.state=null),r):p}var w,x,S=!0;function O(e){if(S){var t;for(w=new n.Buf32(512),x=new n.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(l,e.lens,0,288,w,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(c,e.lens,0,32,x,0,e.work,{bits:5}),S=!1}e.lencode=w,e.lenbits=9,e.distcode=x,e.distbits=5}function k(e,t,r,i){var a,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new n.Buf8(o.wsize)),i>=o.wsize?(n.arraySet(o.window,t,r-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(i<(a=o.wsize-o.wnext)&&(a=i),n.arraySet(o.window,t,r-i,a,o.wnext),(i-=a)?(n.arraySet(o.window,t,r-i,i,0),o.wnext=i,o.whave=o.wsize):(o.wnext+=a,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=a))),0}r.inflateReset=v,r.inflateReset2=b,r.inflateResetKeep=y,r.inflateInit=function(e){return _(e,15)},r.inflateInit2=_,r.inflate=function(e,t){var r,d,h,g,y,v,b,_,w,x,S,E,M,C,T,I,P,j,N,L,A,z,D,R,F=0,B=new n.Buf8(4),U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return p;12===(r=e.state).mode&&(r.mode=13),y=e.next_out,h=e.output,b=e.avail_out,g=e.next_in,d=e.input,v=e.avail_in,_=r.hold,w=r.bits,x=v,S=b,z=u;e:for(;;)switch(r.mode){case f:if(0===r.wrap){r.mode=13;break}for(;w<16;){if(0===v)break e;v--,_+=d[g++]<<w,w+=8}if(2&r.wrap&&35615===_){B[r.check=0]=255&_,B[1]=_>>>8&255,r.check=a(r.check,B,2,0),w=_=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&_)<<8)+(_>>8))%31){e.msg="incorrect header check",r.mode=30;break}if(8!=(15&_)){e.msg="unknown compression method",r.mode=30;break}if(w-=4,A=8+(15&(_>>>=4)),0===r.wbits)r.wbits=A;else if(A>r.wbits){e.msg="invalid window size",r.mode=30;break}r.dmax=1<<A,e.adler=r.check=1,r.mode=512&_?10:12,w=_=0;break;case 2:for(;w<16;){if(0===v)break e;v--,_+=d[g++]<<w,w+=8}if(r.flags=_,8!=(255&r.flags)){e.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=_>>8&1),512&r.flags&&(B[0]=255&_,B[1]=_>>>8&255,r.check=a(r.check,B,2,0)),w=_=0,r.mode=3;case 3:for(;w<32;){if(0===v)break e;v--,_+=d[g++]<<w,w+=8}r.head&&(r.head.time=_),512&r.flags&&(B[0]=255&_,B[1]=_>>>8&255,B[2]=_>>>16&255,B[3]=_>>>24&255,r.check=a(r.check,B,4,0)),w=_=0,r.mode=4;case 4:for(;w<16;){if(0===v)break e;v--,_+=d[g++]<<w,w+=8}r.head&&(r.head.xflags=255&_,r.head.os=_>>8),512&r.flags&&(B[0]=255&_,B[1]=_>>>8&255,r.check=a(r.check,B,2,0)),w=_=0,r.mode=5;case 5:if(1024&r.flags){for(;w<16;){if(0===v)break e;v--,_+=d[g++]<<w,w+=8}r.length=_,r.head&&(r.head.extra_len=_),512&r.flags&&(B[0]=255&_,B[1]=_>>>8&255,r.check=a(r.check,B,2,0)),w=_=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&(v<(E=r.length)&&(E=v),E&&(r.head&&(A=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),n.arraySet(r.head.extra,d,g,E,A)),512&r.flags&&(r.check=a(r.check,d,E,g)),v-=E,g+=E,r.length-=E),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===v)break e;for(E=0;A=d[g+E++],r.head&&A&&r.length<65536&&(r.head.name+=String.fromCharCode(A)),A&&E<v;);if(512&r.flags&&(r.check=a(r.check,d,E,g)),v-=E,g+=E,A)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===v)break e;for(E=0;A=d[g+E++],r.head&&A&&r.length<65536&&(r.head.comment+=String.fromCharCode(A)),A&&E<v;);if(512&r.flags&&(r.check=a(r.check,d,E,g)),v-=E,g+=E,A)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;w<16;){if(0===v)break e;v--,_+=d[g++]<<w,w+=8}if(_!==(65535&r.check)){e.msg="header crc mismatch",r.mode=30;break}w=_=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=12;break;case 10:for(;w<32;){if(0===v)break e;v--,_+=d[g++]<<w,w+=8}e.adler=r.check=m(_),w=_=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=y,e.avail_out=b,e.next_in=g,e.avail_in=v,r.hold=_,r.bits=w,2;e.adler=r.check=1,r.mode=12;case 12:if(5===t||6===t)break e;case 13:if(r.last){_>>>=7&w,w-=7&w,r.mode=27;break}for(;w<3;){if(0===v)break e;v--,_+=d[g++]<<w,w+=8}switch(r.last=1&_,w-=1,3&(_>>>=1)){case 0:r.mode=14;break;case 1:if(O(r),r.mode=20,6!==t)break;_>>>=2,w-=2;break e;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=30}_>>>=2,w-=2;break;case 14:for(_>>>=7&w,w-=7&w;w<32;){if(0===v)break e;v--,_+=d[g++]<<w,w+=8}if((65535&_)!=(_>>>16^65535)){e.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&_,w=_=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(E=r.length){if(v<E&&(E=v),b<E&&(E=b),0===E)break e;n.arraySet(h,d,g,E,y),v-=E,g+=E,b-=E,y+=E,r.length-=E;break}r.mode=12;break;case 17:for(;w<14;){if(0===v)break e;v--,_+=d[g++]<<w,w+=8}if(r.nlen=257+(31&_),_>>>=5,w-=5,r.ndist=1+(31&_),_>>>=5,w-=5,r.ncode=4+(15&_),_>>>=4,w-=4,286<r.nlen||30<r.ndist){e.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;w<3;){if(0===v)break e;v--,_+=d[g++]<<w,w+=8}r.lens[U[r.have++]]=7&_,_>>>=3,w-=3}for(;r.have<19;)r.lens[U[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,D={bits:r.lenbits},z=s(0,r.lens,0,19,r.lencode,0,r.work,D),r.lenbits=D.bits,z){e.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;I=(F=r.lencode[_&(1<<r.lenbits)-1])>>>16&255,P=65535&F,!((T=F>>>24)<=w);){if(0===v)break e;v--,_+=d[g++]<<w,w+=8}if(P<16)_>>>=T,w-=T,r.lens[r.have++]=P;else{if(16===P){for(R=T+2;w<R;){if(0===v)break e;v--,_+=d[g++]<<w,w+=8}if(_>>>=T,w-=T,0===r.have){e.msg="invalid bit length repeat",r.mode=30;break}A=r.lens[r.have-1],E=3+(3&_),_>>>=2,w-=2}else if(17===P){for(R=T+3;w<R;){if(0===v)break e;v--,_+=d[g++]<<w,w+=8}w-=T,A=0,E=3+(7&(_>>>=T)),_>>>=3,w-=3}else{for(R=T+7;w<R;){if(0===v)break e;v--,_+=d[g++]<<w,w+=8}w-=T,A=0,E=11+(127&(_>>>=T)),_>>>=7,w-=7}if(r.have+E>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=30;break}for(;E--;)r.lens[r.have++]=A}}if(30===r.mode)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,D={bits:r.lenbits},z=s(l,r.lens,0,r.nlen,r.lencode,0,r.work,D),r.lenbits=D.bits,z){e.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,D={bits:r.distbits},z=s(c,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,D),r.distbits=D.bits,z){e.msg="invalid distances set",r.mode=30;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(6<=v&&258<=b){e.next_out=y,e.avail_out=b,e.next_in=g,e.avail_in=v,r.hold=_,r.bits=w,o(e,S),y=e.next_out,h=e.output,b=e.avail_out,g=e.next_in,d=e.input,v=e.avail_in,_=r.hold,w=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;I=(F=r.lencode[_&(1<<r.lenbits)-1])>>>16&255,P=65535&F,!((T=F>>>24)<=w);){if(0===v)break e;v--,_+=d[g++]<<w,w+=8}if(I&&!(240&I)){for(j=T,N=I,L=P;I=(F=r.lencode[L+((_&(1<<j+N)-1)>>j)])>>>16&255,P=65535&F,!(j+(T=F>>>24)<=w);){if(0===v)break e;v--,_+=d[g++]<<w,w+=8}_>>>=j,w-=j,r.back+=j}if(_>>>=T,w-=T,r.back+=T,r.length=P,0===I){r.mode=26;break}if(32&I){r.back=-1,r.mode=12;break}if(64&I){e.msg="invalid literal/length code",r.mode=30;break}r.extra=15&I,r.mode=22;case 22:if(r.extra){for(R=r.extra;w<R;){if(0===v)break e;v--,_+=d[g++]<<w,w+=8}r.length+=_&(1<<r.extra)-1,_>>>=r.extra,w-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;I=(F=r.distcode[_&(1<<r.distbits)-1])>>>16&255,P=65535&F,!((T=F>>>24)<=w);){if(0===v)break e;v--,_+=d[g++]<<w,w+=8}if(!(240&I)){for(j=T,N=I,L=P;I=(F=r.distcode[L+((_&(1<<j+N)-1)>>j)])>>>16&255,P=65535&F,!(j+(T=F>>>24)<=w);){if(0===v)break e;v--,_+=d[g++]<<w,w+=8}_>>>=j,w-=j,r.back+=j}if(_>>>=T,w-=T,r.back+=T,64&I){e.msg="invalid distance code",r.mode=30;break}r.offset=P,r.extra=15&I,r.mode=24;case 24:if(r.extra){for(R=r.extra;w<R;){if(0===v)break e;v--,_+=d[g++]<<w,w+=8}r.offset+=_&(1<<r.extra)-1,_>>>=r.extra,w-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(0===b)break e;if(E=S-b,r.offset>E){if((E=r.offset-E)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=30;break}M=E>r.wnext?(E-=r.wnext,r.wsize-E):r.wnext-E,E>r.length&&(E=r.length),C=r.window}else C=h,M=y-r.offset,E=r.length;for(b<E&&(E=b),b-=E,r.length-=E;h[y++]=C[M++],--E;);0===r.length&&(r.mode=21);break;case 26:if(0===b)break e;h[y++]=r.length,b--,r.mode=21;break;case 27:if(r.wrap){for(;w<32;){if(0===v)break e;v--,_|=d[g++]<<w,w+=8}if(S-=b,e.total_out+=S,r.total+=S,S&&(e.adler=r.check=r.flags?a(r.check,h,S,y-S):i(r.check,h,S,y-S)),S=b,(r.flags?_:m(_))!==r.check){e.msg="incorrect data check",r.mode=30;break}w=_=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;w<32;){if(0===v)break e;v--,_+=d[g++]<<w,w+=8}if(_!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=30;break}w=_=0}r.mode=29;case 29:z=1;break e;case 30:z=-3;break e;case 31:return-4;default:return p}return e.next_out=y,e.avail_out=b,e.next_in=g,e.avail_in=v,r.hold=_,r.bits=w,(r.wsize||S!==e.avail_out&&r.mode<30&&(r.mode<27||4!==t))&&k(e,e.output,e.next_out,S-e.avail_out)?(r.mode=31,-4):(x-=e.avail_in,S-=e.avail_out,e.total_in+=x,e.total_out+=S,r.total+=S,r.wrap&&S&&(e.adler=r.check=r.flags?a(r.check,h,S,e.next_out-S):i(r.check,h,S,e.next_out-S)),e.data_type=r.bits+(r.last?64:0)+(12===r.mode?128:0)+(20===r.mode||15===r.mode?256:0),(0==x&&0===S||4===t)&&z===u&&(z=-5),z)},r.inflateEnd=function(e){if(!e||!e.state)return p;var t=e.state;return t.window&&(t.window=null),e.state=null,u},r.inflateGetHeader=function(e,t){var r;return e&&e.state&&2&(r=e.state).wrap?((r.head=t).done=!1,u):p},r.inflateSetDictionary=function(e,t){var r,n=t.length;return e&&e.state?0!==(r=e.state).wrap&&11!==r.mode?p:11===r.mode&&i(1,t,n,0)!==r.check?-3:k(e,t,n,n)?(r.mode=31,-4):(r.havedict=1,u):p},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,r){"use strict";var n=e("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,r,l,c,u,p,f){var d,h,m,g,y,v,b,_,w,x=f.bits,S=0,O=0,k=0,E=0,M=0,C=0,T=0,I=0,P=0,j=0,N=null,L=0,A=new n.Buf16(16),z=new n.Buf16(16),D=null,R=0;for(S=0;S<=15;S++)A[S]=0;for(O=0;O<l;O++)A[t[r+O]]++;for(M=x,E=15;1<=E&&0===A[E];E--);if(E<M&&(M=E),0===E)return c[u++]=20971520,c[u++]=20971520,f.bits=1,0;for(k=1;k<E&&0===A[k];k++);for(M<k&&(M=k),S=I=1;S<=15;S++)if(I<<=1,(I-=A[S])<0)return-1;if(0<I&&(0===e||1!==E))return-1;for(z[1]=0,S=1;S<15;S++)z[S+1]=z[S]+A[S];for(O=0;O<l;O++)0!==t[r+O]&&(p[z[t[r+O]]++]=O);if(v=0===e?(N=D=p,19):1===e?(N=i,L-=257,D=a,R-=257,256):(N=o,D=s,-1),S=k,y=u,T=O=j=0,m=-1,g=(P=1<<(C=M))-1,1===e&&852<P||2===e&&592<P)return 1;for(;;){for(b=S-T,w=p[O]<v?(_=0,p[O]):p[O]>v?(_=D[R+p[O]],N[L+p[O]]):(_=96,0),d=1<<S-T,k=h=1<<C;c[y+(j>>T)+(h-=d)]=b<<24|_<<16|w,0!==h;);for(d=1<<S-1;j&d;)d>>=1;if(0!==d?(j&=d-1,j+=d):j=0,O++,0==--A[S]){if(S===E)break;S=t[r+p[O]]}if(M<S&&(j&g)!==m){for(0===T&&(T=M),y+=k,I=1<<(C=S-T);C+T<E&&!((I-=A[C+T])<=0);)C++,I<<=1;if(P+=1<<C,1===e&&852<P||2===e&&592<P)return 1;c[m=j&g]=M<<24|C<<16|y-u}}return 0!==j&&(c[y+j]=S-T<<24|64<<16),f.bits=M,0}},{"../utils/common":41}],51:[function(e,t,r){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,r){"use strict";var n=e("../utils/common"),i=0,a=1;function o(e){for(var t=e.length;0<=--t;)e[t]=0}var s=0,l=29,c=256,u=c+1+l,p=30,f=19,d=2*u+1,h=15,m=16,g=7,y=256,v=16,b=17,_=18,w=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],x=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],S=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],k=new Array(2*(u+2));o(k);var E=new Array(2*p);o(E);var M=new Array(512);o(M);var C=new Array(256);o(C);var T=new Array(l);o(T);var I,P,j,N=new Array(p);function L(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}function A(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function z(e){return e<256?M[e]:M[256+(e>>>7)]}function D(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function R(e,t,r){e.bi_valid>m-r?(e.bi_buf|=t<<e.bi_valid&65535,D(e,e.bi_buf),e.bi_buf=t>>m-e.bi_valid,e.bi_valid+=r-m):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function F(e,t,r){R(e,r[2*t],r[2*t+1])}function B(e,t){for(var r=0;r|=1&e,e>>>=1,r<<=1,0<--t;);return r>>>1}function U(e,t,r){var n,i,a=new Array(h+1),o=0;for(n=1;n<=h;n++)a[n]=o=o+r[n-1]<<1;for(i=0;i<=t;i++){var s=e[2*i+1];0!==s&&(e[2*i]=B(a[s]++,s))}}function G(e){var t;for(t=0;t<u;t++)e.dyn_ltree[2*t]=0;for(t=0;t<p;t++)e.dyn_dtree[2*t]=0;for(t=0;t<f;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*y]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function W(e){8<e.bi_valid?D(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function Z(e,t,r,n){var i=2*t,a=2*r;return e[i]<e[a]||e[i]===e[a]&&n[t]<=n[r]}function H(e,t,r){for(var n=e.heap[r],i=r<<1;i<=e.heap_len&&(i<e.heap_len&&Z(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!Z(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n}function q(e,t,r){var n,i,a,o,s=0;if(0!==e.last_lit)for(;n=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],i=e.pending_buf[e.l_buf+s],s++,0===n?F(e,i,t):(F(e,(a=C[i])+c+1,t),0!==(o=w[a])&&R(e,i-=T[a],o),F(e,a=z(--n),r),0!==(o=x[a])&&R(e,n-=N[a],o)),s<e.last_lit;);F(e,y,t)}function V(e,t){var r,n,i,a=t.dyn_tree,o=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=d,r=0;r<l;r++)0!==a[2*r]?(e.heap[++e.heap_len]=c=r,e.depth[r]=0):a[2*r+1]=0;for(;e.heap_len<2;)a[2*(i=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[i]=0,e.opt_len--,s&&(e.static_len-=o[2*i+1]);for(t.max_code=c,r=e.heap_len>>1;1<=r;r--)H(e,a,r);for(i=l;r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],H(e,a,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,a[2*i]=a[2*r]+a[2*n],e.depth[i]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,a[2*r+1]=a[2*n+1]=i,e.heap[1]=i++,H(e,a,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,n,i,a,o,s,l=t.dyn_tree,c=t.max_code,u=t.stat_desc.static_tree,p=t.stat_desc.has_stree,f=t.stat_desc.extra_bits,m=t.stat_desc.extra_base,g=t.stat_desc.max_length,y=0;for(a=0;a<=h;a++)e.bl_count[a]=0;for(l[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<d;r++)g<(a=l[2*l[2*(n=e.heap[r])+1]+1]+1)&&(a=g,y++),l[2*n+1]=a,c<n||(e.bl_count[a]++,o=0,m<=n&&(o=f[n-m]),s=l[2*n],e.opt_len+=s*(a+o),p&&(e.static_len+=s*(u[2*n+1]+o)));if(0!==y){do{for(a=g-1;0===e.bl_count[a];)a--;e.bl_count[a]--,e.bl_count[a+1]+=2,e.bl_count[g]--,y-=2}while(0<y);for(a=g;0!==a;a--)for(n=e.bl_count[a];0!==n;)c<(i=e.heap[--r])||(l[2*i+1]!==a&&(e.opt_len+=(a-l[2*i+1])*l[2*i],l[2*i+1]=a),n--)}}(e,t),U(a,c,e.bl_count)}function Y(e,t,r){var n,i,a=-1,o=t[1],s=0,l=7,c=4;for(0===o&&(l=138,c=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=o,o=t[2*(n+1)+1],++s<l&&i===o||(s<c?e.bl_tree[2*i]+=s:0!==i?(i!==a&&e.bl_tree[2*i]++,e.bl_tree[2*v]++):s<=10?e.bl_tree[2*b]++:e.bl_tree[2*_]++,a=i,c=(s=0)===o?(l=138,3):i===o?(l=6,3):(l=7,4))}function X(e,t,r){var n,i,a=-1,o=t[1],s=0,l=7,c=4;for(0===o&&(l=138,c=3),n=0;n<=r;n++)if(i=o,o=t[2*(n+1)+1],!(++s<l&&i===o)){if(s<c)for(;F(e,i,e.bl_tree),0!=--s;);else 0!==i?(i!==a&&(F(e,i,e.bl_tree),s--),F(e,v,e.bl_tree),R(e,s-3,2)):s<=10?(F(e,b,e.bl_tree),R(e,s-3,3)):(F(e,_,e.bl_tree),R(e,s-11,7));a=i,c=(s=0)===o?(l=138,3):i===o?(l=6,3):(l=7,4)}}o(N);var J=!1;function K(e,t,r,i){R(e,(s<<1)+(i?1:0),3),function(e,t,r,i){W(e),i&&(D(e,r),D(e,~r)),n.arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}(e,t,r,!0)}r._tr_init=function(e){J||(function(){var e,t,r,n,i,a=new Array(h+1);for(n=r=0;n<l-1;n++)for(T[n]=r,e=0;e<1<<w[n];e++)C[r++]=n;for(C[r-1]=n,n=i=0;n<16;n++)for(N[n]=i,e=0;e<1<<x[n];e++)M[i++]=n;for(i>>=7;n<p;n++)for(N[n]=i<<7,e=0;e<1<<x[n]-7;e++)M[256+i++]=n;for(t=0;t<=h;t++)a[t]=0;for(e=0;e<=143;)k[2*e+1]=8,e++,a[8]++;for(;e<=255;)k[2*e+1]=9,e++,a[9]++;for(;e<=279;)k[2*e+1]=7,e++,a[7]++;for(;e<=287;)k[2*e+1]=8,e++,a[8]++;for(U(k,u+1,a),e=0;e<p;e++)E[2*e+1]=5,E[2*e]=B(e,5);I=new L(k,w,c+1,u,h),P=new L(E,x,0,p,h),j=new L(new Array(0),S,0,f,g)}(),J=!0),e.l_desc=new A(e.dyn_ltree,I),e.d_desc=new A(e.dyn_dtree,P),e.bl_desc=new A(e.bl_tree,j),e.bi_buf=0,e.bi_valid=0,G(e)},r._tr_stored_block=K,r._tr_flush_block=function(e,t,r,n){var o,s,l=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return i;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return a;for(t=32;t<c;t++)if(0!==e.dyn_ltree[2*t])return a;return i}(e)),V(e,e.l_desc),V(e,e.d_desc),l=function(e){var t;for(Y(e,e.dyn_ltree,e.l_desc.max_code),Y(e,e.dyn_dtree,e.d_desc.max_code),V(e,e.bl_desc),t=f-1;3<=t&&0===e.bl_tree[2*O[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),o=e.opt_len+3+7>>>3,(s=e.static_len+3+7>>>3)<=o&&(o=s)):o=s=r+5,r+4<=o&&-1!==t?K(e,t,r,n):4===e.strategy||s===o?(R(e,2+(n?1:0),3),q(e,k,E)):(R(e,4+(n?1:0),3),function(e,t,r,n){var i;for(R(e,t-257,5),R(e,r-1,5),R(e,n-4,4),i=0;i<n;i++)R(e,e.bl_tree[2*O[i]+1],3);X(e,e.dyn_ltree,t-1),X(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,l+1),q(e,e.dyn_ltree,e.dyn_dtree)),G(e),n&&W(e)},r._tr_tally=function(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(C[r]+c+1)]++,e.dyn_dtree[2*z(t)]++),e.last_lit===e.lit_bufsize-1},r._tr_align=function(e){R(e,2,3),F(e,y,k),function(e){16===e.bi_valid?(D(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},{"../utils/common":41}],53:[function(e,t,r){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,i){(function(e){!function(e,t){"use strict";if(!e.setImmediate){var r,i,a,o,s=1,l={},c=!1,u=e.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(e);p=p&&p.setTimeout?p:e,r="[object process]"==={}.toString.call(e.process)?function(e){n.nextTick((function(){d(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?(o="setImmediate$"+Math.random()+"$",e.addEventListener?e.addEventListener("message",h,!1):e.attachEvent("onmessage",h),function(t){e.postMessage(o+t,"*")}):e.MessageChannel?((a=new MessageChannel).port1.onmessage=function(e){d(e.data)},function(e){a.port2.postMessage(e)}):u&&"onreadystatechange"in u.createElement("script")?(i=u.documentElement,function(e){var t=u.createElement("script");t.onreadystatechange=function(){d(e),t.onreadystatechange=null,i.removeChild(t),t=null},i.appendChild(t)}):function(e){setTimeout(d,0,e)},p.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var i={callback:e,args:t};return l[s]=i,r(s),s++},p.clearImmediate=f}function f(e){delete l[e]}function d(e){if(c)setTimeout(d,0,e);else{var r=l[e];if(r){c=!0;try{!function(e){var r=e.callback,n=e.args;switch(n.length){case 0:r();break;case 1:r(n[0]);break;case 2:r(n[0],n[1]);break;case 3:r(n[0],n[1],n[2]);break;default:r.apply(t,n)}}(r)}finally{f(e),c=!1}}}}function h(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(o)&&d(+t.data.slice(o.length))}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)},155:e=>{var t,r,n=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var s,l=[],c=!1,u=-1;function p(){c&&s&&(c=!1,s.length?l=s.concat(l):u=-1,l.length&&f())}function f(){if(!c){var e=o(p);c=!0;for(var t=l.length;t;){for(s=l,l=[];++u<t;)s&&s[u].run();u=-1,t=l.length}s=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function h(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new d(e,t)),1!==l.length||c||o(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=h,n.addListener=h,n.once=h,n.off=h,n.removeListener=h,n.removeAllListeners=h,n.emit=h,n.prependListener=h,n.prependOnceListener=h,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},914:e=>{"use strict";e.exports="data:image/svg+xml;base64,PCEtLSBHZW5lcmF0ZWQgYnkgSWNvTW9vbi5pbyAtLT4KPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMjQiIGhlaWdodD0iMTAyNCIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCI+Cjx0aXRsZT48L3RpdGxlPgo8ZyBpZD0iaWNvbW9vbi1pZ25vcmUiPgo8L2c+CjxwYXRoIGQ9Ik0yNTYgNjRoNTEydjEyOGgtNTEydi0xMjh6TTk2MCAyNTZoLTg5NmMtMzUuMiAwLTY0IDI4LjgtNjQgNjR2MzIwYzAgMzUuMiAyOC43OTQgNjQgNjQgNjRoMTkydjI1Nmg1MTJ2LTI1NmgxOTJjMzUuMiAwIDY0LTI4LjggNjQtNjR2LTMyMGMwLTM1LjItMjguOC02NC02NC02NHpNMTI4IDQ0OGMtMzUuMzQ2IDAtNjQtMjguNjU0LTY0LTY0czI4LjY1NC02NCA2NC02NCA2NCAyOC42NTQgNjQgNjQtMjguNjUyIDY0LTY0IDY0ek03MDQgODk2aC0zODR2LTMyMGgzODR2MzIweiI+PC9wYXRoPgo8L3N2Zz4K"}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,r),a.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=JSON.parse('{"exception":{"impl":"The implementation used cannot create PrintViewManagementControl.","impl_printermap":"The implementation used cannot create PrinterMapControl.","no_controls":"The PrintViewManagement plugin needs to activate at least one control.","encode":"The implementation used cannot use encodeLayer.","error":"An error has occurred while printing.","imageError":"The download could not be completed at this time. Please try again later.","error_layers":"The following layers will not be displayed when printing the map: ","teselaError":"The request has caused an error in printing. < br / > Please try again.","printError":"Printing has failed.","encode_method":"The used implementation does not have the encodeLayer method","tile":"The request for some tile has caused a printing error. <br/>Please try again.","support":"MBTiles and MBTilesVector layers are not supported","error_download_image":"The download could not be completed at this time."},"textHelp":{"help1":"The print extension allows you to export both maps from templates and georeferenced images.","help2":"The extension is customizable, so it can change from one viewer to another.","help3":"Using the print map control, you can download a map based on a selected template, a DPI (Dots per inch, the printing resolution), and a format. It also allows you to add a title and a description.","help4":"To obtain the map, you will have to click on the download button, which will cause the document to be generated and appear available for download.","help5":"The map is currently downloaded to EPSG:3857 (WGS84 / Pseudomercator).","help6":"Through the georeferenced image download control through the view, a georeferenced image can be obtained next to the georeference file.","help7":"The available options are: add a title to the file, select the format, obtain the georeferencing file, select the DPI (in case of using download through services) and select the type of download.","help8":"The download by view takes a snapshot of the viewer map, obtaining the layers loaded at that moment and the state of the map. The coordinate system of the download will be the coordinate system and/or projection of the map in that moment.","help9":"The download of layers loaded by services makes a call to the services themselves creating an image of their set. The coordinate system will be WGS84 / Pseudomercator (EPSG:3857).","help10":"The download control of georeferenced images by list allows you to download different WMS services with different coordinate systems and projections, indicated when building the extension.","help11":"The extension of the image of the display state at that moment is obtained, and a request is made to the service with the assigned projection","help12":"The information relevant to the extension and its possible parameterization is documented in","help13":"The example of using its parameters can be checked in"},"tooltip":"Map printing","map_printing":"Map printing","nextView":"Next view","previousView":"Previous view","service_epsg":"Service EPSG","georeferenced_img":"Georeferenced image","format":"Format","errorProjectionCapabilities":"The selected projection is not available for this base layer. Please choose another projection.","printInfor":"Print generated by Mapea","generating":"Generating georeferenced image","referenced":"Georeferenced image","projection":"Projection","downImg":"Download Image","downMap":"Download Map","delete":"Delete","down":"Download","title":"Title","notitle":"(No title)","cancel":"Cancel","accept":"Accept","download_modal":"The use of the information of the geographic data products and services defined in the <a tabindex=\\"0\\" target=\\"_blank\\" href=\\"https://www.boe.es/boe/dias/2015/12/26/pdfs/BOE-A-2015-14129.pdf\\">Order FOM/2807/2015</a>, as well as its derivatives, entails the acceptance by the user of the general conditions of said order, specified in the following <a tabindex=\\"0\\" target=\\"_blank\\" href=\\"http://www.ign.es/resources/licencia/Condiciones_licenciaUso_IGN.pdf\\">license of use</a>, compatible with CC-BY 4.0.","use_license":"License of use","map":"Map","pnoa":"Image (PNOA)","screen":"Screen Image","fixeddescription":"This document has no legal validity","description":"Description","layout":"Layout","credits":"Print generated through api-core","base":"Base Cartography","zone":"zone","georefimageWld":"Georeferencing file (WLD)","typeDownload":"Select the type of download:","typeClient":"Screen view download","typeServer":"Downloading layers loaded by services","selectLayer":"Select the layer to download","clipBoard":"Copy to clipboard","layer_wms":"WMS returns a map in image format from a set of raster or vector layers. Allowing customization of layers through styles.","layer_wmts":" WMTS (Web Map Tile Service) es un estándar OGC para servir información geográfica en forma de tiles pregenerados a unas resoluciones específicas.","layer_tms":"TMS (Tile Map Service) layers are geographic information services in the form of tiles very similar to XYZ layers.","layer_xyz":"Las capas XYZ son servicios de información geográfica en forma de tiles. Cada tile representa una combinación de tres parámetros.","layer_raster":"Layers raster:","layer_vector":"Layers vector:","layer_geojson":"Despite not being an OGC standard (it is on its way to becoming one), it is a very widespread geographic information exchange format that, like WFS, allows all the elements to be on the client.","layers_wfs":"(Web Feature Service) is an OGC standard for the download and transfer of geographic information, where the geographic elements or features are transmitted in their entirety to the client.","layers_kml":"(Keyhole Markup Language). KML is an XML-based markup language for representing geographic data in three dimensions.","layer_OGCAPIFeatures":"(OGC API - FEATURES) is an OGC standard that provides the ability to create, modify, and query spatial data on the Web and specifies requirements and recommendations for APIs that want to follow a standard way of sharing feature data.","tooltip_georefimageepsg":"EPSG code of the georeferenced image","title_map":"Map printing","title_view":"View georeferenced image download","title_list":"Download georeferenced image from list","available_sources":"Available sources","maintain_view":"Maintain print view with DPI = 120"}'),t=JSON.parse('{"exception":{"impl":"La implementación usada no puede crear controles PrintViewManagementControl.","impl_printermap":"La implementación usada no puede crear controles PrinterMapControl.","no_controls":"El plugin PrintViewManagement necesita activar al menos un control.","encode":"La implementación usada no posee el método encodeLayer.","error":"Se ha producido un error en la impresión.","imageError":"No ha podido realizarse la descarga en este momento. Por favor, inténtelo más tarde.","error_layers":"Las siguientes capas no se visualizarán al imprimir el mapa: ","teselaError":"La petición de alguna tesela ha provocado un error en la impresión. <br/>Por favor, inténtelo de nuevo.","printError":"Se ha producido un error en la impresión.","encode_method":"La implementación usada no posee el método encodeLayer","tile":"La petición de alguna tesela ha provocado un error en la impresión. <br/>Por favor, inténtelo de nuevo.","support":"Las capas MBTiles y MBTilesVector no están soportadas.","error_download_image":"No ha podido realizarse la descarga."},"textHelp":{"help1":"La extensión de imprimir permite exportar tanto mapas a partir de plantillas como imágenes georreferenciadas.","help2":"La extensión es personalizable, por lon que puede cambiar de un visualizador a otro.","help3":"Mediante el control imprimir mapa, se puede descargar un mapa a partir de una plantilla seleccionada, unos DPI (Dots per inch, la resolución de impresión), y un formato.  Además permite añadir un título y una descripción.","help4":"Para obtener el mapa, habrá que hacer click sobre el botón de descargar, lo que hará que se genere el documento y aparezca disponible para su descargar.","help5":"Actualmente, el mapa se descarga en el EPSG:3857  (WGS84 / Pseudomercator).","help6":"A través del control de descarga de imagen georreferenciada a través de la vista, se puede obtener una imagen georreferenciada junto al archivo de georreferenciación.","help7":"Las opciones disponibles son: añadir un título al archivo, seleccionar el formato, obtener el fichero de georreferenciación, seleccionar los DPI (en caso de utilizar la descarga a través de servicios) y seleccionar el tipo de descarga.","help8":"La descarga por vista, hace una captura del mapa del visualizador, obteniendo las capas cargadas en ese momento y el estado del mapa. El sistema de coordenadas de la descarga será el sistema de coordenadas y/o proyección del mapa en ese momento.","help9":"La descarga de capas cargadas por servicios, hace una llamada a los propios servicios creando una imagen de su conjunto. El sistema de coordenadas será WGS84 / Pseudomercator (EPSG:3857).","help10":"El control de descarga de imágenes georreferenciadas por lista, permite descargar distintos servicios WMS con distintos sistemas de coordenadas y proyecciones, indicados a la hora de construir la extensión.","help11":"Se obtiene la extensión de la imagen del estado del visualizador en ese momento, y se realiza una petición al servicio con la proyección asignada","help12":"La información relevante a la extensión y su posible parametrización está documentada en","help13":"El ejemplo de uso de sus parámetros puede comprobarse en"},"tooltip":"Impresión del mapa","map_printing":"Impresión del mapa","nextView":"Vista siguiente","previousView":"Vista anterior","service_epsg":"Servicios EPSG","georeferenced_img":"Imagen georreferenciada","format":"Formato","errorProjectionCapabilities":"La proyeccion seleccionada no está disponible para esta capa base. Por favor elija otra proyección.","printInfo":"Impresión generada a través de Mapea","generating":"Generando imagen georreferenciada","referenced":"Imagen georreferenciada","projection":"Proyección","downImg":"Descargar Imagen","downMap":"Descargar Mapa","delete":"Borrar","down":"Descargar","title":"Título","notitle":"(Sin título)","cancel":"Cancelar","accept":"Aceptar","download_modal":"El uso de la información de los productos y servicios de datos geográficos definidos en la <a tabindex=\\"0\\" target=\\"_blank\\" href=\\"https://www.boe.es/boe/dias/2015/12/26/pdfs/BOE-A-2015-14129.pdf\\">Orden FOM/2807/2015</a>, así como sus derivados, conlleva la aceptación por el usuario de las condiciones generales de dicha orden, concretada en la siguiente <a tabindex=\\"0\\" target=\\"_blank\\" href=\\"http://www.ign.es/resources/licencia/Condiciones_licenciaUso_IGN.pdf\\">licencia de uso</a>, compatible con CC-BY 4.0.","use_license":"Licencia de uso","map":"Mapa","pnoa":"Imagen (PNOA)","screen":"Imagen Pantalla","fixeddescription":"Este documento no tiene validez legal","description":"Descripción","layout":"Plantilla","credits":"Print generated through api-core","base":"Cartografía base","zone":"huso","georefimageWld":"Fichero de georreferenciación (WLD)","typeDownload":"Selecciona el tipo de descarga:","typeClient":"Descarga de la vista en pantalla","typeServer":"Descarga de capas cargadas por servicios","selectLayer":"Selecciona la capa a descargar","clipBoard":"Copiar al portapapeles","layer_wms":"WMS devuelve un mapa en formato imagen de un conjunto capas ráster o vectoriales. Permitiendo las personalización de las capas mediante estilos. ","layer_wmts":" WMTS (Web Map Tile Service) es un estándar OGC para servir información geográfica en forma de tiles pregenerados a unas resoluciones específicas.","layer_tms":"Las capas TMS (Tile Map Service) son servicios de información geográfica en forma de tiles muy similares a las capas XYZ.","layer_xyz":"Las capas XYZ son servicios de información geográfica en forma de tiles. Cada tile representa una combinación de tres parámetros.","layer_raster":"Capas ráster:","layer_vector":"Capas vectoriales:","layer_geojson":"Pese a no ser un estándar OGC (está camino de convertirse en ello), es un formato de intercambio de información geográfica muy extendido que, al igual que WFS, permite tener todos los elementos en el cliente.","layer_wfs":"(Web Feature Service) es un estándar OGC para la descarga y transferencia de información geográfica, donde los elementos geográficos o features se transmiten en su totalidad al cliente.","layer_kml":"(Keyhole Markup Language). KML es un lenguaje de marcado basado en XML para representar datos geográficos en tres dimensiones.","layer_OGCAPIFeatures":"(OGC API - FEATURES) es un estándar OGC que ofrece la capacidad de crear, modificar y consultar datos espaciales en la Web y especifica requisitos y recomendaciones para las API que desean seguir una forma estándar de compartir datos de entidades.","tooltip_georefimageepsg":"Georreferenciar imagen predefinida","title_map":"Impresión del mapa","title_view":"Descarga de imagen georreferenciada de la vista","title_list":"Descarga de imagen georreferenciada a partir de listado","available_sources":"Fuentes disponibles","maintain_view":"Se mantiene la vista de impresión con DPI = 120"}');var n={en:e,es:t},i=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t="es","function"==typeof M.language.getLang&&(t=M.language.getLang()),t),i=function(e){return"es"===e||"en"===e?n[e]:M.language.getTranslation(e).printviewmanagement}(r),a="";return M.utils.isNullOrEmpty(i)?console.warn("The translation '".concat(r,"' has not been defined.")):a=e.split(".").reduce((function(e,t){return e[t]}),i),a},a=function(e,t,r,n,i){for(var a=void 0!==i?i:[],o=0,s=t;s<r;s+=n)a[o++]=e.slice(s,s+n);return a.length=o,a},o=function(e,t){var r=e.getImpl().getOL3Layer(),n=r.getSource().getFeatures(),i=e.name,a=r.getOpacity(),o=new ol.format.GeoJSON,s=t.getBbox();s=[s.x.min,s.y.min,s.x.max,s.y.max];var l,c,u=t.getMapImpl().getView().getResolution(),p=[],f=1,d=1,h=1,m="",g={},y={};return n.forEach((function(e){var t=e.getGeometry(),r=e.get("styleUrl");M.utils.isNullOrEmpty(r)||(r=r.replace("#",""));var n=e.getStyle();if(!M.utils.isNullOrEmpty(n)){var i;try{var a=n(e,u);i=Array.isArray(a)?a[0]:a}catch(t){i=n.call(e,u)[0]}if(!M.utils.isNullOrEmpty(i)){var v,b=i.getImage(),_=b.getImageSize();M.utils.isNullOrEmpty(_)&&(_=[64,64]),v="multipolygon"===e.getGeometry().getType().toLowerCase()?"polygon":"multipoint"===e.getGeometry().getType().toLowerCase()?"point":e.getGeometry().getType().toLowerCase();var w,x=i.getStroke(),S={id:r,externalGraphic:b.getSrc(),graphicHeight:_[0],graphicWidth:_[1],graphicOpacity:b.getOpacity(),strokeWidth:x?x.getWidth():void 0,type:v},O=i.getText&&i.getText();if(M.utils.isNullOrEmpty(O)||((w={conflictResolution:"false",fontColor:M.utils.isNullOrEmpty(O.getFill())?"":M.utils.rgbToHex(M.utils.isArray(O.getFill().getColor())?"rgba(".concat(O.getFill().getColor().toString(),")"):O.getFill().getColor()),fontSize:"11px",fontFamily:"Helvetica, sans-serif",fontWeight:"bold",label:M.utils.isNullOrEmpty(O.getText())?e.get("name"):O.getText(),labelAlign:O.getTextAlign(),labelXOffset:O.getOffsetX(),labelYOffset:O.getOffsetY(),labelOutlineColor:M.utils.isNullOrEmpty(O.getStroke())?"":M.utils.rgbToHex(M.utils.isArray(O.getStroke().getColor())?"rgba(".concat(O.getStroke().getColor().toString(),")"):O.getStroke().getColor()),labelOutlineWidth:M.utils.isNullOrEmpty(O.getStroke())?"":O.getStroke().getWidth(),type:"text"}).fontColor=w.fontColor.slice(0,7),w.labelOutlineColor=w.labelOutlineColor.slice(0,7)),l="draw".concat(h),!M.utils.isNullOrEmpty(t)&&t.intersectsExtent(s)&&!M.utils.isNullOrEmpty(O)){var k=JSON.stringify(S),E=JSON.stringify(w),C=g[k],T=y[E];if(M.utils.isUndefined(C)||M.utils.isUndefined(T)){var I=[],P=0;if(!M.utils.isNullOrEmpty(t)&&t.intersectsExtent(s)&&M.utils.isUndefined(C)&&(C=d,g[k]=C,P=1,I.push(k),d+=1,h+=1),!M.utils.isNullOrEmpty(O)&&M.utils.isUndefined(T)&&(T=f,y[E]=T,I.push(E),f+=1,0===P&&(h+=1,I.push(k))),void 0===C&&(C=0),void 0===T&&(T=0),c="\"[_gx_style ='".concat(C+T,"']\""),!M.utils.isNullOrEmpty(I)){var j="".concat(c,': {"symbolizers": [').concat(I,"]}");m+=""!==m?",".concat(j):"{".concat(j,', "version": "2"')}}var N=o.writeFeatureObject(e);N.properties={name:l,_gx_style:C+T},p.push(N)}}}})),{type:"Vector",style:m=""!==m?JSON.parse(m.concat("}")):{"*":{symbolizers:[]},version:"2"},geoJson:{type:"FeatureCollection",features:p},name:i,opacity:a}},s=function(e){var t=null,r=e.getImpl().getOL3Layer(),n=e.url,i=r.getOpacity(),a=r.getSource().getParams(),o=[a.LAYERS],s=[a.STYLES];if(t={baseURL:n,opacity:i,type:"WMS",layers:o.join(",").split(","),styles:s.join(",").split(",")},e._updateNoCache){e._updateNoCache();var l=e.getNoCacheName(),c=e.getNoCacheUrl();M.utils.isNullOrEmpty(l)||M.utils.isNullOrEmpty(c)||(t.layers=[l],t.baseURL=c)}else{var u=e.getNoChacheName(),p=e.getNoChacheUrl();M.utils.isNullOrEmpty(u)||M.utils.isNullOrEmpty(p)||(t.layers=[u],t.baseURL=p)}return t.customParams={},Object.keys(a).forEach((function(e){-1!=="iswmc,transparent".indexOf(e.toLowerCase())&&(t.customParams[e]=a[e])})),t},l=function(e){var t=null,r=e,n=r.getSource().getParams(),i=[n.LAYERS],a=[n.STYLES];return(t={baseURL:r.getSource().getUrl(),opacity:r.getOpacity(),type:"WMS",layers:i.join(",").split(","),styles:a.join(",").split(",")}).customParams={IMAGEN:n.IMAGEN,transparent:!0,iswmc:!1},t},c=function(e){var t=e.getImpl().getOL3Layer();return{type:"geotiff",name:e.name,url:t.getSource().getKey(),opacity:t.getOpacity()}},u=function(e){var t=e.getImpl().getOL3Layer(),r=t.getSource().getTileGrid(),n=e.url,i=t.getOpacity(),a=r.getExtent(),o=r.getTileSize(),s=r.getResolutions();return e.type===M.layer.type.OSM&&(n=e.url||"http://tile.openstreetmap.org/"),{opacity:i,baseURL:n,maxExtent:a,tileSize:[o,o],resolutions:s,type:"osm"}},p=function(e){var t=e.getImpl().getOL3Layer(),r=t.getSource(),n=e.url,a=e.name,o=t.getOpacity(),s=r.getRequestEncoding(),l=e.matrixSet;return e.getImpl().getCapabilities().then((function(t){var r=t.Contents.TileMatrixSet.filter((function(e){return e.Identifier===l}))[0];try{return{baseURL:n,imageFormat:e.options.imageFormat||e.options.format||"image/png",layer:a,matrices:r.TileMatrix.map((function(e,t){return{identifier:e.Identifier,matrixSize:[e.MatrixHeight,e.MatrixWidth],scaleDenominator:e.ScaleDenominator,tileSize:[e.TileWidth,e.TileHeight],topLeftCorner:e.TopLeftCorner}})),matrixSet:l,opacity:o,requestEncoding:s,style:e.getImpl().getOL3Layer().getSource().getStyle()||"default",type:"WMTS",version:"1.3.0"}}catch(e){return M.toast.error(i("errorProjectionCapabilities"),6e3),null}}))},f=function(e,t){var r=e.getFeatures(),n=e.name,i=e.getOpacity(),o=e.getImpl().getOL3Layer().getStyle(),s=t.getBbox();s=[s.x.min,s.y.min,s.x.max,s.y.max];var l,c,u=t.getMapImpl().getView().getResolution(),p=[],f=1,d=1,h=1,m="",g={},y={};return r.forEach((function(t){var r,n=t.getImpl().getOLFeature().getGeometry(),i=t.getImpl().getOLFeature().getStyleFunction();if(M.utils.isNullOrEmpty(i)?M.utils.isNullOrEmpty(o)||(r=o):r=i,r instanceof Function&&(r=r.call(r,t.getImpl().getOLFeature(),u)),r instanceof Array&&(r=r.length>1&&!M.utils.isNullOrEmpty(r[1].getImage())&&r[1].getImage().getSrc?r[1]:r[0]),!M.utils.isNullOrEmpty(r)){var v,b=r.getImage(),_=M.utils.isNullOrEmpty(b)?[0,0]:b.getImageSize()||[24,24],w=r.getText();M.utils.isNullOrEmpty(w)&&!M.utils.isNullOrEmpty(r.textPath)&&(w=r.textPath),v="multipolygon"===n.getType().toLowerCase()?"polygon":"multipoint"===n.getType().toLowerCase()?"point":n.getType().toLowerCase().indexOf("linestring")>-1?"line":n.getType().toLowerCase();var x,S=M.utils.isNullOrEmpty(b)?r.getStroke():b.getStroke&&b.getStroke(),O=M.utils.isNullOrEmpty(b)?r.getFill():b.getFill&&b.getFill(),k=null!==r.getStroke()&&void 0!==r.getStroke()?r.getStroke().getLineDash():void 0,E={type:v,fillColor:M.utils.isNullOrEmpty(O)||e.name.indexOf(" Reverse")>-1&&e.name.indexOf("Cobertura")>-1?"#000000":M.utils.rgbaToHex(O.getColor()).slice(0,7),fillOpacity:M.utils.isNullOrEmpty(O)?0:M.utils.getOpacityFromRgba(O.getColor()),strokeColor:M.utils.isNullOrEmpty(S)?"#000000":M.utils.rgbaToHex(S.getColor()),strokeOpacity:M.utils.isNullOrEmpty(S)?0:M.utils.getOpacityFromRgba(S.getColor()),strokeWidth:M.utils.isNullOrEmpty(S)?0:S.getWidth&&S.getWidth(),pointRadius:M.utils.isNullOrEmpty(b)?"":b.getRadius&&b.getRadius(),externalGraphic:M.utils.isNullOrEmpty(b)?"":b.getSrc&&b.getSrc(),graphicHeight:_[0],graphicWidth:_[1],strokeLinecap:"round"};if("coordinateresult"===e.name&&(E.fillOpacity=1,E.strokeOpacity=1,E.fillColor="#ffffff",E.strokeColor="#ff0000",E.strokeWidth=2),"infocoordinatesLayerFeatures"===e.name&&(E.fillColor="#ffffff",E.fillOpacity=1,E.strokeWidth=1,E.strokeColor="#2690e7",E.strokeOpacity=1,E.graphicName="cross",E.graphicWidth=15,E.graphicHeight=15),e.name.indexOf(" Reverse")>-1&&e.name.indexOf("Cobertura")>-1&&(E.fillColor=E.strokeColor,E.fillOpacity=.5),null!=k&&k.length>0&&(1===k[0]&&2===k.length?E.strokeDashstyle="dot":10===k[0]?E.strokeDashstyle="dash":1===k[0]&&k.length>2&&(E.strokeDashstyle="dashdot")),M.utils.isNullOrEmpty(w))"infocoordinatesLayerFeatures"===e.name&&(w=!0,x={type:"text",conflictResolution:"false",fontFamily:"Helvetica, sans-serif",fontStyle:"normal",fontColor:"#ffffff",fontSize:"12px",label:"".concat(t.getId()),labelAlign:"lb",labelXOffset:"4",labelYOffset:"3",haloColor:"#2690e7",haloRadius:"1",haloOpacity:"1"});else{var C=w.getTextAlign(),T=w.getTextBaseline(),I="";M.utils.isNullOrEmpty(C)||(C=C===M.style.align.LEFT?"l":C===M.style.align.RIGHT?"r":C===M.style.align.CENTER?"c":""),M.utils.isNullOrEmpty(T)||(T=T===M.style.baseline.BOTTOM?"b":T===M.style.baseline.MIDDLE?"m":T===M.style.baseline.TOP?"t":""),M.utils.isNullOrEmpty(C)||M.utils.isNullOrEmpty(T)||(I=C.concat(T));var P=w.getFont(),j=!M.utils.isNullOrEmpty(P)&&P.indexOf("bold")>-1?"bold":"normal",N="11px";if(!M.utils.isNullOrEmpty(P)){var L=P.substr(0,P.indexOf("px"));if(!M.utils.isNullOrEmpty(L)){var A=L.lastIndexOf(" ");N=A>-1?L.substr(A,L.length).trim().concat("px"):L.concat("px")}}x={type:"text",label:w.getText(),fontColor:M.utils.isNullOrEmpty(w.getFill())?"#000000":M.utils.rgbToHex(w.getFill().getColor()),fontSize:N,fontFamily:"Helvetica, sans-serif",fontStyle:"normal",fontWeight:j,conflictResolution:"false",labelXOffset:w.getOffsetX(),labelYOffset:w.getOffsetY(),fillColor:E.fillColor||"#FF0000",fillOpacity:E.fillOpacity||1,labelOutlineColor:M.utils.isNullOrEmpty(w.getStroke())?"":M.utils.rgbToHex(w.getStroke().getColor()||"#FF0000"),labelOutlineWidth:M.utils.isNullOrEmpty(w.getStroke())?"":w.getStroke().getWidth(),labelAlign:I}}l="draw".concat(f);var z=n.getExtent();if(!M.utils.isNullOrEmpty(n)&&ol.extent.intersects(s,z)||!M.utils.isNullOrEmpty(w)){var D=JSON.stringify(E),R=JSON.stringify(x),F=g[D],B=y[R];if(M.utils.isUndefined(F)||M.utils.isUndefined(B)){var U=[],G=0;if(!M.utils.isNullOrEmpty(n)&&ol.extent.intersects(s,z)&&M.utils.isUndefined(F)&&(F=h,g[D]=F,G=1,U.push(D),h+=1,f+=1),!M.utils.isNullOrEmpty(w)&&M.utils.isUndefined(B)&&(B=d,y[R]=B,U.push(R),d+=1,0===G&&(f+=1,U.push(D))),void 0===F&&(F=0),void 0===B&&(B=0),c="\"[_gx_style ='".concat(F+B,"']\""),!M.utils.isNullOrEmpty(U)){var W="".concat(c,': {"symbolizers": [').concat(U,"]}");m+=""!==m?",".concat(W):"{".concat(W,',"version":"2"')}}var Z=n.getFlatCoordinates();if(Z=function(e,t,r,n,i,o){for(var s=void 0!==o?o:[],l=0,c=0,u=n.length;c<u;++c){var p=n[c],f=a(t,r,p,i,s[l]);("point"===e||("line"===e||"linestring"===e)&&f.length>=2||"polygon"===e&&f.length>3)&&(s[l++]=f),r=p}return s.length=l,"line"!==e&&"linestring"!==e||1!==s.length||(s=s[0]),s}(v,Z.slice(),0,n.getEnds(),2),Z.length>0){var H={id:t.getId(),type:"Feature",geometry:{type:n.getType(),coordinates:Z}};H.properties={_gx_style:F+B,name:l},p.push(H)}}}})),{type:"Vector",style:m=""!==m?JSON.parse(m.concat("}")):{"*":{symbolizers:[]},version:"2"},geoJson:{type:"FeatureCollection",features:p},name:n,opacity:i}};function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,m(n.key),n)}}function m(e){var t=function(e,t){if("object"!=d(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==d(t)?t:t+""}function g(e,t,r){return t=v(t),function(e,t){if(t&&("object"==d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,y()?Reflect.construct(t,r||[],v(e).constructor):t.apply(e,r))}function y(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(y=function(){return!!e})()}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}function b(e,t){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},b(e,t)}var _=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=g(this,t)).facadeMap_=e,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(t,M.impl.Control),r=t,(n=[{key:"addTo",value:function(e,t){this.facadeMap_=e,this.element=t,e.getMapImpl().addControl(this)}},{key:"getParametrizedLayers",value:function(e,t,r){var n=e.getMapImpl().getLayers().getArray().filter((function(e){return!M.utils.isNullOrEmpty(e.getSource())&&!M.utils.isNullOrEmpty(e.getSource().params_)&&void 0!==e.getSource().getParams()[t]}));return n=n.filter((function(e){return!r.some((function(t){return void 0!==t.url&&t.url===e.getSource().getUrl()}))}))}},{key:"encodeLayer",value:function(e){var t=this;return new Promise((function(r,n){e.type===M.layer.type.MVT?r(f(e,t.facadeMap_)):e.type===M.layer.type.KML&&!1!==e.getImpl().formater_.extractStyles_?r(o(e,t.facadeMap_)):e.type===M.layer.type.KML&&!1===e.getImpl().formater_.extractStyles_?r(t.encodeWFS(e)):e.type===M.layer.type.WMS?r(s(e)):e.type===M.layer.type.WFS||e.type===M.layer.type.GeoJSON?r(t.encodeWFS(e)):e.type===M.layer.type.WMTS?p(e).then((function(e){r(e)})):M.utils.isNullOrEmpty(e.type)&&e instanceof M.layer.Vector?r(t.encodeWFS(e)):void 0===e.type&&"ol-layer"===e.className_?r(l(e)):[M.layer.type.XYZ,M.layer.type.TMS,M.layer.type.OSM].indexOf(e.type)>-1?r(u(e)):e.type===M.layer.type.GeoTIFF?r(c(e)):r(t.encodeWFS(e))}))}},{key:"encodeWFS",value:function(e){var t=this,r=this.facadeMap_.getProjection(),n=e.getImpl().getOL3Layer(),i=n.getSource().getFeatures(),a=e.name,o=n.getOpacity(),s=n.getStyle(),l=new ol.format.GeoJSON,c=this.facadeMap_.getBbox();c=[c.x.min,c.y.min,c.x.max,c.y.max];var u,p,f=this.facadeMap_.getMapImpl().getView().getResolution(),d=[],h=1,m=1,g=1,y="",v={},b={};return i.forEach((function(e){var n,i=e.getGeometry(),a=e.getStyle();if(M.utils.isNullOrEmpty(a)?M.utils.isNullOrEmpty(s)||(n=s):n=a,n instanceof Function&&(n=n.call(n,e,f)),n instanceof Array&&(n=n.length>1&&!M.utils.isNullOrEmpty(n[1].getImage())&&n[1].getImage().getSrc?n[1]:n[0]),!M.utils.isNullOrEmpty(n)){var o,_=n.getImage(),w=M.utils.isNullOrEmpty(_)?[0,0]:_.getImageSize()||[24,24],x=n.getText();M.utils.isNullOrEmpty(x)&&!M.utils.isNullOrEmpty(n.textPath)&&(x=n.textPath),o="multipolygon"===e.getGeometry().getType().toLowerCase()?"polygon":"multipoint"===e.getGeometry().getType().toLowerCase()?"point":e.getGeometry().getType().toLowerCase().indexOf("linestring")>-1?"line":e.getGeometry().getType().toLowerCase();var S,O=M.utils.isNullOrEmpty(_)?n.getStroke():_.getStroke&&_.getStroke(),k=M.utils.isNullOrEmpty(_)?n.getFill():_.getFill&&_.getFill(),E={type:o,fillColor:M.utils.isNullOrEmpty(k)?"#000000":M.utils.rgbaToHex(k.getColor()).slice(0,7),fillOpacity:M.utils.isNullOrEmpty(k)?0:M.utils.getOpacityFromRgba(k.getColor()),strokeColor:M.utils.isNullOrEmpty(O)?"#000000":M.utils.rgbaToHex(O.getColor()),strokeOpacity:M.utils.isNullOrEmpty(O)?0:M.utils.getOpacityFromRgba(O.getColor()),strokeWidth:M.utils.isNullOrEmpty(O)?0:O.getWidth&&O.getWidth(),pointRadius:M.utils.isNullOrEmpty(_)?"":_.getRadius&&_.getRadius(),externalGraphic:M.utils.isNullOrEmpty(_)?"":_.getSrc&&_.getSrc(),graphicHeight:w[0],graphicWidth:w[1]};if(!M.utils.isNullOrEmpty(x)){var C=x.getTextAlign(),T=x.getTextBaseline(),I="";M.utils.isNullOrEmpty(C)||(C=C===M.style.align.LEFT?"l":C===M.style.align.RIGHT?"r":C===M.style.align.CENTER?"c":""),M.utils.isNullOrEmpty(T)||(T=T===M.style.baseline.BOTTOM?"b":T===M.style.baseline.MIDDLE?"m":T===M.style.baseline.TOP?"t":""),M.utils.isNullOrEmpty(C)||M.utils.isNullOrEmpty(T)||(I=C.concat(T));var P=x.getFont(),j=!M.utils.isNullOrEmpty(P)&&P.indexOf("bold")>-1?"bold":"normal",N="11px";if(!M.utils.isNullOrEmpty(P)){var L=P.substr(0,P.indexOf("px"));if(!M.utils.isNullOrEmpty(L)){var A=L.lastIndexOf(" ");N=A>-1?L.substr(A,L.length).trim().concat("px"):L.concat("px")}}S={type:"text",label:x.getText(),fontColor:M.utils.isNullOrEmpty(x.getFill())?"#000000":M.utils.rgbToHex(x.getFill().getColor()),fontSize:N,fontFamily:"Helvetica, sans-serif",fontStyle:"normal",fontWeight:j,conflictResolution:"false",labelXOffset:x.getOffsetX(),labelYOffset:x.getOffsetY(),fillColor:E.fillColor||"#FF0000",fillOpacity:E.fillOpacity||1,labelOutlineColor:M.utils.isNullOrEmpty(x.getStroke())?"":M.utils.rgbToHex(x.getStroke().getColor()||"#FF0000"),labelOutlineWidth:M.utils.isNullOrEmpty(x.getStroke())?"":x.getStroke().getWidth(),labelAlign:I}}if(u="draw".concat(h),!M.utils.isNullOrEmpty(i)&&i.intersectsExtent(c)||!M.utils.isNullOrEmpty(x)){var z,D=JSON.stringify(E),R=JSON.stringify(S),F=v[D],B=b[R];if(M.utils.isUndefined(F)||M.utils.isUndefined(B)){var U=[],G=0;if(!M.utils.isNullOrEmpty(i)&&i.intersectsExtent(c)&&M.utils.isUndefined(F)&&(F=g,v[D]=F,G=1,U.push(D),g+=1,h+=1),!M.utils.isNullOrEmpty(x)&&M.utils.isUndefined(B)&&(B=m,b[R]=B,U.push(R),m+=1,0===G&&(h+=1,U.push(D))),void 0===F&&(F=0),void 0===B&&(B=0),p="\"[_gx_style ='".concat(F+B,"']\""),!M.utils.isNullOrEmpty(U)){var W="".concat(p,': {"symbolizers": [').concat(U,"]}");y+=""!==y?",".concat(W):"{".concat(W,',"version":"2"')}}(z="EPSG:3857"!==r.code&&t.facadeMap_.getLayers().some((function(e){return e.type===M.layer.type.OSM||e.type===M.layer.type.Mapbox}))?l.writeFeatureObject(e,{featureProjection:r.code,dataProjection:"EPSG:3857"}):l.writeFeatureObject(e)).properties={_gx_style:F+B,name:u},d.push(z)}}}),this),{type:"Vector",style:y=""!==y?JSON.parse(y.concat("}")):{"*":{symbolizers:[]},version:"2"},geoJson:{type:"FeatureCollection",features:d},name:a,opacity:o}}},{key:"encodeOSM",value:function(e){var t=e.getImpl(),r=t.getOL3Layer(),n=r.getSource().getTileGrid(),i=e.url||"http://tile.openstreetmap.org/",a=e.name,o=r.getOpacity(),s=t.tiled,l=n.getExtent(),c=n.getTileSize();return{baseURL:i,opacity:o,singleTile:!s,layer:a,maxExtent:l,tileSize:[c,c],resolutions:n.getResolutions(),type:"OSM",extension:"png"}}},{key:"encodeMapbox",value:function(e){var t=e.getImpl().getOL3Layer(),r=t.getSource().getTileGrid(),n=M.utils.concatUrlPaths([M.config.MAPBOX_URL,e.name]),i=t.getOpacity(),a=r.getExtent(),o=r.getTileSize(),s=r.getResolutions(),l={};return l[M.config.MAPBOX_TOKEN_NAME]=M.config.MAPBOX_TOKEN_VALUE,{opacity:i,baseURL:n,customParams:l,maxExtent:a,tileSize:[o,o],resolutions:s,extension:M.config.MAPBOX_EXTENSION,type:"xyz",path_format:"/${z}/${x}/${y}.png"}}},{key:"destroy",value:function(){this.facadeMap_.getMapImpl().removeControl(this),this.facadeMap_=null}}])&&h(r.prototype,n),i&&h(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(),w=function(e,t){var r=ol.proj.get(e),n=ol.proj.get("EPSG:4326");return ol.proj.transform(t,r,n)},x=function(e,t,r){return ol.proj.transformExtent(e,t,r)},S=r(166),O=r.n(S),k=r(733),E=r.n(k),C=r(162);function T(e){return function(e){if(Array.isArray(e))return I(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return I(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?I(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var P="printing",j="#m-georefimage-queue-container",N=/^data:image\/(png|jpeg);base64,/;function L(e){return e.querySelector(j)}function A(e,t,r){var n,a,o=L(e);n=e.querySelector(".".concat("m-printviewmanagement-queue")),"none"===(a=n).style.display&&(a.style.display="block");var s,l,c=(s=t?t.value:r,(l=document.createElement("li")).innerHTML=s||i("notitle"),l.tabIndex=0,l);return T(o.childNodes).length>0?o.insertBefore(c,o.firstChild):o.appendChild(c),c.classList.add(P),c}function z(e){e.classList.remove(P),e.classList.add("finished")}function D(e,t,r){var n,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0;if(arguments.length>3&&void 0!==arguments[3]&&arguments[3]){var o=(e[2]-e[0])/r[0],s=(e[3]-e[1])/r[1]*-1,l=e[0]+o/2,c=e[3]+s/2;n=o.toString().concat("\n",(0).toString(),"\n",(0).toString(),"\n",s.toString(),"\n",l.toString(),"\n",c.toString())}else if("client"===a){var u=function(e){return e.getMapImpl().pixelToCoordinateTransform_}(i);n=u.join("\n")}else if("server"===a){var p=((e[2]-e[0])/r[0]*(72/t)).toString(),f=(0).toString(),d=(0).toString(),h=(-(e[3]-e[1])/r[1]*(72/t)).toString(),m=(e[0]+p/2).toString(),g=(e[3]+h/2).toString();n=p.concat("\n",f,"\n",d,"\n",h,"\n",m,"\n",g)}return n}function R(e,t,r){var n=new(E());e.forEach((function(e){var t=e.name,r=e.data,i=e.base64;n.file(t,r,{base64:i})})),n.generateAsync({type:"blob"}).then((function(e){(0,C.saveAs)(e,r.concat(t))}))}function F(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(""===e||e===i("notitle")){var t=new Date;return"mapa_".concat(t.getFullYear(),"-",t.getMonth()+1,"-",t.getDay()+1,"_",t.getHours(),t.getMinutes(),t.getSeconds())}return e}function B(e,t){var r=t||"jpeg";return new Promise((function(t,n){var a=new Image;a.setAttribute("crossorigin","anonymous"),a.src=e,a.onload=function(){var e=document.createElement("canvas");e.width=a.width,e.height=a.height,e.getContext("2d").drawImage(a,0,0);var n=e.toDataURL("image/".concat(r),1);t(n.replace(N,""))},a.onerror=function(){Promise.reject(new Error(i("exception.loaderror"))),M.dialog.error(i("exception.imageError"))}}))}var U="\n    <section style='max-height: 56vh; overflow-y: auto;'>\n      <h1 style=\"text-align: center;\">".concat(i("available_sources"),"</h1>\n      <p><b>").concat(i("layer_raster"),"</b></p>\n      <ul>\n        <li><b>WMS: </b>").concat(i("layer_wms"),"</li>\n        <li><b>WMTS: </b>").concat(i("layer_wmts"),"</li>\n        <li><b>TMS: </b>").concat(i("layer_tms"),"</li>\n        <li><b>XYZ: </b>").concat(i("layer_xyz"),"</li>\n      </ul>\n      <p><b>").concat(i("layer_vector"),"</b></p>\n      <ul>\n        <li><b>GeoJSON: </b> ").concat(i("layer_geojson"),"</li>\n        <li><b>WFS: </b> ").concat(i("layer_wfs")," </li>\n        <li><b>KML: </b> ").concat(i("layer_kml"),"</li>\n        <li><b>OGCAPIFeatures: </b> ").concat(i("layer_OGCAPIFeatures"),'</li>\n      </ul>\n      <p><b>Más información:</b> <a href="https://github.com/IGN-CNIG/API-CNIG/wiki/2.1.-Capas">https://github.com/IGN-CNIG/API-CNIG/wiki/2.1.-Capas</a></p>\n    </section>\n');function G(e){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},G(e)}function W(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Z(n.key),n)}}function Z(e){var t=function(e,t){if("object"!=G(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=G(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==G(t)?t:t+""}function H(e,t,r){return t=V(t),function(e,t){if(t&&("object"==G(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,q()?Reflect.construct(t,r||[],V(e).constructor):t.apply(e,r))}function q(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(q=function(){return!!e})()}function V(e){return V=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},V(e)}function Y(e,t){return Y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Y(e,t)}var X="#m-georefimage-title",J="#m-georefimage-format",K="#m-georefimage-dpi",Q=function(e){function t(e,r,n,a){var o,s=e.serverUrl,l=e.printTemplateUrl,c=e.printStatusUrl,u=e.printSelector,p=e.printType;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=H(this,t,[new _(r),t.NAME])).map_=r,M.utils.isUndefined(_)&&M.exception("La implementación usada no puede crear controles Georefimage"),M.utils.isUndefined(_.prototype.encodeLayer)&&M.exception("La implementación usada no posee el método encodeLayer"),o.serverUrl_=s||"https://componentes.cnig.es/geoprint",o.printTemplateUrl_=l||"https://componentes.cnig.es/geoprint/print/mapexport",o.printStatusUrl_=c||"https://componentes.cnig.es/geoprint/print/status",o.printSelector=!!u,o.printType="client"===p?"client":"server",o.elementTitle_=null,o.areaDescription_=null,o.layout_=null,o.format_=null,o.projection_=null,o.dpi_=null,o.forceScale_=null,o.params_={layout:{outputFilename:"mapa_${yyyy-MM-dd_hhmmss}"},pages:{clientLogo:"",creditos:i("printInfo")},parameters:{}},o.capabilitiesPromise_=null,o.options_={dpi:150,forceScale:!1,format:"jpg",legend:"false",layout:"A4 horizontal jpg"},o.layoutOptions_=[],o.dpisOptions_=[],o.outputFormats_=["pdf","png","jpg"],o.documentRead_=document.createElement("img"),o.canvas_=document.createElement("canvas"),o.proyectionsDefect_=["EPSG:3857"],o.statusProxy=n,o.useProxy=a,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Y(e,t)}(t,M.Control),r=t,n=[{key:"getStatus",value:function(e,t,r){var n=this;M.proxy(this.useProxy);var a="".concat(e,"?timestamp=").concat((new Date).getTime());M.remote.get(a).then((function(a){if(404===a.code)throw new Error("Error 404");var o=a.text?JSON.parse(a.text):"error",s=o.status;"finished"===s?t(r):"error"===s||"cancelled"===s?(t(r),o.error.toLowerCase().indexOf("network is unreachable")>-1||o.error.toLowerCase().indexOf("illegalargument")>-1?M.toast.error(i("exception.teselaError"),6e3):M.toast.error(i("exception.printError"),6e3)):setTimeout((function(){return n.getStatus(e,t,r)}),1e3)})).catch((function(e){t(r),r.remove(),M.dialog.error(i("exception.error_download_image"))})),M.proxy(this.statusProxy)}},{key:"active",value:function(e){var t=this;this.html_=e;var r=this.html_.querySelector("#m-printviewmanagement-georefImage");new Promise((function(e,r){var n=M.template.compileSync(O(),{jsonp:!0,vars:{translations:{referenced:i("referenced"),projection:i("projection"),down:i("down"),title:i("title"),georefimageWld:i("georefimageWld"),typeDownload:i("typeDownload"),typeClient:i("typeClient"),typeServer:i("typeServer"),format:i("format"),clipBoard:i("clipBoard"),nameTitle:i("title_view")}}});t.template_=n,e(n)})).then((function(e){var n=M.impl.ol.js.projections.getSupportedProjs().filter((function(e){return e.codes.includes(t.map_.getProjection().code)}))[0],i="".concat(n.datum," - ").concat(n.proj.toUpperCase()," (").concat(n.codes[0],")");t.projection_=t.map_.getProjection().code,t.projectionFormat_=i,t.selectElementHTML(e),t.defaultValueFieldset=null,t.printSelector?(t.defaultValueFieldset=t.elementFieldset_.querySelector('input[type="radio"]:checked').value,t.elementProjection_.innerText=t.projectionFormat_):(t.defaultValueFieldset=t.printType,t.removeSelector()),"client"===t.printType&&(t.template_.querySelector(K).disabled=!0),t.addEvents(),r.classList.contains("activated")?document.querySelector(".m-georefimage-container").remove():t.html_.querySelector("#m-printviewmanagement-controls").appendChild(e),r.classList.toggle("activated")}))}},{key:"removeSelector",value:function(){this.elementFieldset_.remove();var e=document.createElement("h3");e.id="m-georefimage-projection",e.classList.add("m-georefimage-projection"),e.title="EPSG",e.innerText=this.projectionFormat_,this.template_.appendChild(e)}},{key:"addEvents",value:function(){var e=this;this.elementListServices_.addEventListener("click",(function(){return M.dialog.info(U)})),this.elementFieldset_.addEventListener("change",(function(t){var r=t.target.value,n=document.querySelector(K);if("client"===r?n.setAttribute("disabled","disabled"):n.removeAttribute("disabled"),"client"===r){var i=M.impl.ol.js.projections.getSupportedProjs().filter((function(t){return t.codes.includes(e.map_.getProjection().code)}))[0];i&&(e.elementProjection_.innerText="".concat(i.datum," - ").concat(i.proj.toUpperCase()," (").concat(i.codes[0],")"))}else{var a=M.impl.ol.js.projections.getSupportedProjs().filter((function(e){return"EPSG:3857"===e.codes[0]}))[0];e.elementProjection_.innerText="".concat(a.datum," - ").concat(a.proj.toUpperCase()," (").concat(a.codes[0],")")}})),this.elementClipboard_.addEventListener("click",(function(){M.utils.copyImageClipBoard(e.map_)})),M.utils.enableTouchScroll(L(this.html_))}},{key:"selectElementHTML",value:function(e){this.elementTitle_=e.querySelector(X),this.elementFormatSelect_=e.querySelector(J),this.elementWld_=e.querySelector("#m-georefimage-wld"),this.elementProjection_=e.querySelector("#m-georefimage-projection"),this.elementFieldset_=e.querySelector("#m-georefimage-fieldset"),this.elementListServices_=e.querySelector("#m-georefimage-listServices"),this.elementClipboard_=e.querySelector("#m-georefimage-clipboard"),this.elementCanvas_=document.querySelector(".ol-layer canvas")}},{key:"printClick",value:function(e){e.preventDefault(),"server"===(this.printSelector?this.elementFieldset_.querySelector('input[type="radio"]:checked').value:this.printType)?this.downloadServer():this.downloadClient()}},{key:"downloadServer",value:function(){var e=this;this.getPrintData().then((function(r){var n=M.utils.concatUrlPaths([e.printTemplateUrl_,"report.".concat(r.outputFormat)]),a=A(e.html_,e.elementTitle_,e.elementQueueContainer_);n=M.utils.addParameters(n,"mapeaop=geoprint"),M.proxy(e.useProxy),M.remote.post(n,r).then((function(r){var n=r;if(-1===n.text.indexOf("</error>")){var o,s=(n.text&&JSON.parse(n.text)).ref,l=M.utils.concatUrlPaths([e.printStatusUrl_,"".concat(s,".json")]);e.getStatus(l,(function(e){return z(e)}),a);try{if(n=JSON.parse(n.text),e.serverUrl_.endsWith("/geoprint")){var c=e.serverUrl_.substring(0,e.serverUrl_.lastIndexOf("/geoprint"));o=M.utils.concatUrlPaths([c,n.downloadURL])}else o=M.utils.concatUrlPaths([e.serverUrl_,n.downloadURL]);e.documentRead_.src=o}catch(e){M.exception(e)}a.setAttribute(t.DOWNLOAD_ATTR_NAME,o),a.addEventListener("click",e.downloadPrint.bind(e)),a.addEventListener("keydown",e.downloadPrint.bind(e))}else a.remove(),0===document.querySelector("#m-georefimage-queue-container").childNodes.length&&(document.querySelector(".m-printviewmanagement-queue").style.display="none"),M.dialog.error(i("exception").printError)})),M.proxy(e.statusProxy)}))}},{key:"downloadClient",value:function(){var e=this,t=document.querySelector(X),r=document.querySelector(J).value,n=A(this.html_,t,this.elementQueueContainer_);try{M.utils.getImageMap(this.map_,"image/".concat(r),void 0,!0).then((function(t){n.addEventListener("click",(function(r){return e.downloadPrint(r,t,"client")}))}))}catch(e){n.parentElement.remove(),M.toast.error("Error CrossOrigin",null,6e3)}finally{z(n)}}},{key:"getSourceAsDOM",value:function(e){var t=new XMLHttpRequest;return t.open("GET",e,!0),t.send(),(new DOMParser).parseFromString(t.responseText,"text/html")}},{key:"getCapabilities",value:function(){var e=this;return M.utils.isNullOrEmpty(this.capabilitiesPromise_)&&(this.capabilitiesPromise_=new Promise((function(t,r){var n=M.utils.concatUrlPaths([e.printTemplateUrl_,"capabilities.json"]);M.proxy(e.useProxy),M.remote.get(n).then((function(e){var r={};try{r=JSON.parse(e.text)}catch(e){M.exception(e)}t(r)})),M.proxy(e.statusProxy)}))),this.capabilitiesPromise_}},{key:"converterDecimalToDMS",value:function(e){var t,r,n=e.toString().split(".");return t="".concat(n[0],"º "),r="0.".concat(n[1]),r=(r=(r*=60).toString()).split("."),t="".concat(t).concat(r[0],"' "),r="0.".concat(r[1]),r=(r=(r*=60).toString()).split("."),t="".concat(t).concat(r[0],"'' ")}},{key:"convertBboxToDMS",value:function(e){var t=this.map_.getProjection(),r=e;if("m"===t.units){var n=[e.x.min,e.y.min],i=[e.x.max,e.y.max],a=w(t.code,n),o=w(t.code,i);r={x:{min:a[0],max:o[0]},y:{min:a[1],max:o[1]}}}return r=this.convertDecimalBoxToDMS(r)}},{key:"convertDecimalBoxToDMS",value:function(e){return{x:{min:this.converterDecimalToDMS(e.x.min),max:this.converterDecimalToDMS(e.x.max)},y:{min:this.converterDecimalToDMS(e.y.min),max:this.converterDecimalToDMS(e.y.max)}}}},{key:"getPrintData",value:function(){var e,t=this,r=document.querySelector(K);"EPSG:4326"===this.projection_||"EPSG:4258"===this.projection_?(e=this.map_.getProjection().code,this.projection_=e):e=this.projection_;var n=this.map_.getBbox(),i=this.map_.getMapImpl().getSize()[0],a=this.map_.getMapImpl().getSize()[1],o=r.value,s=this.params_.parameters,l=M.utils.extend({layout:"plain",outputFormat:"jpg",attributes:{map:{dpi:o,projection:e}}},this.params_.layout),c=this.map_;return this.encodeLayers().then((function(r){var u=r,p=[];if("EPSG:25830"===e)for(var f=0;f<u.length;f+=1){if(null!=u[f].matrixSet){var d=u[f].matrixSet.replace("GoogleMapsCompatible","EPSG:25830");u[f].matrixSet=d}p.push(u[f])}else p=r;return l.attributes.map.layers=p,l.attributes=Object.assign(l.attributes,s),l.attributes.map.projection=e,l.attributes.map.dpi=o,l.attributes.map.width=i,l.attributes.map.height=a,l.attributes.map.bbox=[n.x.min,n.y.min,n.x.max,n.y.max],c.getProjection().code!==e&&(l.attributes.map.bbox=x(l.attributes.map.bbox,t.map_.getProjection().code,e)),"EPSG:3857"!==e&&t.map_.getLayers().some((function(e){return e.type===M.layer.type.OSM}))&&(l.attributes.map.projection="EPSG:3857",l.attributes.map.bbox=x(l.attributes.map.bbox,e,"EPSG:3857")),l}))}},{key:"encodeLayers",value:function(){var e=this,t=this.map_.getZoom(),r=this.map_.getLayers().filter((function(e){return e.isVisible()&&e.inRange()&&"cluster_cover"!==e.name&&"selectLayer"!==e.name&&"empty_layer"!==e.name&&"__draw__"!==e.name&&"GenericRaster"!==e.type&&"GenericVector"!==e.type&&"MBTiles"!==e.type&&"MBTilesVector"!==e.type&&"MVT"!==e.type&&"MapLibre"!==e.type&&t>e.getImpl().getMinZoom()&&t<=e.getImpl().getMaxZoom()})),n=this.map_.getLayers().filter((function(e){return e.isVisible()&&e.inRange()&&"cluster_cover"!==e.name&&"selectLayer"!==e.name&&"empty_layer"!==e.name&&"__draw__"!==e.name&&("GenericRaster"===e.type||"GenericVector"===e.type||"MBTiles"===e.type||"MBTilesVector"===e.type||"MVT"===e.type||"MapLibre"===e.type)}));if(0!==n.length&&M.toast.warning(i("exception.error_layers")+n.map((function(e){return e.name})).join(", "),null,6e3),20===t){var a=!1;r.forEach((function(e){void 0!==e.url&&"https://tms-pnoa-ma.idee.es/1.0.0/pnoa-ma/{z}/{x}/{-y}.jpeg"===e.url&&(a=!0)})),a&&(r=r.filter((function(e){return"https://tms-pnoa-ma.idee.es/1.0.0/pnoa-ma/{z}/{x}/{-y}.jpeg"!==e.url})))}else if(t<20){var o=!1;r.forEach((function(e){void 0!==e.url&&void 0!==e.name&&"https://www.ign.es/wmts/pnoa-ma?"===e.url&&"OI.OrthoimageCoverage"===e.name&&(o=!0)})),o&&(r=r.filter((function(e){return"https://www.ign.es/wmts/pnoa-ma?"!==e.url&&"OI.OrthoimageCoverage"!==e.name})))}var s=[];if("EPSG:3857"===this.projection_){for(var l=0;l<r.length;l+=1){if(null!=r[l].matrixSet){var c=r[l].matrixSet.replace(r[l].matrixSet,"GoogleMapsCompatible");if(r[l].matrixSet=c,r[l].options.matrixSet){var u=r[l].options.matrixSet.replace(r[l].matrixSet,"GoogleMapsCompatible");r[l].options.matrixSet=u}}s.push(r[l])}r=s}else{for(var p=0;p<r.length;p+=1){if(null!=r[p].matrixSet){var f=r[p].matrixSet.replace(r[p].matrixSet,this.projection_.value),d=r[p].options.matrixSet.replace(r[p].matrixSet,this.projection_.value);r[p].matrixSet=f,r[p].options.matrixSet=d}s.push(r[p])}r=s}var h=r.length,m=this.getImpl().getParametrizedLayers(this.map_,"IMAGEN",r);return m.length>0&&(r=r.concat(m),h=r.length),r=r.sort((function(e,t){var r=0,n=null!==e.getZIndex()?e.getZIndex():0,i=null!==t.getZIndex()?t.getZIndex():0;return n>i?r=1:n<i&&(r=-1),r})),new Promise((function(t,n){var i=[];r.forEach((function(r,n){e.getImpl().encodeLayer(r).then((function(e){M.utils.isNullOrEmpty(e)||(i[n]=e),0==(h-=1)&&t(i.reverse())}))}))}))}},{key:"downloadPrint",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"server";if(void 0===e.key||"Enter"===e.key||" "===e.key){var n=document.querySelector(J).value,i=document.querySelector(X).value,a=document.querySelector(K),o=M.utils.isNullOrEmpty(a)?120:a.value,s=this.map_.getProjection().code,l=this.elementWld_.checked,c=t?t.replace(N,""):B(this.documentRead_.src,n),u=[this.map_.getBbox().x.min,this.map_.getBbox().y.min,this.map_.getBbox().x.max,this.map_.getBbox().y.max];u=x(u,s,this.projection_);var p=F(i),f={name:p.concat(".".concat(n)),data:c,base64:!0},d="jpeg"===n?".jgw":".pgw";R(l?[{name:p.concat(d),data:D(u,o,this.map_.getMapImpl().getSize(),null,this.map_,r),base64:!1},f]:[f],".zip",p)}}},{key:"turnProjIntoLegend",value:function(e){var t;switch(e){case"EPSG:4258":t="ETRS89 (4258)";break;case"EPSG:4326":t="WGS84 (4326)";break;case"EPSG:3857":t="WGS84 (3857)";break;case"EPSG:25831":t="UTM zone 31N (25831)";break;case"EPSG:25830":t="UTM zone 30N (25830)";break;case"EPSG:25829":t="UTM zone 29N (25829)";break;case"EPSG:25828":t="UTM zone 28N (25828)";break;default:t=""}return t}},{key:"equals",value:function(e){var r=!1;return e instanceof t&&(r=this.name===e.name),r}},{key:"deactive",value:function(){this.template_.remove()}},{key:"destroy",value:function(){}}],n&&W(r.prototype,n),a&&W(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,a}();function $(e){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$(e)}function ee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,te(n.key),n)}}function te(e){var t=function(e,t){if("object"!=$(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=$(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==$(t)?t:t+""}function re(e,t,r){return t=ie(t),function(e,t){if(t&&("object"==$(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ne()?Reflect.construct(t,r||[],ie(e).constructor):t.apply(e,r))}function ne(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ne=function(){return!!e})()}function ie(e){return ie=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ie(e)}function ae(e,t){return ae=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ae(e,t)}Q.NAME="georefimagecontrol",Q.TEMPLATE="georefimage.html",Q.LOADING_CLASS="printing",Q.DOWNLOAD_ATTR_NAME="data-donwload-url-print",Q.NO_TITLE="(Sin titulo)";var oe=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=re(this,t)).facadeMap_=e,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ae(e,t)}(t,M.impl.Control),r=t,(n=[{key:"addTo",value:function(e,t){this.facadeMap_=e,this.element=t,e.getMapImpl().addControl(this)}},{key:"destroy",value:function(){this.facadeMap_.getMapImpl().removeControl(this),this.facadeMap_=null}}])&&ee(r.prototype,n),i&&ee(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(),se=r(339),le=r.n(se);function ce(e){return ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ce(e)}function ue(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pe(n.key),n)}}function pe(e){var t=function(e,t){if("object"!=ce(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ce(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ce(t)?t:t+""}function fe(e,t,r){return t=he(t),function(e,t){if(t&&("object"==ce(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,de()?Reflect.construct(t,r||[],he(e).constructor):t.apply(e,r))}function de(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(de=function(){return!!e})()}function he(e){return he=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},he(e)}function me(e,t){return me=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},me(e,t)}var ge=function(e){function t(e,r){var n,a=e.order,o=e.layers;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=fe(this,t,[new oe(r),"georefimage2control"])).map_=r,M.utils.isUndefined(oe)&&M.exception(i("exception.impl")),n.layers_=o||[{url:"http://www.ign.es/wms-inspire/mapa-raster?",name:"mtn_rasterizado",format:"image/jpeg",legend:"Mapa ETRS89 UTM"},{url:"http://www.ign.es/wms-inspire/pnoa-ma?",name:"OI.OrthoimageCoverage",format:"image/jpeg",legend:"Imagen (PNOA) ETRS89 UTM"}],n.layout_="A4 horizontal jpg",n.format_="jpg",n.dpi_=72,n.params_={layout:{outputFilename:"mapa_${yyyy-MM-dd_hhmmss}"},pages:{clientLogo:"",creditos:i("printInfo")},parameters:{}},n.documentRead_=document.createElement("img"),n.canvas_=document.createElement("canvas"),n.canceled=!1,n.order=a>=-1?a:null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&me(e,t)}(t,M.Control),r=t,n=[{key:"active",value:function(e){var t=this;this.html_=e;var r=this.html_.querySelector("#m-printviewmanagement-georefImageEpsg");new Promise((function(e,r){t.template_=M.template.compileSync(le(),{jsonp:!0,vars:{translations:{selectLayer:i("selectLayer"),nameTitle:i("title_list")},layers:t.layers_}}),e(t.template_)})).then((function(e){r.classList.contains("activated")?document.querySelector(".m-georefimageepsg-container").remove():t.html_.querySelector("#m-printviewmanagement-controls").appendChild(e),r.classList.toggle("activated")})),this.accessibilityTab(e)}},{key:"printClick",value:function(e){e.preventDefault();var t=this.map_.getProjection().code,r=this.template_.querySelector("#m-georefimageepsg-select").selectedIndex,n=this.layers_[r],i=n.url,a=n.name,o=n.format,s=n.EPSG,l=n.version,c=n.legend||a,u=new Date,p=u.toLocaleDateString().replaceAll("/",""),f=u.toLocaleTimeString().replaceAll(":","");c="".concat(c,"_").concat(p,"_").concat(f),this.queueEl=A(this.html_,!1,c),this.canceled=!1;var d=this.map_.getBbox(),h=this.map_.getMapImpl().getSize(),m=[];if(s){var g=s,y=!1;if(t===g)m=y=M.utils.ObjectToArrayExtent(d,t);else if("1.1.1"===l||"1.1.0"===l){var v=[d.x.min,d.y.min,d.x.max,d.y.max];m=y=ol.proj.transformExtent(v,t,g)}else{var b=M.utils.ObjectToArrayExtent(d,t);m=y=ol.proj.transformExtent(b,t,g),y=this.transformExtentOL(y,g)}var _=y.join(","),w=this.generateURLLayer_(i,g,h,_,o,a,l);this.downloadPrint(w,m,!0,c)}else{var x=this.getUTMZoneProjection(),S=this.map_.getMapImpl().getView().calculateExtent(h),O=((S=ol.proj.transformExtent(S,t,x))[2]-S[0])/h[0];S[3]=S[1]+O*h[1];var k=this.generateURLLayer_(i,x,h,S,o,a,l);this.downloadPrint(k,S,!1,c)}}},{key:"transformExtentOL",value:function(e,t){return M.impl.ol.js.projections.getSupportedProjs().filter((function(e){return e.codes.includes(t)}))[0].def.includes("+proj=longlat")?[e[1],e[0],e[3],e[2]]:e}},{key:"generateURLLayer_",value:function(e,t,r,n,i,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"1.3.0",s=e,l="1.1.1"===o||"1.1.0"===o?"SRS":"CRS";return s+="SERVICE=WMS&VERSION=".concat(o,"&REQUEST=GetMap&").concat(l,"=").concat(t,"&WIDTH=").concat(r[0],"&HEIGHT=").concat(r[1]),s+="&BBOX=".concat(n,"&FORMAT=").concat(i,"&TRANSPARENT=true&STYLES=default"),s+="&LAYERS=".concat(a)}},{key:"getUTMZoneProjection",value:function(){var e=this.map_.getProjection().code,t=[this.map_.getCenter().x,this.map_.getCenter().y],r=w(this.map_.getProjection().code,t);return r[0]<-12&&r[0]>=-20?e="EPSG:25828":r[0]<-6&&r[0]>=-12?e="EPSG:25829":r[0]<0&&r[0]>=-6?e="EPSG:25830":r[0]<=6&&r[0]>=0&&(e="EPSG:25831"),e}},{key:"downloadPrint",value:function(e,t,r){var n=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=".zip",s=null!==e?e:this.documentRead_.src,l=this.dpi_,c=B(s);this.canceled?L(this.html_).lastChild.remove():c.then((function(e){if(!n.canceled){var i=F(a),s=[{name:i.concat(".jgw"),data:D(t,l,n.map_.getMapImpl().getSize(),r,n.map_,"server"),base64:!1},{name:i.concat(".jpg"),data:e,base64:!0}];n.queueEl.addEventListener("click",(function(){R(s,o,i)})),n.queueEl.addEventListener("keydown",(function(e){13===e.keyCode&&R(s,o,i)})),z(n.queueEl)}})).catch((function(e){L(n.html_).lastChild.remove(),M.dialog.error(i("exception.imageError"))}))}},{key:"equals",value:function(e){var r=!1;return e instanceof t&&(r=this.name===e.name),r}},{key:"accessibilityTab",value:function(e){var t=this;e.querySelectorAll('[tabindex="0"]').forEach((function(e){return e.setAttribute("tabindex",t.order)}))}},{key:"deactive",value:function(){this.template_.remove()}},{key:"destroy",value:function(){}}],n&&ue(r.prototype,n),a&&ue(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,a}();function ye(e){return ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ye(e)}function ve(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,be(n.key),n)}}function be(e){var t=function(e,t){if("object"!=ye(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ye(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ye(t)?t:t+""}function _e(e,t,r){return t=xe(t),function(e,t){if(t&&("object"==ye(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,we()?Reflect.construct(t,r||[],xe(e).constructor):t.apply(e,r))}function we(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(we=function(){return!!e})()}function xe(e){return xe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},xe(e)}function Se(e,t){return Se=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Se(e,t)}var Oe=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=_e(this,t)).facadeMap_=e,r.errors=[],r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Se(e,t)}(t,M.impl.Control),r=t,(n=[{key:"addTo",value:function(e,t){this.facadeMap_=e,this.element=t,e.getMapImpl().addControl(this)}},{key:"getParametrizedLayers",value:function(e,t){var r=this.facadeMap_.getMapImpl().getLayers().getArray().filter((function(t){return!M.utils.isNullOrEmpty(t.getSource())&&!M.utils.isNullOrEmpty(t.getSource().params_)&&void 0!==t.getSource().getParams()[e]}));return r=r.filter((function(e){return!t.some((function(t){return void 0!==t.url&&t.url===e.getSource().getUrl()}))}))}},{key:"encodeLayer",value:function(e){var t=this;return new Promise((function(r,n){try{e.type===M.layer.type.KML&&!1!==e.getImpl().formater_.extractStyles_?r(o(e,t.facadeMap_)):e.type===M.layer.type.KML&&!1===e.getImpl().formater_.extractStyles_?r(t.encodeWFS(e)):e.type===M.layer.type.WMS?r(s(e)):e.type===M.layer.type.WFS||e.type===M.layer.type.GeoJSON?r(t.encodeWFS(e)):e.type===M.layer.type.WMTS?p(e).then((function(e){r(e)})):M.utils.isNullOrEmpty(e.type)&&e instanceof M.layer.Vector?r(t.encodeWFS(e)):void 0===e.type&&"ol-layer"===e.className_?r(l(e)):[M.layer.type.XYZ,M.layer.type.TMS,M.layer.type.OSM].indexOf(e.type)>-1?r(u(e)):e.type===M.layer.type.GeoTIFF?r(c(e)):e.type===M.layer.type.MVT||e.type===M.layer.type.MBTiles||e.type===M.layer.type.MBTilesVector?(t.errors.push(e.name),r("")):r(t.encodeWFS(e))}catch(n){t.errors.push(e.name),r("")}}))}},{key:"encodeWFS",value:function(e){var t=this,r=e.getImpl().getOL3Layer(),n=r.getSource().getFeatures(),i=e.name,a=r.getOpacity(),o=[],s="",l=1,c=1,u=1,p={},f={};return n.forEach((function(r){var n=null;"geometrycollection"===r.getGeometry().getType().toLowerCase()?(n=t.encodeGeometryCollection_(e,r,s,l,u)).geojson.length>0&&(o=o.concat(n.geojson),s+=n.style,l+=n.plusIndex,u+=n.plusIndexGeom):null!==(n=t.encodeFeature_(e,r,s,l,c,u,p,f)).geojson&&(o.push(n.geojson),s=n.style,l+=n.plusIndex,u+=n.plusIndexGeom,c+=n.plusIndexText)}),this),{type:"Vector",style:s=""!==s?JSON.parse(s.concat("}")):{"*":{symbolizers:[]},version:"2"},geoJson:{type:"FeatureCollection",features:o},name:i,opacity:a}}},{key:"encodeFeature_",value:function(e,t,r,n,i,a,o,s){var l=null,c=this.facadeMap_.getProjection(),u=e.getImpl().getOL3Layer().getStyle(),p=new ol.format.GeoJSON,f=this.facadeMap_.getBbox();f=[f.x.min,f.y.min,f.x.max,f.y.max];var d,h,m,g=this.facadeMap_.getMapImpl().getView().getResolution(),y=0,v=0,b=0,_=t.getGeometry(),w=t.getStyle(),x="".concat(r);M.utils.isNullOrEmpty(w)?M.utils.isNullOrEmpty(u)||(m=u):m=w,m instanceof Function&&(m=m.call(m,t,g));var S=null;if(m instanceof Array&&(m.length>1?(S=M.utils.isNullOrEmpty(m[1])||M.utils.isNullOrEmpty(m[1].getImage())||!m[1].getImage().getGlyph?null:m[1].getImage(),m=!M.utils.isNullOrEmpty(m[1].getImage())&&m[1].getImage().getSrc?m[1]:m[0]):m=m[0]),!M.utils.isNullOrEmpty(m)){var O,k=m.getImage(),E=M.utils.isNullOrEmpty(k)?[0,0]:k.getImageSize()||[24,24],C=m.getText();M.utils.isNullOrEmpty(C)&&!M.utils.isNullOrEmpty(m.textPath)&&(C=m.textPath),O="multipolygon"===t.getGeometry().getType().toLowerCase()?"polygon":"multipoint"===t.getGeometry().getType().toLowerCase()?"point":t.getGeometry().getType().toLowerCase().indexOf("linestring")>-1?"line":t.getGeometry().getType().toLowerCase();var T,I=M.utils.isNullOrEmpty(k)?m.getStroke():k.getStroke&&k.getStroke(),P=M.utils.isNullOrEmpty(k)?m.getFill():k.getFill&&k.getFill(),j=null!==m.getStroke()&&void 0!==m.getStroke()?m.getStroke().getLineDash():void 0,N={type:O,fillColor:M.utils.isNullOrEmpty(P)||e.name.indexOf(" Reverse")>-1&&e.name.indexOf("Cobertura")>-1?"#000000":M.utils.rgbaToHex(P.getColor()).slice(0,7),fillOpacity:M.utils.isNullOrEmpty(P)?0:M.utils.getOpacityFromRgba(P.getColor()),strokeColor:M.utils.isNullOrEmpty(I)?"#000000":M.utils.rgbaToHex(I.getColor()),strokeOpacity:M.utils.isNullOrEmpty(I)?0:M.utils.getOpacityFromRgba(I.getColor()),strokeWidth:M.utils.isNullOrEmpty(I)?0:I.getWidth&&I.getWidth(),pointRadius:M.utils.isNullOrEmpty(k)?"":k.getRadius&&k.getRadius(),externalGraphic:M.utils.isNullOrEmpty(k)?"":k.getSrc&&k.getSrc(),graphicHeight:E[0],graphicWidth:E[1],strokeLinecap:"round"};"coordinateresult"===e.name&&(N.fillOpacity=1,N.strokeOpacity=1,N.fillColor="#ffffff",N.strokeColor="#ff0000",N.strokeWidth=2),"infocoordinatesLayerFeatures"===e.name&&(N.fillColor="#ffffff",N.fillOpacity=1,N.strokeWidth=1,N.strokeColor="#2690e7",N.strokeOpacity=1,N.graphicName="cross",N.graphicWidth=15,N.graphicHeight=15),e.name.indexOf(" Reverse")>-1&&e.name.indexOf("Cobertura")>-1&&(N.fillColor=N.strokeColor,N.fillOpacity=.5),null!=j&&j.length>0&&(1===j[0]&&2===j.length?N.strokeDashstyle="dot":10===j[0]?N.strokeDashstyle="dash":1===j[0]&&j.length>2&&(N.strokeDashstyle="dashdot"));var L=!M.utils.isNullOrEmpty(S)&&S.getImage?S.getImage():null;if(M.utils.isNullOrEmpty(L)||(S.getRadius&&S.getRadius()&&(N.pointRadius=S.getRadius&&S.getRadius()),S.getOpacity&&S.getOpacity()&&(N.graphicOpacity=S.getOpacity()),N.externalGraphic=L.toDataURL()),M.utils.isNullOrEmpty(C))"infocoordinatesLayerFeatures"===e.name&&(C=!0,T={type:"text",conflictResolution:"false",fontFamily:"Helvetica, sans-serif",fontStyle:"normal",fontColor:"#ffffff",fontSize:"12px",label:"".concat(t.getId()),labelAlign:"lb",labelXOffset:"4",labelYOffset:"3",haloColor:"#2690e7",haloRadius:"1",haloOpacity:"1"});else{var A=C.getTextAlign(),z=C.getTextBaseline(),D="";M.utils.isNullOrEmpty(A)||(A=A===M.style.align.LEFT?"l":A===M.style.align.RIGHT?"r":A===M.style.align.CENTER?"c":""),M.utils.isNullOrEmpty(z)||(z=z===M.style.baseline.BOTTOM?"b":z===M.style.baseline.MIDDLE?"m":z===M.style.baseline.TOP?"t":""),M.utils.isNullOrEmpty(A)||M.utils.isNullOrEmpty(z)||(D=A.concat(z));var R=C.getFont(),F=!M.utils.isNullOrEmpty(R)&&R.indexOf("bold")>-1?"bold":"normal",B="11px";if(!M.utils.isNullOrEmpty(R)){var U=R.substr(0,R.indexOf("px"));if(!M.utils.isNullOrEmpty(U)){var G=U.lastIndexOf(" ");B=G>-1?U.substr(G,U.length).trim().concat("px"):U.concat("px")}}T={type:"text",label:C.getText(),fontColor:M.utils.isNullOrEmpty(C.getFill())?"#000000":M.utils.rgbToHex(C.getFill().getColor()),fontSize:B,fontFamily:"Helvetica, sans-serif",fontStyle:"normal",fontWeight:F,conflictResolution:"false",labelXOffset:C.getOffsetX(),labelYOffset:C.getOffsetY(),fillColor:N.fillColor||"#FF0000",fillOpacity:N.fillOpacity||1,labelOutlineColor:M.utils.isNullOrEmpty(C.getStroke())?"":M.utils.rgbToHex(C.getStroke().getColor()||"#FF0000"),labelOutlineWidth:M.utils.isNullOrEmpty(C.getStroke())?"":C.getStroke().getWidth(),labelAlign:D}}if(d="draw".concat(n),!M.utils.isNullOrEmpty(_)&&_.intersectsExtent(f)||!M.utils.isNullOrEmpty(C)){var W,Z=JSON.stringify(N),H=JSON.stringify(T),q=o[Z],V=s[H];if(M.utils.isUndefined(q)||M.utils.isUndefined(V)){var Y=[],X=0;if(!M.utils.isNullOrEmpty(_)&&_.intersectsExtent(f)&&M.utils.isUndefined(q)&&(q=a,o[Z]=q,X=1,Y.push(Z),b+=1,y+=1),!M.utils.isNullOrEmpty(C)&&M.utils.isUndefined(V)&&(V=i,s[H]=V,Y.push(H),v+=1,0===X&&(y+=1,Y.push(Z))),void 0===q&&(q=0),void 0===V&&(V=0),h="\"[_gx_style ='".concat(q+V,"']\""),!M.utils.isNullOrEmpty(Y)){var J="".concat(h,': {"symbolizers": [').concat(Y,"]}");-1===x.indexOf(h)&&(x+=""!==x?",".concat(J):"{".concat(J,',"version":"2"'))}}(W="EPSG:3857"!==c.code&&this.facadeMap_.getLayers().some((function(e){return e.type===M.layer.type.OSM||e.type===M.layer.type.Mapbox}))?p.writeFeatureObject(t,{featureProjection:c.code,dataProjection:"EPSG:3857"}):p.writeFeatureObject(t)).properties={_gx_style:q+V,name:d},l=W}}return{style:x,geojson:l,plusIndex:y,plusIndexText:v,plusIndexGeom:b}}},{key:"encodeGeometryCollection_",value:function(e,t,r,n,i){var a,o,s=[],l={},c=this.facadeMap_.getBbox();c=[c.x.min,c.y.min,c.x.max,c.y.max];var u="".concat(r),p=0,f=0;return t.getGeometry().getGeometries().forEach((function(e){var t;if("polygon"===(t="multipolygon"===e.getType().toLowerCase()?"polygon":"multipoint"===e.getType().toLowerCase()?"point":e.getType().toLowerCase().indexOf("linestring")>-1?"line":e.getType().toLowerCase())){var r={type:t,fillColor:"#3399CC",fillOpacity:0,strokeColor:"#3399CC",strokeWidth:2,strokeLinecap:"round"};if(a="draw".concat(n),!M.utils.isNullOrEmpty(e)&&e.intersectsExtent(c)){var d=JSON.stringify(r),h=l[d];if(M.utils.isUndefined(h)){var m=[];if(!M.utils.isNullOrEmpty(e)&&e.intersectsExtent(c)&&M.utils.isUndefined(h)&&(h=i,l[d]=h,m.push(d),f+=1,p+=1),void 0===h&&(h=0),o="\"[_gx_style ='".concat(h,"']\""),!M.utils.isNullOrEmpty(m)){var g="".concat(o,': {"symbolizers": [').concat(m,"]}");u+=""!==u?",".concat(g):"{".concat(g,',"version":"2"')}}var y={type:"Feature",geometry:{type:e.getType(),coordinates:e.getCoordinates()},properties:{_gx_style:h,name:a}};s.push(y)}}})),{style:u,geojson:s,plusIndex:p,plusIndexGeom:f}}},{key:"destroy",value:function(){this.facadeMap_.getMapImpl().removeControl(this),this.facadeMap_=null}}])&&ve(r.prototype,n),i&&ve(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(),ke=r(76),Ee=r.n(ke);function Me(e){return Me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Me(e)}function Ce(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Te(n.key),n)}}function Te(e){var t=function(e,t){if("object"!=Me(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Me(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Me(t)?t:t+""}function Ie(e,t,r){return t=je(t),function(e,t){if(t&&("object"==Me(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Pe()?Reflect.construct(t,r||[],je(e).constructor):t.apply(e,r))}function Pe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Pe=function(){return!!e})()}function je(e){return je=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},je(e)}function Ne(e,t){return Ne=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ne(e,t)}var Le=function(e){function t(e,r,n,a){var o,s=e.serverUrl,l=e.printTemplateUrl,c=e.printStatusUrl,u=e.credits,p=e.logo,f=e.fixedDescription,d=e.headerLegend,h=e.filterTemplates,m=e.order,g=e.tooltip;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=Ie(this,t,[new Oe(r),t.NAME])).map_=r,M.utils.isUndefined(Oe)&&M.exception(i("exception.impl")),M.utils.isUndefined(Oe.prototype.encodeLayer)&&M.exception(i("exception.encode")),o.serverUrl_=s||"https://componentes.cnig.es/geoprint",o.printTemplateUrl_=l||"https://componentes.cnig.es/geoprint/print/CNIG",o.printStatusUrl_=c||"https://componentes.cnig.es/geoprint/print/status",o.credits_=u||"",o.fixedDescription_=void 0!==f&&f,o.layout_=null,o.format_=null,o.projection_=null,o.dpi_=null,o.dpiMax_=null,o.dpiGeo_=120,o.keepView_=null,o.georef_=null,o.headerLegend_=d||"",o.params_={layout:{outputFilename:"mapa_${yyyy-MM-dd_hhmmss}"},pages:{clientLogo:"",creditos:i("credits")},parameters:{logo:p,headerLegend:o.headerLegend_}},o.paramsGeo_={layout:{outputFilename:"mapa_${yyyy-MM-dd_hhmmss}"},pages:{clientLogo:"",creditos:i("printInfo")},parameters:{}},o.queueContainer_=null,o.capabilitiesPromise_=null,o.options_={dpi:150,keepView:!0,format:"pdf",legend:"false",layout:"A4 Horizontal"},o.layoutOptions_=[],o.dpisOptions_=[],o.outputFormats_=["pdf","png"],o.documentRead_=document.createElement("img"),o.canvas_=document.createElement("canvas"),o.proyectionsDefect_=["EPSG:25828","EPSG:25829","EPSG:25830","EPSG:25831","EPSG:3857","EPSG:4326","EPSG:4258"],o.filterTemplates_=h||[],o.order=m>=-1?m:null,o.tooltip_=g||i("tooltip"),o.statusProxy=n,o.useProxy=a,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ne(e,t)}(t,M.Control),r=t,(n=[{key:"getStatus",value:function(e,t,r){var n=this;M.proxy(this.useProxy);var a=(new Date).getTime();M.remote.get("".concat(e,"?timestamp=").concat(a)).then((function(r){if(404===r.code)throw new Error("Error 404");var a=JSON.parse(r.text),o=a.status;"finished"===o?(M.proxy(n.statusProxy),t()):"error"===o||"cancelled"===o?(M.proxy(n.statusProxy),t(),a.error.toLowerCase().indexOf("network is unreachable")>-1||a.error.toLowerCase().indexOf("illegalargument")>-1?M.dialog.error(i("exception.tile")):M.dialog.error(i("exception.error"))):(M.proxy(n.statusProxy),setTimeout((function(){return n.getStatus(e,t)}),1e3))})).catch((function(e){console.log(e,"method getStatus"),t(r),r.remove(),M.dialog.error(i("exception.error_download_image"))}))}},{key:"active",value:function(e){var t=this;this.html_=e;var r=this.html_.querySelector("#m-printviewmanagement-printermap");new Promise((function(e,r){t.getCapabilities().then((function(r){var n,a=r,o=0;for(o=0,n=a.layouts.length;o<n;o+=1){var s=a.layouts[o];if(s.name===t.options_.layout){s.default=!0;break}}t.filterTemplates_.length>0&&(a.layouts=a.layouts.filter((function(e){return t.filterTemplates_.indexOf(e.name)>-1}))),a.layouts=a.layouts.filter((function(e){return!e.name.endsWith("jpg")})),a.layouts.sort((function(e,t){return e.name.indexOf("(Perfil")>-1&&-1===t.name.indexOf("(Perfil")?1:-1===e.name.indexOf("(Perfil")&&t.name.indexOf("(Perfil")>-1?-1:e.name===t.name?0:e.name>t.name?1:-1})),t.layoutOptions_=[].concat(a.layouts.map((function(e){return e.name}))),a.proyections=[];var l,c=t.proyectionsDefect_;for(o=0,n=c.length;o<n;o+=1)if(null!==c[o]){var u=c[o],p={value:u};"EPSG:4258"===u&&(p.default=!0),a.proyections.push(p)}for(a.dpis=[],o=0,n=a.layouts[0].attributes.length;o<n;o+=1)void 0!==a.layouts[0].attributes[o].clientInfo&&(l=a.layouts[0].attributes[o],t.dpiMax_=l.clientInfo.maxDPI);for(o=1,n=l.clientInfo.dpiSuggestions.length;o<n;o+=1){var f=l.clientInfo.dpiSuggestions[o];if(parseInt(f,10)===t.options_.dpi){f.default=!0;break}var d={value:f};a.dpis.push(d)}t.dpisOptions_=[].concat(a.dpis.map((function(e){return e.value}))),Array.isArray(a.formats)&&(t.outputFormats_=a.formats.filter((function(e){return"jpg"!==e}))),a.format=t.outputFormats_.map((function(e){return{name:e,default:"pdf"===e}})),a.keepView=t.options_.keepView,a.fixedDescription=t.fixedDescription_,a.translations={tooltip:i("tooltip"),title:i("title"),description:i("description"),layout:i("layout"),format:i("format"),projection:i("projection"),delete:i("delete"),download:i("download"),fixeddescription:i("fixeddescription"),nameTitle:i("title_map"),maintain_view:i("maintain_view")};var h=M.template.compileSync(Ee(),{jsonp:!0,vars:a});t.accessibilityTab(h),t.selectElementHTML(h),t.template_=h,e(h)}))})).then((function(e){r.classList.contains("activated")?document.querySelector(".m-printermap-container").remove():t.html_.querySelector("#m-printviewmanagement-controls").appendChild(e),r.classList.toggle("activated")}))}},{key:"selectElementHTML",value:function(e){this.elementTitle_=e.querySelector("#m-printermap-title"),this.elementFormat_=e.querySelector("#m-printermap-format"),this.elementTextArea_=e.querySelector("#m-printermap-description"),this.elementLayout_=e.querySelector("#m-printermap-layout"),this.elementDPI_=e.querySelector("#m-printermap-dpi")}},{key:"printClick",value:function(e){var r=this;e.preventDefault();var n,a=this.getPrintData(),o=this.printTemplateUrl_;n=this.downloadPrint,a.then((function(e){r.georef_&&(n=r.downloadGeoPrint.bind(r,e.attributes.map.bbox));var a=M.utils.concatUrlPaths([o,"report.".concat(e.outputFormat)]),s=A(r.html_,r.elementTitle_,r.elementQueueContainer_);a=M.utils.addParameters(a,"mapeaop=geoprint");var l=r.map_.getMapImpl().getControls().getArray().filter((function(e){return void 0!==e.element&&void 0!==e.element.classList&&e.element.classList.contains("ol-profil")}));(null===r.georef_||!r.georef_)&&l.length>0&&(e.attributes.profil=l[0].getImage()),M.proxy(r.useProxy),M.remote.post(a,e).then((function(e){var a=e;if(-1===a.text.indexOf("</error>")){var o,l=(a.text&&JSON.parse(a.text)).ref,c=M.utils.concatUrlPaths([r.printStatusUrl_,"".concat(l,".json")]);r.getStatus(c,(function(){return z(s)}),s);try{var u=(a=JSON.parse(a.text)).downloadURL.substring(a.downloadURL.indexOf("/print"),a.downloadURL.length);o=M.utils.concatUrlPaths([r.serverUrl_,u]),r.documentRead_.src=o}catch(e){M.exception(e)}s.setAttribute(t.DOWNLOAD_ATTR_NAME,o),s.addEventListener("click",n),s.addEventListener("keydown",n)}else s.remove(),0===document.querySelector("#m-georefimage-queue-container").childNodes.length&&(document.querySelector(".m-printviewmanagement-queue").style.display="none"),M.dialog.error(i("exception").printError)})),M.proxy(r.statusProxy)})),M.utils.isNullOrEmpty(this.getImpl().errors)||(M.toast.warning(i("exception.error_layers")+this.getImpl().errors.join(", "),null,6e3),this.getImpl().errors=[])}},{key:"getCapabilities",value:function(){var e=this;return M.utils.isNullOrEmpty(this.capabilitiesPromise_)&&(this.capabilitiesPromise_=new Promise((function(t,r){var n=M.utils.concatUrlPaths([e.printTemplateUrl_,"capabilities.json"]);M.proxy(e.useProxy),M.remote.get(n).then((function(e){var r={};try{r=JSON.parse(e.text)}catch(e){M.exception(e)}t(r)})),M.proxy(e.statusProxy)}))),this.capabilitiesPromise_}},{key:"converterDecimalToDMS",value:function(e){var t,r,n=e.toString().split(".");return t="".concat(n[0],"º "),r="0.".concat(n[1]),r=(r=(r*=60).toString()).split("."),t="".concat(t).concat(r[0],"' "),r="0.".concat(r[1]),r=(r=(r*=60).toString()).split("."),t="".concat(t).concat(r[0],"'' ")}},{key:"convertBboxToDMS",value:function(e){var t=this.map_.getProjection(),r=e;if("m"===t.units){var n=[e.x.min,e.y.min],i=[e.x.max,e.y.max],a=w(t.code,n),o=w(t.code,i);r={x:{min:a[0],max:o[0]},y:{min:a[1],max:o[1]}}}return r=this.convertDecimalBoxToDMS(r)}},{key:"convertDecimalBoxToDMS",value:function(e){return{x:{min:this.converterDecimalToDMS(e.x.min),max:this.converterDecimalToDMS(e.x.max)},y:{min:this.converterDecimalToDMS(e.y.min),max:this.converterDecimalToDMS(e.y.max)}}}},{key:"getPrintData",value:function(){var e=this,t=this.elementTitle_.value,r=this.elementTextArea_.value,n=this.credits_;n.length>2&&(r.length>0?r+=" - ".concat(n):r+=n);var a=this.map_.getProjection().code,o=this.map_.getBbox(),s=this.convertBboxToDMS(o),l=this.elementLayout_.value,c=this.elementDPI_.value,u=this.elementFormat_.value,p=this.params_.parameters,f=document.querySelector("#m-attributions-container>div>a"),d=null!==f?"".concat(i("base"),": ").concat(f.innerHTML):"";"jpg"===u&&(l+=" jpg");var h=new Date,m="".concat(h.getDate(),"/",h.getMonth()+1,"/",h.getFullYear()),g=t.replace(" ","");g.length<=8?(g=g.concat("${yyyyMMddhhmmss}"),this.params_.layout.outputFilename=g):(g=g.substring(0,7).concat("${yyyyMMddhhmmss}"),this.params_.layout.outputFilename=g);var y=M.utils.extend({layout:l,outputFormat:u,attributes:{title:t,description:r,attributionInfo:d,refsrs:this.turnProjIntoLegend(a),printDate:m,map:{dpi:c,projection:a,useAdjustBounds:!0},xCoordTopLeft:s.y.max,yCoordTopLeft:s.x.min,xCoordTopRight:s.y.max,yCoordTopRight:s.x.max,xCoordBotRight:s.y.min,yCoordBotRight:s.x.max,xCoordBotLeft:s.y.min,yCoordBotLeft:s.x.min}},this.params_.layout);return this.encodeLayers().then((function(t){return y.attributes.map.layers=t.filter((function(e){return M.utils.isObject(e)})),y.attributes=Object.assign(y.attributes,p),"EPSG:3857"!==a&&e.map_.getLayers().some((function(e){return e.type===M.layer.type.OSM||e.type===M.layer.type.Mapbox}))&&(y.attributes.map.projection="EPSG:3857"),y.attributes.map.bbox=[o.x.min,o.y.min,o.x.max,o.y.max],"EPSG:3857"!==a&&e.map_.getLayers().some((function(e){return e.type===M.layer.type.OSM||e.type===M.layer.type.Mapbox}))&&(y.attributes.map.bbox=x(y.attributes.map.bbox,a,"EPSG:3857")),y}))}},{key:"getDPI_",value:function(){return this.keepView_?120:this.dpi_.value}},{key:"encodeLayers",value:function(){var e=this,t=this.map_.getZoom(),r=this.map_.getLayers().filter((function(e){return e.isVisible()&&e.inRange()&&"cluster_cover"!==e.name&&"selectLayer"!==e.name&&"empty_layer"!==e.name&&t>e.getImpl().getMinZoom()&&t<=e.getImpl().getMaxZoom()}));if(20===t){var n=!1;r.forEach((function(e){void 0!==e.url&&"https://tms-pnoa-ma.idee.es/1.0.0/pnoa-ma/{z}/{x}/{-y}.jpeg"===e.url&&(n=!0)})),n&&(r=r.filter((function(e){return"https://tms-pnoa-ma.idee.es/1.0.0/pnoa-ma/{z}/{x}/{-y}.jpeg"!==e.url})))}else if(t<20){var i=!1;r.forEach((function(e){void 0!==e.url&&void 0!==e.name&&"https://www.ign.es/wmts/pnoa-ma?"===e.url&&"OI.OrthoimageCoverage"===e.name&&(i=!0)})),i&&(r=r.filter((function(e){return"https://www.ign.es/wmts/pnoa-ma?"!==e.url&&"OI.OrthoimageCoverage"!==e.name})))}var a=r.length,o=this.getImpl().getParametrizedLayers("IMAGEN",r);return o.length>0&&(r=r.concat(o),a=r.length),r=r.sort((function(e,t){var r=0,n=null!==e.getZIndex()?e.getZIndex():0,i=null!==t.getZIndex()?t.getZIndex():0;return n>i?r=1:n<i&&(r=-1),r})),new Promise((function(t,n){var i=[];r.forEach((function(r,n){e.getImpl().encodeLayer(r).then((function(e){M.utils.isNullOrEmpty(e)||(i[n]=e),0==(a-=1)&&t(i.reverse())}))}))}))}},{key:"downloadPrint",value:function(e){if(e.preventDefault(),void 0===e.key||"Enter"===e.key||" "===e.key){var r=this.getAttribute(t.DOWNLOAD_ATTR_NAME);M.utils.isNullOrEmpty(r)||window.open(r,"_blank")}}},{key:"downloadGeoPrint",value:function(e,t){var r=this;B(this.documentRead_.src).then((function(t){var n=r.map_.getMapImpl().getSize(),i=((e[2]-e[0])/n[0]*(72/r.dpiGeo_)).toString(),a=(0).toString(),o=(0).toString(),s=(-(e[3]-e[1])/n[1]*(72/r.dpiGeo_)).toString(),l=(e[0]+i/2).toString(),c=(e[3]+s/2).toString(),u=new Date,p="mapa_".concat(u.getFullYear(),"-",u.getMonth()+1,"-",u.getDay()+1,"_",u.getHours(),u.getMinutes(),u.getSeconds()),f=new(E());f.file(p.concat(".jgw"),i.concat("\n",a,"\n",o,"\n",s,"\n",l,"\n",c)),f.file(p.concat(".jpg"),t,{base64:!0}),f.generateAsync({type:"blob"}).then((function(e){(0,C.saveAs)(e,p.concat(".zip"))}))})).catch((function(e){M.dialog.error(i("exception.imageError"))}))}},{key:"turnProjIntoLegend",value:function(e){var t;switch(e){case"EPSG:4258":t="EPSG:4258 (ETRS89)";break;case"EPSG:4326":t="EPSG:4326 (WGS84)";break;case"EPSG:3857":t="EPSG:3857 (WGS84)";break;case"EPSG:25831":t="EPSG:25831 (UTM ".concat(i("zone")," 31N)");break;case"EPSG:25830":t="EPSG:25830 (UTM ".concat(i("zone")," 30N)");break;case"EPSG:25829":t="EPSG:25829 (UTM ".concat(i("zone")," 29N)");break;case"EPSG:25828":t="EPSG:25828 (UTM ".concat(i("zone")," 28N)");break;default:t=""}return t}},{key:"equals",value:function(e){var r=!1;return e instanceof t&&(r=this.name===e.name),r}},{key:"accessibilityTab",value:function(e){var t=this;e.querySelectorAll('[tabindex="0"]').forEach((function(e){return e.setAttribute("tabindex",t.order)}))}},{key:"deactive",value:function(){this.template_.remove()}},{key:"destroy",value:function(){}}])&&Ce(r.prototype,n),a&&Ce(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,a}();Le.NAME="printermapcontrol",Le.TEMPLATE="printermap.html",Le.LOADING_CLASS="printing",Le.DOWNLOAD_ATTR_NAME="data-donwload-url-print";var Ae=r(329),ze=r.n(Ae);function De(e){return De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},De(e)}function Re(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fe(n.key),n)}}function Fe(e){var t=function(e,t){if("object"!=De(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=De(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==De(t)?t:t+""}function Be(e,t,r){return t=We(t),function(e,t){if(t&&("object"==De(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ue()?Reflect.construct(t,r||[],We(e).constructor):t.apply(e,r))}function Ue(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ue=function(){return!!e})()}function Ge(){return Ge="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=We(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},Ge.apply(null,arguments)}function We(e){return We=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},We(e)}function Ze(e,t){return Ze=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ze(e,t)}var He=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Be(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ze(e,t)}(t,M.impl.Control),r=t,(n=[{key:"addTo",value:function(e,r){Ge(We(t.prototype),"addTo",this).call(this,e,r),this.facadeMap_=e}},{key:"transformCenter",value:function(e,t){var r=this.facadeMap_.getProjection().code;return ol.proj.transform(e,t,r)}}])&&Re(r.prototype,n),i&&Re(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}();function qe(e){return qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qe(e)}function Ve(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ye(n.key),n)}}function Ye(e){var t=function(e,t){if("object"!=qe(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=qe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==qe(t)?t:t+""}function Xe(e,t,r){return t=Ke(t),function(e,t){if(t&&("object"==qe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Je()?Reflect.construct(t,r||[],Ke(e).constructor):t.apply(e,r))}function Je(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Je=function(){return!!e})()}function Ke(e){return Ke=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ke(e)}function Qe(e,t){return Qe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Qe(e,t)}var $e=function(e){function t(e){var r,n=e.isDraggable,a=e.georefImageEpsg,o=e.georefImage,s=e.printermap,l=e.order,c=(e.map,e.serverUrl),u=e.printStatusUrl,p=e.defaultOpenControl,f=e.useProxy,d=e.statusProxy;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),M.utils.isUndefined(He)&&M.exception(i("exception.impl")),(r=Xe(this,t,[new He,"PrintViewManagement"])).isDraggable_=n,r.order=l,r.tooltipGeorefImageEpsg_=a.tooltip||i("tooltip_georefimageepsg"),r.georefImageEpsg_=a,r.georefImage_=o,r.georefImage_ instanceof Object&&(r.georefImage_.serverUrl=c,r.georefImage_.printStatusUrl=u),r.tooltipGeorefImage_=o.tooltip||i("georeferenced_img"),r.printermap_=s,r.printermap_ instanceof Object&&(r.printermap_.serverUrl=c,r.printermap_.printStatusUrl=u),r.tooltipPrintermap_=s.tooltip||i("map_printing"),r.defaultOpenControl=p,r.statusProxy=d,r.useProxy=f,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qe(e,t)}(t,M.Control),r=t,(n=[{key:"createView",value:function(e){var t=this;return this.map_=e,new Promise((function(e,r){var n=M.template.compileSync(ze(),{vars:{georefImageEpsg:!!t.georefImageEpsg_,georefImage:!!t.georefImage_,printermap:!!t.printermap_,translations:{headertitle:i("tooltip"),tooltipGeorefImageEpsg:t.tooltipGeorefImageEpsg_,georefImage:t.tooltipGeorefImage_,printermap:t.tooltipPrintermap_,downImg:i("downImg"),delete:i("delete")}}});t.html=n,t.georefImageEpsg_&&t.addGeorefImageEpsgControl(n),t.georefImage_&&t.addGeorefImageControl(n),t.printermap_&&t.addPrinterMapControl(n),t.isDraggable_&&M.utils.draggabillyPlugin(t.getPanel(),"#m-printviewmanagement-title"),t.accessibilityTab(n),t.selectElementHTML(),t.addEvent(),t.defaultOpenControl_(n),e(n)}))}},{key:"selectElementHTML",value:function(){this.elementRemoveButton_=this.html.querySelector("#m-printviewmanagement-remove"),this.elementPrintButton_=this.html.querySelector("#m-printviewmanagement-print")}},{key:"addEvent",value:function(){var e=this;this.elementRemoveButton_.addEventListener("click",(function(){return t=e.html,r=L(t),void(0!==(n=T(r.childNodes)).length&&(n.forEach((function(e){r.removeChild(e)})),r.parentElement.style.display="none"));var t,r,n})),this.elementPrintButton_.addEventListener("click",(function(t){var r=e.getControlActive(e.html);r&&("m-printviewmanagement-georefImage"===r.id&&e.georefImageControl.printClick(t),"m-printviewmanagement-georefImageEpsg"===r.id&&e.georefImageEpsgControl.printClick(t),"m-printviewmanagement-printermap"===r.id&&e.printerMapControl.printClick(t))})),document.addEventListener("keydown",(function(e){if("Escape"===e.key){var t=document.querySelector(".m-panel.m-plugin-printviewmanagement.opened");null!==t&&t.querySelector("button.m-panel-btn").click()}}))}},{key:"defaultOpenControl_",value:function(e){1===this.defaultOpenControl&&this.printermap_&&(this.showDownloadButton("printermap"),this.deactive(e,"printermap"),this.printerMapControl.active(e)),2===this.defaultOpenControl&&this.georefImage_&&(this.showDownloadButton("georefImage"),this.deactive(e,"georefImage"),this.georefImageControl.active(e)),3===this.defaultOpenControl&&this.georefImageEpsg_&&(this.showDownloadButton("georefImageEpsg"),this.deactive(e,"georefImageEpsg"),this.georefImageEpsgControl.active(e))}},{key:"equals",value:function(e){return e instanceof t}},{key:"addGeorefImageEpsgControl",value:function(e){var t=this;this.georefImageEpsgControl=new ge(this.georefImageEpsg_,this.map_),e.querySelector("#m-printviewmanagement-georefImageEpsg").addEventListener("click",(function(){t.showDownloadButton("georefImageEpsg"),t.deactive(e,"georefImageEpsg"),t.georefImageEpsgControl.active(e)}))}},{key:"addPrinterMapControl",value:function(e){var t=this;this.printerMapControl=new Le(this.printermap_,this.map_,this.statusProxy,this.useProxy),e.querySelector("#m-printviewmanagement-printermap").addEventListener("click",(function(){t.showDownloadButton("printermap"),t.deactive(e,"printermap"),t.printerMapControl.active(e)}))}},{key:"addGeorefImageControl",value:function(e){var t=this;this.georefImageControl=new Q(this.georefImage_,this.map_,this.statusProxy,this.useProxy),e.querySelector("#m-printviewmanagement-georefImage").addEventListener("click",(function(){t.showDownloadButton("georefImage"),t.deactive(e,"georefImage"),t.georefImageControl.active(e)}))}},{key:"showDownloadButton",value:function(e){var t="#m-georefimage-download-button";this.elementDownloadButton_=this.html.querySelector(t);var r=this.html.querySelector("".concat(t," > button"));"none"===this.elementDownloadButton_.style.display&&(this.elementDownloadButton_.style.display="flex"),"printermap"===e?(r.title=i("downMap"),r.innerHTML=i("downMap")):(r.title=i("downImg"),r.innerHTML=i("downImg"))}},{key:"hidemDownloadButton",value:function(){this.elementDownloadButton_=this.html.querySelector("#m-georefimage-download-button"),"flex"===this.elementDownloadButton_.style.display&&(this.elementDownloadButton_.style.display="none")}},{key:"deactive",value:function(e,t){var r=this.getControlActive(e);r&&(r&&r.id!=="m-printviewmanagement-".concat(t)?("m-printviewmanagement-georefImage"===r.id&&this.georefImageControl.deactive(),"m-printviewmanagement-georefImageEpsg"===r.id&&this.georefImageEpsgControl.deactive(),"m-printviewmanagement-printermap"===r.id&&this.printerMapControl.deactive(),r.classList.remove("activated")):r.id==="m-printviewmanagement-".concat(t)&&this.hidemDownloadButton())}},{key:"getControlActive",value:function(e){return 0!==e.querySelectorAll("#m-printviewmanagement-previews .activated").length&&e.querySelectorAll("#m-printviewmanagement-previews .activated")[0]}},{key:"accessibilityTab",value:function(e){var t=this;e.querySelectorAll('[tabindex="0"]').forEach((function(e){return e.setAttribute("tabindex",t.order)}))}},{key:"destroy",value:function(){M.utils.isNullOrEmpty(this.georefImageControl)||this.georefImageControl.destroy(),M.utils.isNullOrEmpty(this.printerMapControl)||this.printerMapControl.destroy()}}])&&Ve(r.prototype,n),a&&Ve(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,a}(),et=r(431),tt=r.n(et);function rt(e){return rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rt(e)}function nt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,it(n.key),n)}}function it(e){var t=function(e,t){if("object"!=rt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=rt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==rt(t)?t:t+""}function at(e,t,r){return t=st(t),function(e,t){if(t&&("object"==rt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ot()?Reflect.construct(t,r||[],st(e).constructor):t.apply(e,r))}function ot(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ot=function(){return!!e})()}function st(e){return st=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},st(e)}function lt(e,t){return lt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},lt(e,t)}var ct=function(r){function n(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=at(this,n)).map_=null,e.controls_=[],e.name="printviewmanagement",e.options=t,e.position_=t.position||"TL",e.collapsed=!!M.utils.isUndefined(t.collapsed)||t.collapsed,e.collapsible=!!M.utils.isUndefined(t.collapsible)||t.collapsible,e.tooltip_=t.tooltip||i("tooltip"),e.isDraggable=!0===t.isDraggable||"true"===t.isDraggable;var r=t.georefImageEpsg;!0===(void 0===r||r)?e.georefImageEpsg={layers:[{url:"http://www.ign.es/wms-inspire/mapa-raster?",name:"mtn_rasterizado",format:"image/jpeg",legend:"Mapa ETRS89 UTM"},{url:"http://www.ign.es/wms-inspire/pnoa-ma?",name:"OI.OrthoimageCoverage",format:"image/jpeg",legend:"Imagen (PNOA) ETRS89 UTM"}],order:0}:t.georefImageEpsg?e.georefImageEpsg=e.getGeorefImageEpsg():e.georefImageEpsg=!1;var a=t.georefImage;!0===(void 0===a||a)?e.georefImage={tooltip:"Georeferenciar imagen",printTemplateUrl:"https://componentes.cnig.es/geoprint/print/mapexport",printSelector:!0}:t.georefImage?e.georefImage=t.georefImage:e.georefImage=!1;var o=t.printermap;!0===(void 0===o||o)?e.printermap={printTemplateUrl:"https://componentes.cnig.es/geoprint/print/CNIG",filterTemplates:[],credits:""}:t.printermap?e.printermap=t.printermap:e.printermap=!1;var s=t.serverUrl;return s&&s.endsWith("/geoprint/")&&(s=s.replace("/geoprint/","/geoprint")),e.serverUrl=s||"https://componentes.cnig.es/geoprint",e.printStatusUrl=t.printStatusUrl||"https://componentes.cnig.es/geoprint/print/status",e.defaultOpenControl=t.defaultOpenControl||0,e.order=t.order>=-1?t.order:null,e.useProxy=!M.utils.isUndefined(t.useProxy)&&t.useProxy,e.statusProxy=M.useproxy,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lt(e,t)}(n,M.Plugin),a=n,s=[{key:"getJSONTranslations",value:function(r){return"en"===r||"es"===r?"en"===r?e:t:M.language.getTranslation(r).printviewmanagement}}],(o=[{key:"addTo",value:function(e){this.map_=e,!1===this.georefImageEpsg&&!1===this.georefImage&&!1===this.printermap&&M.dialog.error(i("exception.no_controls")),this.controls_.push(new $e({isDraggable:this.isDraggable,georefImageEpsg:this.georefImageEpsg,georefImage:this.georefImage,printermap:this.printermap,order:this.order,map:this.map_,serverUrl:this.serverUrl,printTemplateUrl:this.printTemplateUrl,printStatusUrl:this.printStatusUrl,defaultOpenControl:this.defaultOpenControl,useProxy:this.useProxy,statusProxy:this.statusProxy})),this.panel_=new M.ui.Panel("panelPrintViewManagement",{collapsible:this.collapsible,collapsed:this.collapsed,position:M.ui.position[this.position_],className:"m-plugin-printviewmanagement",tooltip:this.tooltip_,collapsedButtonClass:"printviewmanagement-icon-flecha-historial",order:this.order}),this.panel_.addControls(this.controls_),e.addPanels(this.panel_)}},{key:"getGeorefImageEpsg",value:function(){var e=this.options.georefImageEpsg;return{layers:e.layers,order:0,tooltip:e.tooltip}}},{key:"getAPIRest",value:function(){return"".concat(this.name,"=").concat(this.position_,"*").concat(this.collapsed,"*").concat(this.collapsible,"*").concat(this.tooltip_,"*").concat(this.isDraggable)+"*".concat(this.serverUrl,"*").concat(this.printStatusUrl,"*").concat(!!this.georefImageEpsg,"*").concat(!!this.georefImage,"*").concat(!!this.printermap,"*").concat(this.defaultOpenControl)}},{key:"getAPIRestBase64",value:function(){return"".concat(this.name,"=base64=").concat(M.utils.encodeBase64(this.options))}},{key:"destroy",value:function(){this.map_.removeControls(this.controls_),this.map_=null,this.controls_=null,this.panel_=null,this.name=null}},{key:"equals",value:function(e){return e instanceof n}},{key:"getHelp",value:function(){return{title:this.name,content:new Promise((function(e){e(M.template.compileSync(tt(),{vars:{urlImages:"".concat(M.config.MAPEA_URL,"plugins/printviewmanagement/images/"),translations:{help1:i("textHelp.help1"),help2:i("textHelp.help2"),help3:i("textHelp.help3"),help4:i("textHelp.help4"),help5:i("textHelp.help5"),help6:i("textHelp.help6"),help7:i("textHelp.help7"),help8:i("textHelp.help8"),help9:i("textHelp.help9"),help10:i("textHelp.help10"),help11:i("textHelp.help11"),help12:i("textHelp.help12"),help13:i("textHelp.help13")}}}))}))}}}])&&nt(a.prototype,o),s&&nt(a,s),Object.defineProperty(a,"prototype",{writable:!1}),a;var a,o,s}();window.M.control||(window.M.control={}),window.M.plugin||(window.M.plugin={}),window.M.impl||(window.M.impl={}),window.M.impl.control||(window.M.impl.control={}),window.M.control.GeorefimageControl=Q,window.M.control.GeorefImageEpsgControl=ge,window.M.control.PrinterMapControl=Le,window.M.plugin.PrintViewManagement=ct,window.M.control.PrintViewManagementControl=$e,window.M.impl.control.GeorefimageControl=_,window.M.impl.control.GeorefImageEpsgControl=oe,window.M.impl.control.PrinterMapControl=Oe,window.M.impl.control.PrintViewManagementControl=He})()})();
//# sourceMappingURL=printviewmanagement.ol.min.js.map
!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=8)}([function(e){e.exports=JSON.parse('{"exception":{"cobertura":"Checking coverage in the area...","nocobertura":"This layer has no coverage in this area"},"textHelp":{"help1":"The \'storyMap\' extension allows you to interact through a text panel with the map of a viewer","help2":"The text panel is divided into index, chapters and steps of each chapter.","help3":"The index part summarizes the chapters into which the \'storyMap\' is divided:","help4":"Once we have entered a chapter, we can go through the different steps of the chapter:","help5":"There are three ways to interact with the \'storyMap\' panel.","help6":"The first one is by scrolling down the text panel, this will make it go from step to step:","help7":"The second is through the \'play\', pause and speed controls. This will make the \'storyMap\' advance automatically:","help8":"And the third is from the control of chapters and steps, the circles on the right mark the different chapters that the \'storyMap\' has and those on the right mark the steps that each chapter has:","help9":"The information relevant to the extension and its possible parameterization is documented in","help10":"The example of use of its parameters can be checked in"},"tooltip":"Story Map","warning":"WARNING"}')},function(e){e.exports=JSON.parse('{"exception":{"cobertura":"Comprobando cobertura en la zona...","nocobertura":"Esta capa no tiene cobertura en esta zona"},"textHelp":{"help1":"La extensión de \'storyMap\' permite interactuar mediante un panel de texto con el mapa de un visualizador","help2":"El panel de texto se divide en índice, capítulos y pasos de cada capítulo.","help3":"La parte del índice hace un resumen de los capítulos en los que está dividido el \'storyMap\':","help4":"Una vez entrado en un capítulo, podemos ir pasando por los distintos pasos del capítulo:","help5":"Existen tres formas de interactuar con el panel del \'storyMap\'.","help6":"La primera de ellas es haciendo \'scroll\' hacia abajo en el panel de texto, esto hará que se vaya pasando de paso en paso:","help7":"La segunda, es mediante los controles de \'play\', pausa y velocidad. Esto hará que el \'storyMap\' avance automáticamente:","help8":"Y la tercera es desde el control de capítulos y pasos, los círculos más a la derecha marcan los distintos capítulos que tiene el \'storyMap\' y los de la derecha marcan los pasos que tiene cada capítulo:","help9":"La información relevante a la extensión y su posible parametrización está documentada en","help10":"El ejemplo de uso de sus parámetros puede comprobarse en"},"tooltip":"Story Map","warning":"AVISO"}')},function(e){e.exports=JSON.parse('{"url":{"name":"storymap","separator":"*"},"constructor":"M.plugin.StoryMap","parameters":[{"type":"object","properties":[{"type":"simple","name":"position","position":0,"possibleValues":["TL","TR","BR","BL"]},{"type":"boolean","name":"collapsed","position":1},{"type":"boolean","name":"collapsible","position":2},{"type":"simple","name":"tooltip","position":3},{"type":"simple","name":"delay","position":4}]}],"files":{"ol":{"scripts":["storymap.ol.min.js"],"styles":["storymap.ol.min.css"]}},"metadata":{"name":"StoryMap","description":"Table of contents of the map. Pretty design version","text":"Tabla de contenidos de fototeca. Consulta cobertura de vuelo sobre la vista","version":"1.1.0","date":"18/11/2019","author":"Guadaltel","org":"CNIG","tags":"mapea,plugin","icon":"./facade/assets/icons/icons.svg"}}')},function(e,t){e.exports='<div id="m-storymap-container" class="m-control m-container m-storymap-container m-storymap">\n    <div class="m-storymap-panel" id="m-storymap-panel">\n        <div class="title">\n            {{title}}\n        </div>\n        <main class="mainStoryMap">\n            <div class="navPointer" id="navPointer">\n\n                <button speed="{{speed}}" id="buttonDelay" class="buttonDelay">\n                    1x\n                </button>\n\n                <svg id="play" height="23" width="23" xmlns="http://www.w3.org/2000/svg"\n                    class="icon icon-tabler icon-tabler-player-play" width="44" height="44" viewBox="0 0 24 24"\n                    stroke-width="1.5" stroke="#65a3d4" fill="none" stroke-linecap="round" stroke-linejoin="round">\n                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />\n                    <path d="M7 4v16l13 -8z" />\n                </svg>\n                <svg id="pause" style="display: none;" height="23" width="23" xmlns="http://www.w3.org/2000/svg"\n                    class="icon icon-tabler icon-tabler-player-pause" width="44" height="44" viewBox="0 0 24 24"\n                    stroke-width="1.5" stroke="#65a3d4" fill="none" stroke-linecap="round" stroke-linejoin="round">\n                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />\n                    <rect x="6" y="5" width="4" height="14" rx="1" />\n                    <rect x="14" y="5" width="4" height="14" rx="1" />\n                </svg>\n\n            </div>\n            <div class="navStep" id="navStep">\n            </div>\n            <div class="navContent">\n                <section id="contentStoryMap" class="contentStoryMap">\n                    <header class="header_contentStoryMap">\n                        <h2 id="title_contentStoryMap">title</h2>\n                        <p id="subtitle_contentStoryMap">sub</p>\n                    </header>\n\n                </section>\n            </div>\n            <div class="arrowScroll">\n                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-big-down" width="44"\n                    height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#71a7d3" fill="none"\n                    stroke-linecap="round" stroke-linejoin="round">\n                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />\n                    <path\n                        d="M15 4v8h3.586a1 1 0 0 1 .707 1.707l-6.586 6.586a1 1 0 0 1 -1.414 0l-6.586 -6.586a1 1 0 0 1 .707 -1.707h3.586v-8a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1z" />\n                </svg>\n            </div>\n        </main>\n    </div>\n\n</div>'},function(e,t,n){e.exports='<div>\n   <h2 style="text-align: center; color: #fff; background-color: #364b5f; padding: 8px 10px;">STORYMAP <img style="vertical-align: bottom; filter: invert(100%);" src="'+n(7)+'" width="30" height="30"></h2>\n   <div>\n      <p>{{translations.help1}}</p>\n      <p>{{translations.help2}}</p>\n      <img src="{{urlImages}}/storymap_0.png" style="max-width:70%; margin: 0 auto; display: block">\n      <p>{{translations.help3}}</p>\n      <img src="{{urlImages}}/storymap_1.png" style="max-width:70%; margin: 0 auto; display: block">\n      <p>{{translations.help4}}</p>\n      <img src="{{urlImages}}/storymap_2.png" style="max-width:70%; margin: 0 auto; display: block">\n      <p>{{translations.help5}}</p>\n      <p>{{translations.help6}}</p>\n      <img src="{{urlImages}}/storymap_3.png" style="max-width:70%; margin: 0 auto; display: block">\n      <p>{{translations.help7}}</p>\n      <img src="{{urlImages}}/storymap_4.png" style="max-width:70%; margin: 0 auto; display: block">\n      <p>{{translations.help8}}</p>\n      <img src="{{urlImages}}/storymap_5.png" style="max-width:70%; margin: 0 auto; display: block">\n      <p>{{translations.help9}}: <a tabindex="0" href="https://github.com/IGN-CNIG/API-CNIG/tree/master/api-ign-js/src/plugins/storymap" target="_blank">https://github.com/IGN-CNIG/API-CNIG/tree/master/api-ign-js/src/plugins/storymap</a></p>\n      <p>{{translations.help10}}: <a tabindex="0" href="https://componentes.cnig.es/api-core/storymap.jsp?language=es" target="_blank">https://componentes.cnig.es/api-core/storymap.jsp?language=es</a></p>\n   </div>\n</div>\n\n'},function(e,t,n){},function(e,t,n){},function(e,t){e.exports="data:image/svg+xml;base64,PCEtLSBHZW5lcmF0ZWQgYnkgSWNvTW9vbi5pbyAtLT4KPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMjQiIGhlaWdodD0iMTAyNCIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCI+Cjx0aXRsZT48L3RpdGxlPgo8ZyBpZD0iaWNvbW9vbi1pZ25vcmUiPgo8L2c+CjxwYXRoIGZpbGw9IiMwMDAiIGQ9Ik0zODQgMTkxLjMzM3Y2MHEtNTQtMjItMTEyLTIyLTU2IDAtMTExIDIydC05OSA2NmwxNDIgMTQyaDQ2djQ4cTI4IDI2IDYzIDQxdDcxIDE3djk2aC0xMjh2MTI4cTAgMzYgMjUgNjF0NjEgMjVoNDI2cTM2IDAgNjUtMTh0NDYtNDcgMTctNjN2LTU1NmgtNTEyek0zMzYgNDY1LjMzM3YtOTJoLTk2bC00Ni00NHEzOC0xNCA3OC0xNCA4OCAwIDE1MiA2Mmw2MCA2MC04IDhxLTM0IDM0LTgyIDM0LTMwIDAtNTgtMTR6TTgxMCA3NDcuMzMzcTAgMTYtMTIgMjl0LTMwIDEzLTMwLTEzLTEyLTI5di04NmgtMjU2di0xMTBxMzgtMTYgNjYtNDRsOC04IDEyMiAxMjBoNjB2LTYwbC0yNTYtMjU2di0yNmgzNDB2NDcweiI+PC9wYXRoPgo8L3N2Zz4K"},function(e,t,n){"use strict";n.r(t);n(5),n(6);var o=n(2);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,c(o.key),o)}}function c(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function l(e,t,n){return t=u(t),function(e,t){if(t&&("object"==r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}()?Reflect.construct(t,n||[],u(e).constructor):t.apply(e,n))}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=p(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}}).apply(null,arguments)}function p(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var y=function(e){function t(){return a(this,t),l(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(t,M.impl.Control),n=t,(o=[{key:"addTo",value:function(e,n){s(u(t.prototype),"addTo",this).call(this,e,n)}}])&&i(n.prototype,o),r&&i(n,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,o,r}(),f=n(3),h=n.n(f);function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,g(o.key),o)}}function g(e){var t=function(e,t){if("object"!=v(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=v(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==v(t)?t:t+""}function S(e,t,n){return t=k(t),function(e,t){if(t&&("object"==v(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}()?Reflect.construct(t,n||[],k(e).constructor):t.apply(e,n))}function w(){return(w="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=x(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}}).apply(null,arguments)}function x(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=k(e)););return e}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function T(e,t){return(T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var P=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3,r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;b(this,t);var i=new y;return(e=S(this,t,[i,"StoryMapControl"])).content_=n,e.delay=o,e.stepIndex=0,e.indexCap=0,e.indexInContent=r,e.direction=!0,e.svgArrowScroll=!0,e.arrowScrollEffect_contador=1,e.panelHTML_=null,e.isDraggable_=a,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T(e,t)}(t,M.Control),n=t,(o=[{key:"createView",value:function(e){var t=this;return this.map_=e,new Promise((function(n,o){var r=M.template.compileSync(h.a,{vars:{title:"Story Map",speed:t.delay/1e3}});r=t.createContent(r,t.indexInContent),t.scrollEvent(r),r=t.createNavPointer(r,t.content_.cap.length),r=t.buttonDelay(r),e.on("M.evt.COMPLETED",(function(){t.createPointerSteps(0)})),window.innerWidth<=772&&(t.handleMovil(),document.querySelector(".m-plugin-storymap .m-panel-btn").addEventListener("click",t.handleMovil)),r=t.createPlayPause(r),r=t.arrowEvent(r),r=t.eventIndex(r),t.panelHTML_=r,t.isDraggable_&&M.utils.draggabillyPlugin(t.getPanel(),"#m-storymap-panel .title"),n(t.panelHTML_)}))}},{key:"createContent",value:function(e,t){var n=e.querySelector("#contentStoryMap"),o=this.content_.cap;if(t){var r={title:t.title,subtitle:t.subtitle,steps:[{html:"".concat(this.createIndex(),"<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>"),js:t.js}]};o.unshift(r)}e.querySelector("#title_contentStoryMap").innerHTML=o[0].title,e.querySelector("#subtitle_contentStoryMap").innerHTML=o[0].subtitle;var a="";return o.forEach((function(e,t){var n=e.steps;a+="<div id=cap".concat(t,0===t?' style="display: block;" class="chapters">':' style="display: none;" class="chapters">'),n.forEach((function(e,n){var o=e.html;e.js,a+=0===n&&0===t?'<div id="step'.concat(n,'" class="step" style="display: block;"><br><br>').concat(o,"<br><br></div>"):'<div id="step'.concat(n,'" class="step" style="display: none;"><br><br>').concat(o,"<br><br></div>")})),a+="</div>"})),n.innerHTML+=a,e.querySelector("#navStep").innerHTML='<svg id="pointStep0" height="23" width="23" index="0">\n    <circle class="pointerEffect" index="0" stroke="#71a7d3" strokeWidth="1" fill="#71a7d3" cx="50%" cy="50%" r="4" />\n  </svg>',e}},{key:"disableCap",value:function(e,t,n){var o=document.querySelector("#contentStoryMap").querySelectorAll(".chapters"),r=o[e].querySelectorAll(".step");o[t].style="display: none",o[e].style="display: block";var a=n?r[0]:r[r.length-1];this.addJSCap(e,n?0:r.length-1),a.style="display: block",a.scroll({top:20,behavior:"smooth"}),this.changeTitleSubtitle(e)}},{key:"disableStep",value:function(e,t){var n=document.querySelector("#cap".concat(e));n.querySelectorAll(".step").forEach((function(e){e.style="display: none;"}));var o=n.querySelector("#step".concat(t));o.style="display: block",o.scroll({top:20,behavior:"smooth"})}},{key:"changeTitleSubtitle",value:function(e){var t=this.content_.cap;document.querySelector("#title_contentStoryMap").innerHTML=t[e].title,document.querySelector("#subtitle_contentStoryMap").innerHTML=t[e].subtitle}},{key:"capIndex",value:function(e,t){var n=document.querySelector(e).querySelectorAll(t);for(var o in n)if("block"===n[o].style.display&&!Number.isNaN(o)){var r=n[o].id;return Number.parseInt(r[r.length-1],10)}return!1}},{key:"createNavPointer",value:function(e,t){for(var n=this,o=e.querySelector("#navPointer"),r=0;r<t;r++)o.innerHTML+=0===r?'\n        <svg id="pointerNav'.concat(r,'" height="23" width="23" index="').concat(r,'">\n          <circle class="pointerEffect" index="').concat(r,'" stroke="#71a7d3" strokeWidth="1" fill="#71a7d3" cx="50%" cy="50%" r="4" />\n        </svg>\n        '):'\n        <svg id="pointerNav'.concat(r,'" height="23" width="23" index="').concat(r,'">\n          <circle index="').concat(r,'" stroke="#71a7d3" strokeWidth="1" fill="#71a7d3" cx="50%" cy="50%" r="4" />\n        </svg>\n        ');return e.querySelectorAll("#navPointer > svg").forEach((function(e,t){0!==t&&1!==t&&(e.addEventListener("click",(function(e){var t=e.target;n.resetScroll(),n.disableCap(t.getAttribute("index"),n.capIndex("#contentStoryMap",".chapters"),!0),n.createPointerSteps(t.getAttribute("index")),n.effectPointer(t.getAttribute("index"),"#pointerNav","navPointer"),n.effectPointer(0,"#pointStep","navStep")})),e.children[0].addEventListener("click",(function(e){var t=e.target;n.resetScroll(),n.disableCap(t.getAttribute("index"),n.capIndex("#contentStoryMap",".chapters"),!0),n.createPointerSteps(t.getAttribute("index")),n.effectPointer(t.getAttribute("index"),"#pointerNav","navPointer"),n.effectPointer(0,"#pointStep","navStep")})))})),e}},{key:"createPointerSteps",value:function(e){var t=this,n=this.content_.cap[e].steps,o="";n.forEach((function(e,t){o+=0===t?'<svg id="pointStep'.concat(t,'" height="23" width="23" index="').concat(t,'">\n        <circle class="pointerEffect" index="').concat(t,'" stroke="#71a7d3" strokeWidth="1" fill="#71a7d3" cx="50%" cy="50%" r="4" />\n      </svg>'):'<svg id="pointStep'.concat(t,'" height="23" width="23" index="').concat(t,'">\n        <circle index="').concat(t,'" stroke="#71a7d3" strokeWidth="1" fill="#71a7d3" cx="50%" cy="50%" r="4" />\n      </svg>')}));var r=document.querySelector("#navStep");r.innerHTML=o,r.querySelectorAll("svg").forEach((function(n){n.addEventListener("click",(function(n){var o=n.target;t.disableStep(e,o.getAttribute("index")),t.addJSCap(e,o.getAttribute("index")),t.effectPointer(o.getAttribute("index"),"#pointStep","navStep")}))}))}},{key:"createPlayPause",value:function(e){var t=this,n=e.querySelector("#play"),o=e.querySelector("#pause");return this.idTimeCap=0,this.allIntervalId=[],n.addEventListener("click",(function(){n.style.display="none",o.style.display="block",t.idTimeCap=t.timeCap(),t.allIntervalId.push(t.idTimeCap)})),o.addEventListener("click",(function(){o.style.display="none",n.style.display="block",t.allIntervalId.forEach((function(e){clearInterval(e)}))})),e}},{key:"resetScroll",value:function(){document.querySelectorAll(".step").forEach((function(e){e.style="display: none"}))}},{key:"scrollEvent",value:function(e){var t=this,n=e.querySelectorAll(".chapters");return n.forEach((function(e){e.querySelectorAll(".step").forEach((function(o){o.addEventListener("scroll",(function(r){var a=r.target;if(t.svgArrowScroll&&t.arrowScrollEffect(),Math.abs(a.scrollHeight-a.clientHeight-a.scrollTop)<1&&(n[n.length-1].id!==e.id||"step".concat(e.childElementCount-1)!==a.id)){a.style="display: none";var i=Number(o.id.replace("step",""))+1;if(e.querySelectorAll(".step").length-1<i){var c=Number(e.id.replace("cap",""))+1;document.querySelector("#cap".concat(c)).style="display: block",document.querySelector("#cap".concat(c)).querySelector("#step0").style="display: block",document.querySelector("#".concat(e.id)).style="display: none",t.addJSCap(c,0),t.effectPointer(c,"#pointerNav","navPointer"),t.createPointerSteps(c),t.effectPointer(0,"#pointStep","navStep"),t.changeTitleSubtitle(c)}else{var l=document.querySelector("#".concat(e.id)).querySelector("#step".concat(i)),s=Number(e.id.replace("cap",""));l.style="display: block",l.scrollTop=1,t.addJSCap(s,i),t.effectPointer(i,"#pointStep","navStep")}}else if(0===a.scrollTop&&("cap0"!==e.id||"step0"!==a.id)){var p=Number(o.id.replace("step",""))-1;if(a.style="display: none",p<0){var u=Number(e.id.replace("cap",""))-1,d=document.querySelector("#cap".concat(u));d.style="display: block";var y=document.querySelector("#cap".concat(u)).querySelector("#step".concat(d.childElementCount-1));y.style="display: block",y.scrollTop=10,document.querySelector("#".concat(e.id)).style="display: none",t.addJSCap(u,d.childElementCount-1),t.effectPointer(u,"#pointerNav","navPointer"),t.createPointerSteps(u),t.changeTitleSubtitle(u),t.effectPointer(d.childElementCount-1,"#pointStep","navStep")}else{var f=Number(e.id.replace("cap","")),h=document.querySelector("#".concat(e.id)).querySelector("#step".concat(p));h.style="display: block",h.scrollTop=10,t.addJSCap(f,p),t.effectPointer(p,"#pointStep","navStep")}}}))}))})),e}},{key:"addJSCap",value:function(e,t){try{document.querySelector("#storyMap_jsCap")&&document.body.removeChild(document.querySelector("#storyMap_jsCap"));var n=document.createElement("script");n.id="storyMap_jsCap";var o=document.createTextNode("{".concat(this.content_.cap[e].steps[t].js,"}"));n.appendChild(o),document.body.appendChild(n)}catch(e){console.warn('Comprueba que has introducido correctamente el script, respetando ";" y llamando a map o mapjs')}}},{key:"timeCap",value:function(){var e=this;return setInterval((function(){var t=e.capIndex("#cap".concat(e.capIndex("#contentStoryMap",".chapters")),".step"),n=document.querySelector("#cap".concat(e.capIndex("#contentStoryMap",".chapters"))).querySelector("#step".concat(t)),o=e.content_.cap.length-1,r=e.content_.cap[e.content_.cap.length-1].steps.length-1;"#cap".concat(e.capIndex("#contentStoryMap",".chapters"))==="#cap".concat(o)&&"#step".concat(t)==="#step".concat(r)||n.scroll({top:n.scrollHeight+10,behavior:"smooth"})}),1e3*document.querySelector("#buttonDelay").getAttribute("speed"))}},{key:"arrowScrollEffect",value:function(){var e=this;setTimeout((function(){e.arrowScrollEffect_contador-=.1,document.querySelector(".arrowScroll").style="opacity: ".concat(e.arrowScrollEffect_contador),e.arrowScrollEffect_contador>=0&&e.arrowScrollEffect()}),150),this.svgArrowScroll=!this.svgArrowScroll}},{key:"arrowEvent",value:function(e){return e.querySelector(".arrowScroll").addEventListener("mouseover",(function(e){document.querySelector("#cap0").querySelector("#step0").scroll({top:70,behavior:"smooth"})})),e}},{key:"effectPointer",value:function(e,t,n){document.querySelector(".".concat(n," .pointerEffect")).classList.remove("pointerEffect"),document.querySelector("".concat(t).concat(e," > circle")).classList.add("pointerEffect")}},{key:"createIndex",value:function(){var e=this.content_.cap,t="";return e.forEach((function(e,n){var o=e.title,r=void 0===o?"":o,a=e.subtitle,i=void 0===a?"":a;t+='<li index="'.concat(n+1,'">').concat(r,". ").concat(i,"</li>")})),t="<ol id='indexContent'>".concat(t,"</ol>")}},{key:"eventIndex",value:function(e){var t=this;return e.querySelectorAll("#indexContent > li").forEach((function(e,n){e.addEventListener("click",(function(e){var n=e.target;t.resetScroll(),t.disableCap(n.getAttribute("index"),t.capIndex("#contentStoryMap",".chapters"),!0),t.createPointerSteps(n.getAttribute("index")),t.effectPointer(n.getAttribute("index"),"#pointerNav","navPointer")}))})),e}},{key:"buttonDelay",value:function(e){var t=this,n=[{text:"0.5x",value:0},{text:"1x",value:1},{text:"2x",value:2},{text:"3x",value:3},{text:"5x",value:5}],o=0;return e.querySelector("#buttonDelay").addEventListener("click",(function(r){var a=r.target;t.allIntervalId.forEach((function(e){clearInterval(e)})),0!==(o=o>=n.length-1?0:o+1)?(a.style="width: 23px",a.setAttribute("speed",t.delay/1e3/n[o].value),document.querySelector("#navStep").style="margin-left: 5px;"):(a.setAttribute("speed",t.delay/1e3*(n[o].value+1.5)),a.style="width: 40px;",document.querySelector("#navStep").style="margin-left: -15px;"),a.innerHTML=n[o].text;var i=e.querySelector("#play"),c=e.querySelector("#pause");i.style.display="none",c.style.display="block";var l=setInterval((function(){var e=document.querySelector("#cap".concat(t.content_.cap.length-1)).lastChild.style.display,n=t.capIndex("#cap".concat(t.capIndex("#contentStoryMap",".chapters")),".step"),o=document.querySelector("#cap".concat(t.capIndex("#contentStoryMap",".chapters"))).querySelector("#step".concat(n)),r=t.content_.cap.length-1,a=t.content_.cap[t.content_.cap.length-1].steps.length-1;"#cap".concat(t.capIndex("#contentStoryMap",".chapters"))==="#cap".concat(r)&&"#step".concat(n)==="#step".concat(a)||o.scroll({top:o.scrollHeight+10,behavior:"smooth"}),"block"===e&&(i.style.display="block",c.style.display="none",clearInterval(l))}),1e3*a.getAttribute("speed"));t.allIntervalId.push(l)})),e}},{key:"activate",value:function(){w(k(t.prototype),"activate",this).call(this)}},{key:"deactivate",value:function(){w(k(t.prototype),"deactivate",this).call(this)}},{key:"getActivationButton",value:function(e){return e.querySelector(".m-storymap button")}},{key:"handleMovil",value:function(){document.querySelector(".m-plugin-storymap.opened")?document.querySelectorAll(".m-panel").forEach((function(e){e.classList.contains("m-plugin-storymap")||(e.style.display="none")})):document.querySelectorAll(".m-panel").forEach((function(e){e.classList.contains("m-plugin-storymap")||(e.style.display="block")}))}},{key:"equals",value:function(e){return e instanceof t}}])&&m(n.prototype,o),r&&m(n,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,o,r}(),_=n(4),I=n.n(_),j=n(0),E=n(1),C={en:j,es:E},O=function(){var e="es";return"function"==typeof M.language.getLang&&(e=M.language.getLang()),e},N=function(e){return"es"===e||"en"===e?C[e]:M.language.getTranslation(e).storymap},q=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O(),n=N(t),o="";return M.utils.isNullOrEmpty(n)?console.warn("The translation '".concat(t,"' has not been defined.")):o=e.split(".").reduce((function(e,t){return e[t]}),n),o};function A(e){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function L(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,H(o.key),o)}}function H(e){var t=function(e,t){if("object"!=A(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=A(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==A(t)?t:t+""}function z(e,t,n){return t=R(t),function(e,t){if(t&&("object"==A(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}()?Reflect.construct(t,n||[],R(e).constructor):t.apply(e,n))}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function B(e,t){return(B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Y=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return L(this,t),(e=z(this,t)).map_=null,e.controls_=[],e.position_=n.position||"TR",e.collapsed_=!0===n.collapsed,e.metadata_=o.metadata,e.tooltip_=n.tooltip||q("tooltip"),e.content_=n.content||{},e.delay=n.delay||2e3,e.collapsible=n.collapsible||!1,e.indexInContent=n.indexInContent||!1,e.options_=n,e.isDraggable=!M.utils.isUndefined(n.isDraggable)&&n.isDraggable,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&B(e,t)}(t,M.Plugin),n=t,a=[{key:"getJSONTranslations",value:function(e){return"en"===e||"es"===e?"en"===e?j:E:M.language.getTranslation(e).storymap}}],(r=[{key:"addTo",value:function(e){this.control=new P(this.content_[M.language.getLang()],this.delay,this.indexInContent,this.isDraggable),this.map_=e,window.map=e,window.mapjs=e,this.panel_=new M.ui.Panel("panelStoryMap",{collapsible:this.collapsible,position:M.ui.position[this.position_],collapsedButtonClass:"icon-capas2",className:"m-plugin-storymap",tooltip:this.tooltip_,collapsed:this.collapsed_}),this.panel_.addControls([this.control]),e.addPanels(this.panel_)}},{key:"position",get:function(){return this.position_}},{key:"name",get:function(){return"storymap"}},{key:"collapsed",get:function(){return this.panel_.isCollapsed()}},{key:"getAPIRest",value:function(){return"".concat(this.name,"=").concat(this.position,"*").concat(this.collapsed,"*").concat(this.tooltip,"*").concat(this.isDraggableE,"*")}},{key:"getAPIRestBase64",value:function(){return"".concat(this.name,"=base64=").concat(M.utils.encodeBase64(this.options_))}},{key:"equals",value:function(e){return e instanceof t}},{key:"getMetadata",value:function(){return this.metadata_}},{key:"destroy",value:function(){this.map_.removeControls(this.control);var e=[null,null,null];this.map_=e[0],this.control=e[1],this.panel_=e[2]}},{key:"getHelp",value:function(){return{title:this.name,content:new Promise((function(e){e(M.template.compileSync(I.a,{vars:{urlImages:"".concat(M.config.MAPEA_URL,"plugins/storymap/images/"),translations:{help1:q("textHelp.help1"),help2:q("textHelp.help2"),help3:q("textHelp.help3"),help4:q("textHelp.help4"),help5:q("textHelp.help5"),help6:q("textHelp.help6"),help7:q("textHelp.help7"),help8:q("textHelp.help8"),help9:q("textHelp.help9"),help10:q("textHelp.help10")}}}))}))}}}])&&D(n.prototype,r),a&&D(n,a),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,a}();window.M.plugin||(window.M.plugin={}),window.M.control||(window.M.control={}),window.M.plugin.StoryMap=Y,window.M.control.StoryMapControl=P}]);
//# sourceMappingURL=storymap-1.2.0.ol.min.js.map
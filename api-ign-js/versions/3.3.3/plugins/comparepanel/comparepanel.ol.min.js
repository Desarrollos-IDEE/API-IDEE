!function(e){var t={};function r(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(i,o,function(t){return e[t]}.bind(null,o));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=11)}([function(e){e.exports=JSON.parse('{"url":{"name":"comparepanel","separator":"*!"},"constructor":"M.plugin.Comparepanel","parameters":[{"type":"object","properties":[{"type":"simple","name":"position","possibleValues":["TL","TR","BL","BR"],"position":0},{"type":"simple","name":"intervals","position":1},{"type":"boolean","name":"animation","position":2},{"type":"simple","name":"speed","position":3}]}],"files":{"ol":{"scripts":["comparepanel.ol.min.js"],"styles":["comparepanel.ol.min.css"]}},"metadata":{"name":"Comparepanel","description":"Línea de tiempo por intervalos","text":"Plugin que permite mostrar la progresión del tiempo sobre un mapa","version":"1.0.0","date":"Junio, 2020","author":"","org":"Consejería de Hacienda, Industria y Energía. Junta de Andalucía.","tags":"mapea,plugin","icon":"./facade/assets/icons/icons.svg","centralized":true}}')},function(e,t){e.exports='<div id="div-contenedor" class="m-comparepanel-container">\r\n    <div id=\'m-cp-mirrorpanel\'>\r\n        <button class="cp-button cp-icon" title="{{translations.tooltipMirrorpanel}}"></button>\r\n    </div>\r\n    <div id=\'m-cp-lyrcompare\'>\r\n        <button class="cp-button cp-columns" title="{{translations.tooltipLyr}}"></button>\r\n    </div>\r\n    <div id=\'m-cp-timeline\'>\r\n        <button class="cp-button cp-gestion-reloj2" title="{{translations.tooltipTimeline}}"></button>\r\n    </div>\r\n    \r\n</div>\r\n'},function(e){e.exports=JSON.parse('{"tooltip":"Comparepanel","title":"Comparepanel","play":"Play","pause":"Pause","excepcion":"The implementation used cannot create comparepanelControl controls","intervals_error":"The intervals were not defined correctly","tooltipLyr":"Layer Comparison","tooltip_vcurtain":"Vertical curtain","tooltip_hcurtain":"Horizontal curtain","tooltip_multicurtain":"Multi curtain","layers":"Layehrs","radius":"Radius","opacity":"Opacity","static":"Static","dynamic":"Dynamic","mixed":"Mixed","layer":"Layer","opacity_tooltip":"Opacity of the layers (0-100%)","dynamic_tooltip":"Division between layers is fixed by mouse position","mixed_tooltip":"Division between layers is dragged by mouse","static_tooltip":"Division between layers is fixed 50%","lyrLeftSelect_tooltip":"Select layer on the left","lyrRightSelect_tooltip":"Select layer on the right","advice_sameLayer":"One layer in different places is not allowed","no_layers_plugin":"The number of layers is insufficient to apply the effect","repeated_layers":"Selected layers cannot be repeated","tooltipMirrorpanel":"Mirror Comparison","titleMirrorpanel":"Mirror Maps","modViz0":"Standard map","modViz1":"Vertical two maps","modViz2":"Horizontal two maps","modViz3":"Vertical three maps","modViz4":"Vertical four maps","modViz5":"Mosaic maps","modViz6":"Horizontal four maps","modViz7":"Vertical 2-1-1 proportional maps","modViz8":"One map above and two below","modViz9":"Two maps above and one below","backimglayersparams_undefined":"BackImgLayers\' parameters are not defined correctly.","tooltipTimeline":"Timeline","titleTimeline":"Timeline"}')},function(e){e.exports=JSON.parse('{"tooltip":"Panel de Comparadores","title":"Panel de Comparadores","play":"Iniciar","pause":"Parar","excepcion":"La implementación usada no puede crear controles ComparepanelControl","intervals_error":"Los intervalos no fueron definidos correctamente","tooltipLyr":"Comparador de capas","tooltip_vcurtain":"Cortina vertical","tooltip_hcurtain":"Cortina horizontal","tooltip_multicurtain":"Multivista","layers":"Capas","radius":"Radio","opacity":"Opacidad","static":"Estático","dynamic":"Dinámico","mixed":"Mixto","layer":"Capa","opacity_tooltip":"Opacidad de las capas que se comparan (0-100%)","dynamic_tooltip":"La división la marca la posición del cursor","mixed_tooltip":"La división se arrastra con el ratón","static_tooltip":"La división es fija en el centro del mapa","lyrLeftSelect_tooltip":"Selecciona la capa de la izquierda","lyrRightSelect_tooltip":"Selecciona la capa de la derecha","advice_sameLayer":"No puede cargarse la misma capa en varios sitios","no_layers_plugin":"El número de capas es insuficiente para aplicar el efecto","repeated_layers":"Las capas seleccionadas no se pueden repetir","tooltipMirrorpanel":"Comparador de mapas espejo","titleMirrorpanel":"Mapas espejo","modViz0":"Mapa standard","modViz1":"Dos mapas en vertical","modViz2":"Dos mapas en horizontal","modViz3":"Tres mapas en vertical","modViz4":"Cuatro mapas en vertical","modViz5":"Mosaico de mapas","modViz6":"Cuatro mapas en horizontal","modViz7":"Tres mapas en proporción 2-1-1","modViz8":"Un mapa arriba y dos abajo","modViz9":"Dos mapas arriba y uno abajo","backimglayersparams_undefined":"Los parámetros de BackImgLayers no están definidos correctamente.","tooltipTimeline":"Línea de tiempo","titleTimeline":"Línea de tiempo"}')},function(e,t){e.exports='<div id="div-contenedor" class="m-mirrorpanel-container">\r\n  <div class="div-m-mirrorpanel-panel">\r\n    <div class="m-mirrorpanel-effect-buttoms">\r\n      <button id="set-mirror-0" class="big-button" title="{{translations.modViz0}}"><i class="cp-modeviz0"></i></button>\r\n      <button id="set-mirror-1" class="big-button" title="{{translations.modViz1}}"><i class="cp-modeviz1"></i></button>\r\n      <button id="set-mirror-2" class="big-button" title="{{translations.modViz2}}"><i class="cp-modeviz2"></i></button>\r\n      <button id="set-mirror-3" class="big-button" title="{{translations.modViz3}}"><i class="cp-modeviz3"></i></button>\r\n      <button id="set-mirror-4" class="big-button" title="{{translations.modViz4}}"><i class="cp-modeviz4"></i></button>\r\n      <button id="set-mirror-5" class="big-button" title="{{translations.modViz5}}"><i class="cp-modeviz5"></i></button>\r\n      <button id="set-mirror-6" class="big-button" title="{{translations.modViz6}}"><i class="cp-modeviz6"></i></button>\r\n      <button id="set-mirror-7" class="big-button" title="{{translations.modViz7}}"><i class="cp-modeviz7"></i></button>\r\n      <button id="set-mirror-8" class="big-button" title="{{translations.modViz8}}"><i class="cp-modeviz8"></i></button>\r\n      <button id="set-mirror-9" class="big-button" title="{{translations.modViz9}}"><i class="cp-modeviz9"></i></button>\r\n    </div>\r\n    \r\n  </div>\r\n\r\n</div>\r\n'},function(e,t){e.exports='<div id="div-contenedor" class="m-timeline-container">\r\n    <div class="div-m-timeline-panel">\r\n        <div class="div-m-timeline-slider">\r\n            <input type="range" min="0" max="100" value="0" step="any" id="input-slider"></input>\r\n            <div class=\'slider-tags\'></div>\r\n        </div>\r\n        <div class="m-timeline-names">\r\n            \r\n        </div>\r\n        <div class="m-timeline-button">\r\n            <button id="m-timeline-play" class="cp-control-siguiente" title="Iniciar paso del tiempo"></button>\r\n        </div>\r\n    </div>\r\n</div>'},function(e,t){e.exports='<div id="div-contenedor" class="m-lyrcompare-container">\n    <div class="div-m-lyrcompare-panel">\n        <div class="m-lyrcompare-effect-buttoms">\n            <button id="m-lyrcompare-vcurtain" class="big-buttom" title="{{translations.tooltip_vcurtain}}"><i class="cp-columns"></i></button>\n            <button id="m-lyrcompare-hcurtain" class="big-buttom" title="{{translations.tooltip_hcurtain}}"><i class="cp-columns-rotate"></i></button>\n            <button id="m-lyrcompare-multicurtain" class="big-buttom" title="{{translations.tooltip_multicurtain}}"><i class="cp-th-large"></i></button>\n        </div>\n        <div class="div-m-lyrcompare-transparent-opacity">\n            <label for="input-transparent-opacity" title="{{translations.opacity_tooltip}}">{{translations.opacity}}: </label>\n            <input type="range" min="0" max="100" value="100" id="input-transparent-opacity" title="{{translations.opacity_tooltip}}"></input>\n        </div>\n        <div class="div-m-lyrcompare-transparent-static">\n            <input type="radio" id="div-m-lyrcompare-transparent-dynamic" name="staticDivision" value="0"><label for="div-m-lyrcompare-transparent-dynamic" title="{{translations.dynamic_tooltip}}">{{translations.dynamic}}</label>\n            <input type="radio" id="div-m-lyrcompare-transparent-static" name="staticDivision" value="1"><label for="div-m-lyrcompare-transparent-static" title="{{translations.static_tooltip}}">{{translations.static}}</label>\n            <input type="radio" id="div-m-lyrcompare-transparent-mixed" name="staticDivision" value="2"><label for="div-m-lyrcompare-transparent-mixed" title="{{translations.mixed_tooltip}}">{{translations.mixed}}</label>\n        </div>\n        <hr />\n        {{#if options}}\n            <div class="m-lyrcompare-select" id="m-lyrcompare-lyrA-cont">\n                <label id="m-lyrcompare-lyrA-lbl" for="m-lyrcompare-lyrA" title="{{translations.lyrLeftSelect_tooltip}}"></label>\n                <select disabled id="m-lyrcompare-lyrA">\n                    {{#each options}}\n                        <option value=\'{{this.name}}\'>{{this.legend}}</option>\n                    {{/each}}\n                </select>\n                <div class="m-lyrcompare-select_arrow"></div>\n            </div>\n            <div class="m-lyrcompare-select" id="m-lyrcompare-lyrB-cont">\n                <label id="m-lyrcompare-lyrB-lbl" for="m-lyrcompare-lyrB" title="{{translations.lyrRightSelect_tooltip}}"></label>\n                <select disabled id="m-lyrcompare-lyrB">\n                    {{#each options}}\n                        <option value=\'{{this.name}}\'>{{this.legend}}</option>\n                    {{/each}}\n                </select>\n                <div class="m-lyrcompare-select_arrow">\n                </div>\n            </div>\n            \x3c!--Multi Curtain--\x3e\n            <div class="m-lyrcompare-select" id="m-lyrcompare-lyrC-cont">\n                <label id="m-lyrcompare-lyrC-lbl" for="m-lyrcompare-lyrC" title="{{translations.lyrLeftSelect_tooltip}}"></label>\n                <select disabled id="m-lyrcompare-lyrC">\n                    {{#each options}}\n                        <option value=\'{{this.name}}\'>{{this.legend}}</option>\n                    {{/each}}\n                </select>\n                <div class="m-lyrcompare-select_arrow"></div>\n            </div>\n            <div class="m-lyrcompare-select" id="m-lyrcompare-lyrD-cont">\n                <label id="m-lyrcompare-lyrD-lbl" for="m-lyrcompare-lyrD" title="{{translations.lyrRightSelect_tooltip}}"></label>\n                <select disabled id="m-lyrcompare-lyrD">\n                    {{#each options}}\n                        <option value=\'{{this.name}}\'>{{this.legend}}</option>\n                    {{/each}}\n                </select>\n                <div class="m-lyrcompare-select_arrow">\n                </div>\n            </div>\n        {{/if}}\n    </div>\n</div>'},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){"use strict";r.r(t);r(7);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e,t,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n(this,l(t).apply(this,arguments))}var r,i,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(t,M.impl.Control),r=t,(i=[{key:"addTo",value:function(e,r){this.map=e,this.olMap=e.getMapImpl(),a(l(t.prototype),"addTo",this).call(this,e,r)}}])&&o(r.prototype,i),c&&o(r,c),t}(),p=r(1),u=r.n(p),y={en:r(2),es:r(3)},m=function(){var e="es";return"function"==typeof M.language.getLang&&(e=M.language.getLang()),e},d=function(e){return y[e]},f=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m(),r=d(t),i="";return M.utils.isNullOrEmpty(r)?console.warn("The translation '".concat(t,"' has not been defined.")):i=e.split(".").reduce((function(e,t){return e[t]}),r),i};r(8);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function b(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function g(e,t,r){return(g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function L(e,t){return(L=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var S=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),b(this,_(t).apply(this,arguments))}var r,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L(e,t)}(t,M.impl.Control),r=t,(i=[{key:"addTo",value:function(e,r){var i=this;e.getMapImpl().getInteractions().forEach((function(e){e instanceof ol.interaction.DoubleClickZoom&&(i.dblClickInteraction_=e)})),g(_(t.prototype),"addTo",this).call(this,e,r)}}])&&v(r.prototype,i),o&&v(r,o),t}(),w=r(4),C=r.n(w);function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function k(e,t){return!t||"object"!==O(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function j(e,t,r){return(j="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=V(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function V(e){return(V=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function B(e,t){return(B=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var D=function(e){function t(e){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),M.utils.isUndefined(S)&&M.exception("La implementación usada no puede crear controles CompareMirrorpanel");var i=new S;return(r=k(this,V(t).call(this,i,"Mirrorpanel"))).template=null,r.modeViz=e.modeViz,r.enabledPlugins=e.enabledPlugins,r.showCursors=e.showCursors,r.mapL={A:null,B:null,C:null,D:null},r.lyrCursor={A:null,B:null,C:null,D:null},r.featureLyrCursor={A:null,B:null,C:null,D:null},r.styleCursor=new M.style.Point({icon:{form:M.style.form.CIRCLE,fontsize:.5,radius:5,rotation:0,rotate:!1,offset:[0,0],color:"black",fill:"red",gradientcolor:"#088A85",opacity:.8}}),r.defaultBaseLyrs=e.defaultBaseLyrs,r.mirrorLayers=e.mirrorLayers,r.backImgLayersParams=e.backImgLayersParams,r.createMapContainers(),r}var r,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&B(e,t)}(t,M.Control),r=t,(i=[{key:"createView",value:function(e){var t=this;return M.template.compileSync||(M.template.compileSync=function(e,t){var r,i={};M.utils.isUndefined(t)||(i=M.utils.extends(i,t.vars),r=t.parseToHtml);var o=Handlebars.compile(e)(i);return!1!==r?M.utils.stringToHtml(o):o}),this.mapL.A=e,this.mirrorLayers.length>0&&(this.mapL.A.addLayers(this.mirrorLayers),this.mapL.A.getLayers().forEach((function(e){0!==e.zindex_&&e.setVisible(!1)})),this.mapL.A.addLayers(this.defaultBaseLyrs[0])),this.showCursors&&this.addLayerCursor("A"),new Promise((function(e,r){var i;i={jsonp:!0,vars:{translations:{title:f("titleMirrorpanel"),modViz0:f("modViz0"),modViz1:f("modViz1"),modViz2:f("modViz2"),modViz3:f("modViz3"),modViz4:f("modViz4"),modViz5:f("modViz5"),modViz6:f("modViz6"),modViz7:f("modViz7"),modViz8:f("modViz8"),modViz9:f("modViz9")}}},t.template=M.template.compileSync(C.a,i),t.template.querySelectorAll('button[id^="set-mirror-"]').forEach((function(e,r){e.addEventListener("click",(function(e){t.manageVisionPanelByCSSGrid(r)}))})),t.manageVisionPanelByCSSGrid(t.modeViz),e(t.template)}))}},{key:"activate",value:function(){j(V(t.prototype),"activate",this).call(this)}},{key:"deactivate",value:function(){this.manageVisionPanelByCSSGrid(0)}},{key:"copyBackImgLayersParams",value:function(e,t){var r=e.split("!!"),i=r[6].split(","),o=r[7].split(","),n=r[8].split(","),a=r[9].split(","),l=[];return a.forEach((function(e,t){var r=e.split("sumar");r=r.map((function(e){return new M.layer.WMTS(e)}));var a={id:i[t],title:o[t],preview:n[t],layers:r};l.push(a)})),{position:r[0],collapsible:"true"===r[1],collapsed:"true"===r[2],layerId:"A"===t?0:"B"===t?1:"C"==t?2:3,layerVisibility:"true"===r[3],columnsNumber:r[5],layerOpts:l}}},{key:"createMapContainers",value:function(){var e=document.createElement("div");e.id="lienzo",e.classList.add("mirrorpanel-grid");var t=document.getElementById("mapjs")||document.getElementById("map");document.body.insertBefore(e,t),t.classList.add("mirror1"),e.appendChild(t);var r=document.createElement("div");r.id="mapjsB",r.classList.add("mirror2"),e.appendChild(r);var i=document.createElement("div");i.id="mapjsC",i.classList.add("mirror3"),e.appendChild(i);var o=document.createElement("div");o.id="mapjsD",o.classList.add("mirror4"),e.appendChild(o)}},{key:"manageVisionPanelByCSSGrid",value:function(e){var t=this.modeViz;(document.getElementById("mapjs")||document.getElementById("map")).style.display="none",document.getElementById("mapjsB").style.display="none",document.getElementById("mapjsC").style.display="none",document.getElementById("mapjsD").style.display="none",this.template.querySelector("#set-mirror-"+t).classList.remove("buttom-pressed");for(var r=0;r<10;r++)document.getElementById("lienzo").classList.remove("modeViz"+r);document.getElementById("lienzo").classList.add("modeViz"+e),[1,2].includes(e)&&null==this.mapL.B&&this.createMapObjects("B"),[3,7,8,9].includes(e)&&(null==this.mapL.B&&this.createMapObjects("B"),null==this.mapL.C&&this.createMapObjects("C")),[4,5,6].includes(e)&&(null==this.mapL.B&&this.createMapObjects("B"),null==this.mapL.C&&this.createMapObjects("C"),null==this.mapL.D&&this.createMapObjects("D")),this.modeViz=e,this.template.querySelector("#set-mirror-"+e).classList.add("buttom-pressed"),this.map_.refresh(),null!==this.mapL.B&&this.mapL.B.refresh(),null!==this.mapL.C&&this.mapL.C.refresh(),null!==this.mapL.D&&this.mapL.D.refresh()}},{key:"createMapObjects",value:function(e){var t=this,r=null,i=null;this.enabledPlugins&&this.map_.getPlugins().forEach((function(o){o.metadata_&&("FullTOC"===o.metadata_.name&&(console.log(o),r=new M.plugin.FullTOC({http:o.http,https:o.https,precharged:o.precharged})),"backimglayer"===o.metadata_.name&&(i=new M.plugin.BackImgLayer(t.copyBackImgLayersParams(t.backImgLayersParams,e))))})),this.mapL[e]=M.map({container:"mapjs"+e,center:this.map_.getCenter(),projection:this.map_.getProjection().code+"*"+this.map_.getProjection().units,zoom:this.map_.getZoom()});var o=null;switch(e){case"B":this.defaultBaseLyrs[1]&&(o=this.defaultBaseLyrs[1]);break;case"C":this.defaultBaseLyrs[2]&&(o=this.defaultBaseLyrs[2]);break;case"D":this.defaultBaseLyrs[3]&&(o=this.defaultBaseLyrs[3]);break;default:o=this.map_.getLayers()[0].setMap(this)}this.mapL[e].addLayers(o),this.mapL[e].getMapImpl().setView(this.map_.getMapImpl().getView()),null!==r&&this.mapL[e].addPlugin(r),null!==i&&this.mapL[e].addPlugin(i),this.enabledPlugins&&this.mirrorLayers.length>0&&(this.mapL[e].addLayers(this.mirrorLayers),this.mapL[e].getLayers().forEach((function(e){0!==e.zindex_&&e.setVisible(!1)}))),this.showCursors&&this.addLayerCursor(e),this.mapL[e].refresh()}},{key:"addLayerCursor",value:function(e){var t=this;this.lyrCursor[e]=new M.layer.Vector({name:"Coordenadas centro "+e},{displayInLayerSwitcher:!1}),this.featureLyrCursor[e]=new M.Feature("Center"+e,{type:"Feature",properties:{},geometry:{type:"Point",coordinates:this.mapL[e].getCenter()}}),this.lyrCursor[e].addFeatures([this.featureLyrCursor[e]]),this.lyrCursor[e].setStyle(this.styleCursor),this.lyrCursor[e].setZIndex(5e3),this.mapL[e].addLayers(this.lyrCursor[e]),this.mapL[e].getMapImpl().on("pointermove",(function(r){t.lyrCursor[e].setVisible(!1),Object.keys(t.featureLyrCursor).forEach((function(i){i!=e&&null!==t.featureLyrCursor[i]&&(t.lyrCursor[i].setVisible(!0),t.featureLyrCursor[i].setGeometry({type:"Point",coordinates:r.coordinate}))}))}))}},{key:"removeMaps",value:function(){this.mapL.B=null,this.mapL.C=null,this.mapL.D=null}},{key:"destroyMapsContainer",value:function(){this.manageVisionPanelByCSSGrid(0),document.getElementById("mapjsB").remove(),document.getElementById("mapjsC").remove(),document.getElementById("mapjsD").remove();var e=document.getElementById("lienzo"),t=document.querySelector(".mirror1");e.parentElement.insertBefore(t,e),t.style.display="block",t.classList.remove("mirror1"),t.classList=this.oldClass,document.getElementById("lienzo").remove()}},{key:"equals",value:function(e){return e instanceof t}}])&&P(r.prototype,i),o&&P(r,o),t}(),q=r(0);function A(e){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function E(e,t){return!t||"object"!==A(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function z(e){return(z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var x=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=E(this,z(t).call(this))).name_="mirrorpanel",e.map_=null,e.controls_=[],e.className="m-plugin-mirrorpanel",e.position="TR",e.collapsed=!0,e.collapsible=!0,e.modeViz=r.modeViz,void 0===e.modeViz&&(e.modeViz=0),e.enabledPlugins=r.enabledPlugins,void 0===e.enabledPlugins&&(e.enabledPlugins=!0),e.enabledKeyFunctions=r.enabledKeyFunctions,void 0===e.enabledKeyFunctions&&(e.enabledKeyFunctions=!0),e.showCursors=r.showCursors,void 0===e.showCursors&&(e.showCursors=!0),e.mirrorLayers=[],void 0!==r.mirrorLayers&&(Array.isArray(r.mirrorLayers)?e.mirrorLayers=r.mirrorLayers:e.mirrorLayers=r.mirrorLayers.split(",")),e.defaultBaseLyrs=[],void 0!==r.defaultBaseLyrs&&(Array.isArray(r.defaultBaseLyrs)?e.defaultBaseLyrs=r.defaultBaseLyrs:e.defaultBaseLyrs=r.defaultBaseLyrs.split(",")),e.backImgLayersParams=r.backImgLayersParams,void 0!==r.backImgLayersParams&&M.utils.isObject(r.backImgLayersParams)){var i=new M.plugin.BackImgLayer(r.backImgLayersParams);e.backImgLayersParams=i.getAPIRest().replace("backimglayer=","").replace(/\*!/g,"!!")}return e.interface=void 0===r.interface||r.interface,e.tooltip_=r.tooltip||f("tooltip"),e.metadata_=q.metadata,e}var r,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}(t,M.Plugin),r=t,(i=[{key:"addTo",value:function(e){var t=this,r={pluginOnLeft:!!["TL","BL"].includes(this.position),collapsible:this.collapsible,collapsed:this.collapsed,modeViz:this.modeViz,enabledPlugins:this.enabledPlugins,showCursors:this.showCursors,mirrorLayers:this.mirrorLayers,defaultBaseLyrs:this.defaultBaseLyrs,backImgLayersParams:this.backImgLayersParams};this.control_=new D(r),this.controls_.push(this.control_),this.map_=e,this.panel_=new M.ui.Panel("panelMirrorpanel",{collapsible:this.collapsible,collapsed:this.collapsed,position:M.ui.position[this.position],modeViz:this.modeViz,enabledPlugins:this.enabledPlugins,showCursors:this.showCursors,className:this.interface?"m-plugin-panelMirrorpanel":"m-plugin-panelMirrorpanel hidden",collapsedButtonClass:"mirrorpanel-icon",tooltip:this.tooltip_}),this.panel_.addControls(this.controls_),e.addPanels(this.panel_),this.map_.getControls("BackImgLayer").length>0&&void 0===this.backImgLayersParams&&M.dialog.error(f("backimglayersparams_undefined")),document.addEventListener("keydown",(function(e){if(t.enabledKeyFunctions){for(var r=0;r<10;r++)e.ctrlKey&&e.shiftKey&&e.key==="F"+(r+1)&&t.control_.manageVisionPanelByCSSGrid(r);var i=["Control","Shift","Alt","Meta"].includes(e.key)?"":e.key;"Escape"==(e.ctrlKey?"Control ":"")+(e.shiftKey?"Shift ":"")+(e.altKey?"Alt ":"")+(e.metaKey?"Meta ":"")+i&&t.control_.manageVisionPanelByCSSGrid(0)}}))}},{key:"destroy",value:function(){document.removeEventListener("keydown",(function(e){})),this.control_.removeMaps(),this.control_.destroyMapsContainer(),this.map_.removeControls([this.control_]);var e=[null,null,null,null,null,null,null,null,null,null,null,null,null];this.control_=e[0],this.panel_=e[1],this.map_=e[2],this.collapsible=e[3],this.collapsed=e[4],this.modeViz=e[5],this.enabledPlugins=e[6],this.enabledKeyFunctions=e[7],this.showCursors=e[8],this.mirrorLayers=e[9],this.defaultBaseLyrs=e[10],this.backImgLayersParams=e[11],this.interface=e[12]}},{key:"getMetadata",value:function(){return this.metadata_}},{key:"getAPIRest",value:function(){return"".concat(this.name,"=").concat(this.position,"*!").concat(this.collapsed,"*!").concat(this.collapsible,"*!").concat(this.modeViz,"*!").concat(this.enabledPlugins,"*!").concat(this.enabledKeyFunctions,"*!").concat(this.showCursors,"*!").concat(this.mirrorLayers,"*!").concat(this.defaultBaseLyrs,"*!").concat(this.backImgLayersParams,"*!").concat(this.interface)}},{key:"activate",value:function(){this.control_.activate()}},{key:"deactivate",value:function(){this.control_.deactivate()}},{key:"name",get:function(){return this.name_}}])&&I(r.prototype,i),o&&I(r,o),t}();r(9);function R(e){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function F(e,t){return!t||"object"!==R(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function H(e,t,r){return(H="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=W(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function W(e){return(W=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function K(e,t){return(K=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var U=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),F(this,W(t).apply(this,arguments))}var r,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&K(e,t)}(t,M.impl.Control),r=t,(i=[{key:"addTo",value:function(e,r){this.map=e,this.olMap=e.getMapImpl(),H(W(t.prototype),"addTo",this).call(this,e,r)}}])&&N(r.prototype,i),o&&N(r,o),t}(),G=r(5),J=r.n(G);function Z(e){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Q(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function X(e,t){return!t||"object"!==Z(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Y(e){return(Y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $(e,t){return($=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ee=function(e){function t(e){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),M.utils.isUndefined(U)&&M.exception(f("exception"));var i=new U;return(r=X(this,Y(t).call(this,i,"Timeline"))).running=!1,r.animation=e.animation,r.speed=e.speed,r.intervals=e.intervals,r.template=null,r}var r,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$(e,t)}(t,M.Control),r=t,(i=[{key:"createView",value:function(e){var t=this;return this.map=e,new Promise((function(e,r){var i=[];t.intervals.forEach((function(e,r){var o=t.transformToLayers(e[2]),n=t.getMapLayer(o);void 0!==n&&t.map.removeLayers(n),t.map.addLayers(o);var a={number:r,name:e[0],tag:e[1],service:o};i.push(a)})),t.intervals=i,t.template=M.template.compileSync(J.a,{vars:{translations:{title:f("titleTimeline"),play:f("play")}}}),t.intervals.forEach((function(e,r){var i=document.createElement("div");0!=r&&r!=t.intervals.length-1&&r!=parseInt(t.intervals.length/2)?i.dataset.tag="":i.dataset.tag=e.tag,t.template.querySelector(".slider-tags").append(i)})),t.template.querySelector(".div-m-timeline-panel").style.setProperty("--num",t.intervals.length);var o=t.template.querySelector("#input-slider");o.setAttribute("max",i.length-1),o.addEventListener("input",(function(e){return t.changeSlider(o)})),o.addEventListener("change",(function(e){document.querySelector(".m-timeline-button button").classList.add("cp-control-siguiente"),document.querySelector(".m-timeline-button button").classList.remove("cp-control-pausa"),document.querySelector(".div-m-timeline-slider").style.setProperty("--opacity","0"),clearTimeout(t.running),t.running=!1})),t.template.querySelector("#m-timeline-play").addEventListener("click",(function(e){return t.playTimeline(!1)})),e(t.template)}))}},{key:"transformToLayers",value:function(e){var t=null;if(e instanceof Object){if(e instanceof Object){var r=this.map.getLayers().filter((function(t){return e.name.includes(t.name)}))[0];t=this.isValidLayer(r)?r:null}}else if(e.indexOf("*")>=0){var i=e.split("*");"WMS"==i[0].toUpperCase()?t=new M.layer.WMS({url:i[2],name:i[3]}):"WMTS"==i[0].toUpperCase()&&(t=new M.layer.WMTS({url:i[2],name:i[3]}))}else{var o=this.map.getLayers().filter((function(t){return e.includes(t.name)}))[0];t=this.isValidLayer(o)?o:null}if(null!==t)return t.displayInLayerSwitcher=!1,t.setVisible(!1),t;this.map.removeLayers(e)}},{key:"changeSlider",value:function(e){var t=this;document.querySelector(".div-m-timeline-slider").style.setProperty("--opacity","0");var r=(e.value-e.min)/(e.max-e.min)*246+5;document.querySelector(".div-m-timeline-slider").style.setProperty("--left",r+"px"),(this.animation||""!==this.intervals[0].name)&&(document.querySelector(".m-timeline-names").style.display="block"),this.animation&&(document.querySelector(".m-timeline-button").style.display="block");var i=parseFloat(e.value);this.intervals.forEach((function(e){t.getMapLayer(e.service).setVisible(!1),document.querySelector(".m-timeline-names").innerHTML=""})),i%1==0?(document.querySelector(".div-m-timeline-slider").style.setProperty("--left",r+20+"px"),this.getMapLayer(this.intervals[i].service).setVisible(!0),document.querySelector(".m-timeline-names").innerHTML=this.intervals[i].name,document.querySelector(".div-m-timeline-panel").style.setProperty("--valor",'"'+this.intervals[i].tag+'"'),""!==this.intervals[i].tag?document.querySelector(".div-m-timeline-slider").style.setProperty("--opacity","1"):document.querySelector(".div-m-timeline-slider").style.setProperty("--opacity","0")):(this.getMapLayer(this.intervals[parseInt(i)].service).setVisible(!0),this.getMapLayer(this.intervals[parseInt(i)+1].service).setVisible(!0),""!==this.intervals[parseInt(i)].tag&&""!==this.intervals[parseInt(i)+1].tag?(document.querySelector(".div-m-timeline-slider").style.setProperty("--left",r+"px"),document.querySelector(".div-m-timeline-slider").style.setProperty("--opacity","1"),document.querySelector(".div-m-timeline-panel").style.setProperty("--valor",'"'+this.intervals[parseInt(i)].tag+" - "+this.intervals[parseInt(i)+1].tag+'"'),document.querySelector(".m-timeline-names").innerHTML=this.intervals[parseInt(i)].name+" y "+this.intervals[parseInt(i)+1].name):""===this.intervals[parseInt(i)].tag&&""===this.intervals[parseInt(i)+1].tag?document.querySelector(".div-m-timeline-slider").style.setProperty("--opacity","0"):(document.querySelector(".div-m-timeline-slider").style.setProperty("--left",r+20+"px"),document.querySelector(".div-m-timeline-slider").style.setProperty("--opacity","10"),document.querySelector(".m-timeline-names").innerHTML=this.intervals[parseInt(i)].name+this.intervals[parseInt(i)+1].name,document.querySelector(".div-m-timeline-panel").style.setProperty("--valor",'"'+this.intervals[parseInt(i)].tag+this.intervals[parseInt(i)+1].tag+'"')))}},{key:"getMapLayer",value:function(e){return this.map.getLayers().filter((function(t){return t.getImpl().legend===e.getImpl().legend}))[0]}},{key:"playTimeline",value:function(e){var t=this,r=this.intervals.length-1,i=document.querySelector("#input-slider"),o=parseInt(i.value);if(this.running&&(document.querySelector(".m-timeline-button button").classList.add("cp-control-siguiente"),document.querySelector(".m-timeline-button button").classList.remove("cp-control-pausa"),clearTimeout(this.running)),!e){if(o>0&&o<r&&this.running)return void(this.running=!1);o>r&&(o=0)}if(o>=r)return i.value=0,void this.changeSlider(i);o<0&&(o=0),i.value=parseFloat(i.value)+1,this.changeSlider(i),document.querySelector(".m-timeline-button button").classList.remove("cp-control-siguiente"),document.querySelector(".m-timeline-button button").classList.add("cp-control-pausa"),this.running=setTimeout((function(e){return t.playTimeline(!0)}),1e3*this.speed)}},{key:"removeTimelineLayers",value:function(){var e=this;clearInterval(this.running),this.intervals.forEach((function(t){e.map.removeLayers(e.getMapLayer(t.service))}))}},{key:"activate",value:function(){this.control_.activate()}},{key:"deactivate",value:function(){var e=this;clearInterval(this.running),this.running=!1,document.querySelector(".m-timeline-button button").classList.add("cp-control-siguiente"),document.querySelector(".m-timeline-button button").classList.remove("cp-control-pausa"),this.intervals.forEach((function(t){e.getMapLayer(t.service).setVisible(!1)}))}},{key:"equals",value:function(e){return e instanceof t}}])&&Q(r.prototype,i),o&&Q(r,o),t}();function te(e){return(te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function re(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ie(e,t){return!t||"object"!==te(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function oe(e){return(oe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ne(e,t){return(ne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ae=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=ie(this,oe(t).call(this))).name_="timeline",e.map_=null,e.controls_=[],e.className="m-plugin-timeline",e.position="TR",void 0!==r&&(M.utils.isString(r.intervals)?e.intervals=JSON.parse(r.intervals.replace(/!!/g,"[").replace(/¡¡/g,"]")):M.utils.isArray(r.intervals)?e.intervals=r.intervals:M.dialog.error(f("intervals_error"))),e.animation=r.animation,void 0===e.animation&&(e.animation=!0),e.speed=parseFloat(r.speed)||1,e.metadata_=q.metadata,e.tooltip_=r.tooltip||f("tooltip"),e}var r,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ne(e,t)}(t,M.Plugin),r=t,(i=[{key:"addTo",value:function(e){this.control_=new ee({intervals:this.intervals,animation:this.animation,speed:this.speed}),this.controls_.push(this.control_),this.map_=e,this.panel_=new M.ui.Panel("panelTimeline",{collapsible:!0,position:M.ui.position[this.position],className:this.className,collapsedButtonClass:"timeline-gestion-reloj2",tooltip:this.tooltip_}),this.panel_.addControls(this.controls_),e.addPanels(this.panel_)}},{key:"destroy",value:function(){this.control_.removeTimelineLayers(),this.map_.removeControls([this.control_]);var e=[null,null,null,null,null];this.control_=e[0],this.panel_=e[1],this.map_=e[2],this.layers=e[3],this.radius=e[4]}},{key:"getMetadata",value:function(){return this.metadata_}},{key:"getAPIRest",value:function(){var e=JSON.stringify(this.intervals).replace(/\[/g,"!!").replace(/\]/g,"¡¡");return"".concat(this.name,"=").concat(this.position,"*!").concat(e,"*!").concat(this.animation,"*!").concat(this.speed)}},{key:"activate",value:function(){this.control_.activate()}},{key:"deactivate",value:function(){this.control_.deactivate()}},{key:"equals",value:function(e){return e instanceof t}},{key:"name",get:function(){return this.name_}}])&&re(r.prototype,i),o&&re(r,o),t}();r(10);function le(e){return(le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function se(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ce(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pe(e,t,r){return(pe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ue(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function ue(e){return(ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ye(e,t){return(ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var me=function(e){function t(e){var r,i,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,o=ue(t).call(this,e),(r=!o||"object"!==le(o)&&"function"!=typeof o?ce(i):o).layers_=[],r.swipeClicked=!1,ol.interaction.Pointer.call(ce(r),{handleDownEvent:r.setPosition,handleUpEvent:function(){return r.swipeClicked=!1},handleMoveEvent:r.setPosition});var n=e||{};r.pos=!1,r.opacityVal=n.opacityVal||100;var a=[n.lyrA].map((function(e){return e.getImpl().getOL3Layer()})).filter((function(e){return null!=e}));r.addLayerA(a);var l=[n.lyrB].map((function(e){return e.getImpl().getOL3Layer()})).filter((function(e){return null!=e}));if(r.addLayerB(l),void 0!==n.lyrC&&void 0!==n.lyrD){var s=[n.lyrC].map((function(e){return e.getImpl().getOL3Layer()})).filter((function(e){return null!=e}));r.addLayerC(s);var c=[n.lyrD].map((function(e){return e.getImpl().getOL3Layer()})).filter((function(e){return null!=e}));r.addLayerD(c)}return r}var r,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ye(e,t)}(t,ol.interaction.Pointer),r=t,(i=[{key:"setMap",value:function(e){if(this.getMap()){for(var t=0;t<this.layers_.length;t+=1)this.layers_[t].precompose&&ol.Observable.unByKey(this.layers_[t].precompose),this.layers_[t].postcompose&&ol.Observable.unByKey(this.layers_[t].postcompose),this.layers_[t].precompose=this.layers_[t].postcompose=null;this.getMap().renderSync()}ol.interaction.Pointer.prototype.setMap.call(this,e),e&&(this.createSwipeControl(),this.layers_[0].precompose=this.layers_[0].on("precompose",this.precomposeA_.bind(this)),this.layers_[0].postcompose=this.layers_[0].on("postcompose",this.postcomposeA_.bind(this)),this.layers_[1].precompose=this.layers_[1].on("precompose",this.precomposeB_.bind(this)),this.layers_[1].postcompose=this.layers_[1].on("postcompose",this.postcomposeB_.bind(this)),void 0!==this.layers_[2]&&void 0!==this.layers_[3]&&(this.layers_[2].precompose=this.layers_[2].on("precompose",this.precomposeC_.bind(this)),this.layers_[2].postcompose=this.layers_[2].on("postcompose",this.postcomposeC_.bind(this)),this.layers_[3].precompose=this.layers_[3].on("precompose",this.precomposeD_.bind(this)),this.layers_[3].postcompose=this.layers_[3].on("postcompose",this.postcomposeD_.bind(this))),e.renderSync())}},{key:"setOpacity",value:function(e){if(this.opacityVal=e,this.getMap())for(var t=0;t<this.layers_.length;t+=1)this.layers_[t].setOpacity(this.opacityVal/100)}},{key:"setStaticDivision",value:function(e){this.staticDivision=e,this.updatePosition()}},{key:"setComparisonMode",value:function(e){this.comparisonMode=e,this.updatePosition()}},{key:"setVisibilityLayersCD",value:function(){void 0===this.layers_[2]||void 0===this.layers_[3]||1!==this.comparisonMode&&2!==this.comparisonMode?void 0!==this.layers_[2]&&void 0!==this.layers_[3]&&(this.layers_[2].setVisible(!0),this.layers_[3].setVisible(!0)):(this.layers_[2].setVisible(!1),this.layers_[3].setVisible(!1))}},{key:"addLayerA",value:function(e){e instanceof Array||(e=[e]);var t={layer:e[0]};this.getMap()&&(t.precompose=e[0].on("precompose",this.precomposeA_.bind(this)),t.postcompose=e[0].on("postcompose",this.postcomposeA_.bind(this)),this.getMap().renderSync()),this.layers_.push(e[0])}},{key:"addLayerB",value:function(e){e instanceof Array||(e=[e]);var t={layer:e[0]};this.getMap()&&(t.precompose=e[0].on("precompose",this.precomposeB_.bind(this)),t.postcompose=e[0].on("postcompose",this.postcomposeB_.bind(this)),this.getMap().renderSync()),this.layers_.push(e[0])}},{key:"addLayerC",value:function(e){e instanceof Array||(e=[e]);var t={layer:e[0]};this.getMap()&&(t.precompose=e[0].on("precompose",this.precomposeC_.bind(this)),t.postcompose=e[0].on("postcompose",this.postcomposeC_.bind(this)),this.getMap().renderSync()),this.layers_.push(e[0])}},{key:"addLayerD",value:function(e){e instanceof Array||(e=[e]);var t={layer:e[0]};this.getMap()&&(t.precompose=e[0].on("precompose",this.precomposeD_.bind(this)),t.postcompose=e[0].on("postcompose",this.postcomposeD_.bind(this)),this.getMap().renderSync()),this.layers_.push(e[0])}},{key:"removeLayer",value:function(e){e instanceof Array||(e=[e]);for(var t=0;t<e.length;t+=1){var r=void 0;for(r=0;r<this.layers_.length&&this.layers_[r]!==e[t];r+=1);r!==this.layers_.length&&this.getMap()&&(this.layers_[r].precompose&&ol.Observable.unByKey(this.layers_[r].precompose),this.layers_[r].postcompose&&ol.Observable.unByKey(this.layers_[r].postcompose),this.layers_.splice(r,1),this.getMap().renderSync())}}},{key:"setPosition",value:function(e){if(2===this.staticDivision&&this.swipeClicked||2!==this.staticDivision){if(e.pixel?this.pos=e.pixel:e&&e instanceof Array?this.pos=e:e=[-1e7,-1e7],2===this.staticDivision&&1!==e.pointerEvent.buttons){var t=this.map_.getSize();this.pos=[t[0]/2,t[1]/2],this.swipeClicked=!1}this.getMap()&&this.getMap().renderSync(),this.moveSwipeControl()}}},{key:"updatePosition",value:function(){var e=document.querySelector(".lyrcompare-swipe-control");if(e&&(1==this.comparisonMode?e.classList="lyrcompare-swipe-control vertical"+(1==this.staticDivision?" static":" dynamic"):2==this.comparisonMode?e.classList="lyrcompare-swipe-control horizontal"+(1==this.staticDivision?" static":" dynamic"):3==this.comparisonMode&&(e.classList="lyrcompare-swipe-control vertical horizontal"+(1==this.staticDivision?" static":" dynamic"))),this.getMap()){var t=this.map_.getSize();e.style.left=t[0]/2-e.offsetWidth/2+"px",e.style.top=t[1]/2-e.offsetHeight/2+"px",this.pos=[t[0]/2,t[1]/2],this.swipeClicked=!1,this.getMap().renderSync()}}},{key:"precomposeA_",value:function(e){var t=e.context,r=e.frameState.pixelRatio,i=this.map_.getSize();t.save(),t.beginPath(),1==this.staticDivision?1==this.comparisonMode?t.rect(0,0,i[0]/2*r-0*r,i[1]):2==this.comparisonMode?t.rect(0,0,i[0],i[1]*r/2-0*r):3==this.comparisonMode&&t.rect(0,0,i[0]/2*r-0*r,i[1]/2):1==this.comparisonMode?t.rect(0,0,this.pos[0]-0*r,i[1]):2==this.comparisonMode?t.rect(0,0,t.canvas.width,this.pos[1]*r-0*r):3==this.comparisonMode&&t.rect(0,0,this.pos[0]-0*r,this.pos[1]-0*r),t.clip()}},{key:"postcomposeA_",value:function(e){e.context.restore()}},{key:"precomposeB_",value:function(e){var t=e.context,r=e.frameState.pixelRatio,i=this.map_.getSize();t.save(),t.beginPath(),1==this.staticDivision?1==this.comparisonMode?t.rect(i[0]*r/2+0*r,0,t.canvas.width-i[0]*r/2,i[1]):2==this.comparisonMode?t.rect(0,i[1]*r/2+0*r,t.canvas.width,t.canvas.height-i[1]*r/2):3==this.comparisonMode&&t.rect(i[0]*r/2,0,t.canvas.width-i[0]*r/2,i[1]/2):1==this.comparisonMode?t.rect(this.pos[0],0,i[0]-this.pos[0],i[1]):2==this.comparisonMode?t.rect(0,this.pos[1],t.canvas.width,t.canvas.height-this.pos[1]):3==this.comparisonMode&&t.rect(this.pos[0],0,i[0]-this.pos[0],this.pos[1]),t.clip()}},{key:"postcomposeB_",value:function(e){e.context.restore()}},{key:"precomposeC_",value:function(e){var t=e.context,r=e.frameState.pixelRatio,i=this.map_.getSize();t.save(),t.beginPath(),1==this.staticDivision?3==this.comparisonMode&&t.rect(0,i[1]*r/2,i[0]/2*r-0*r,i[1]):3==this.comparisonMode&&t.rect(0,this.pos[1]*r,this.pos[0]*r-0*r,(i[1]-this.pos[1])*r-0*r),t.clip()}},{key:"postcomposeC_",value:function(e){e.context.restore()}},{key:"precomposeD_",value:function(e){var t=e.context,r=e.frameState.pixelRatio,i=this.map_.getSize();t.save(),t.beginPath(),1==this.staticDivision?3==this.comparisonMode&&t.rect(i[0]*r/2,i[1]*r/2,t.canvas.width*r/2-0*r,t.canvas.height*r/2-0*r):3==this.comparisonMode&&t.rect(this.pos[0]*r,this.pos[1]*r,(t.canvas.width-this.pos[0])*r-0*r,(t.canvas.height-this.pos[1])*r-0*r),t.clip()}},{key:"postcomposeD_",value:function(e){e.context.restore()}},{key:"createSwipeControl",value:function(){var e,t,r=this;null==document.querySelector(".lyrcompare-swipe-control")?((e=document.createElement("div")).classList.add("lyrcompare-swipe-control"),(t=document.createElement("div")).classList.add("control-icon"),e.append(t),document.querySelector(".ol-overlaycontainer-stopevent").append(e)):(e=document.querySelector(".lyrcompare-swipe-control"),t=document.querySelector(".lyrcompare-swipe-control .control-icon")),e.addEventListener("mousedown",(function(){return r.swipeClicked=!0})),e.addEventListener("mouseup",(function(){return r.swipeClicked=!1})),e.addEventListener("touchstart",(function(){return r.swipeClicked=!0})),e.addEventListener("touchend",(function(){return r.swipeClicked=!1})),this.updatePosition()}},{key:"moveSwipeControl",value:function(){var e=this.map_.getSize(),t=document.querySelector(".lyrcompare-swipe-control");t&&this.getMap()&&(0==this.staticDivision||2==this.staticDivision?1==this.comparisonMode?(t.style.top=e[1]/2-t.offsetHeight/2+"px",t.style.left=this.pos[0]-t.offsetWidth/2+"px"):2==this.comparisonMode?(t.style.left=e[0]/2-t.offsetWidth/2+"px",t.style.top=this.pos[1]-t.offsetHeight/2+"px"):3==this.comparisonMode&&(t.style.left=this.pos[0]-t.offsetWidth/2+"px",t.style.top=this.pos[1]-t.offsetHeight/2+"px"):(t.style.left=e[0]/2-t.offsetWidth/2+"px",t.style.top=e[1]/2-t.offsetHeight/2+"px"))}},{key:"setActive",value:function(e){pe(ue(t.prototype),"setActive",this).call(this,e)}}])&&se(r.prototype,i),o&&se(r,o),t}();function de(e){return(de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fe(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function he(e,t){return!t||"object"!==de(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ve(e,t,r){return(ve="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=be(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function be(e){return(be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ge(e,t){return(ge=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _e=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),he(this,be(t).apply(this,arguments))}var r,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ge(e,t)}(t,M.impl.Control),r=t,(i=[{key:"addTo",value:function(e,r){this.map=e,this.olMap=e.getMapImpl(),ve(be(t.prototype),"addTo",this).call(this,e,r)}},{key:"effectSelectedCurtain",value:function(e,t,r,i,o,n,a){e.setVisible(!0),t.setVisible(!0),this.transparentInteraction_=new me({opacityVal:o,lyrA:e,lyrB:t,lyrC:r,lyrD:i}),this.olMap.addInteraction(this.transparentInteraction_),this.setOpacity(o),this.setComparisonMode(a),this.setStaticDivision(n)}},{key:"setVisibilityLayersCD",value:function(){void 0!==this.transparentInteraction_&&this.transparentInteraction_.setVisibilityLayersCD()}},{key:"setOpacity",value:function(e){void 0!==this.transparentInteraction_&&this.transparentInteraction_.setOpacity(e)}},{key:"setComparisonMode",value:function(e){void 0!==this.transparentInteraction_&&this.transparentInteraction_.setComparisonMode(e),this.setVisibilityLayersCD()}},{key:"setStaticDivision",value:function(e){void 0!==this.transparentInteraction_&&this.transparentInteraction_.setStaticDivision(e)}},{key:"addLayer",value:function(e){this.transparentInteraction_.addLayer(e.getImpl().getOL3Layer())}},{key:"removeEffectsCurtain",value:function(){this.olMap.removeInteraction(this.transparentInteraction_)}},{key:"removeLayer",value:function(e){this.transparentInteraction_.removeLayer(e.getImpl().getOL3Layer())}}])&&fe(r.prototype,i),o&&fe(r,o),t}(),Le=r(6),Se=r.n(Le);function we(e){return(we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Me(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ce(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Oe(e,t){return!t||"object"!==we(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pe(e){return(Pe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ke(e,t){return(ke=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Array.prototype.unique=function(e){return function(){return this.filter(e)}}((function(e,t,r){return r.indexOf(e,t+1)<0}));var je=function(e){function t(e){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),M.utils.isUndefined(_e)&&M.exception("La implementación usada no puede crear controles LyrCompareControl");var i=new _e;return(r=Oe(this,Pe(t).call(this,i,"LyrCompare"))).layers=e.layers,r.opacityVal=e.opacityVal,r.layerSelectedA=null,r.layerSelectedB=null,r.layerSelectedC=null,r.layerSelectedD=null,r.template=null,r.staticDivision=e.staticDivision,r.opacityVal=e.opacityVal,r.comparisonMode=e.comparisonMode,r.defaultLyrA=e.defaultLyrA,r.defaultLyrB=e.defaultLyrB,r.defaultLyrC=e.defaultLyrC,r.defaultLyrD=e.defaultLyrD,r.interface=e.interface,r}var r,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ke(e,t)}(t,M.Control),r=t,(i=[{key:"createView",value:function(e){var t=this;return(!1===this.interface||this.comparisonMode>0)&&this.on(M.evt.ADDED_TO_MAP,(function(e){t.activateCurtain()})),this.map=e,new Promise((function(e,r){if(t.layers=t.transformToLayers(t.layers),t.layers.length>=2){3===t.comparisonMode&&t.layers.length<4&&(M.dialog.error(f("no_layers_plugin"),"lyrcompare"),t.comparisonMode=0);var i=t.allLayerLoad();if(i)t.setFunctionsAndCompile(e);else var o=setInterval((function(){(i=t.allLayerLoad())&&(clearInterval(o),t.setFunctionsAndCompile(e))}),200)}else M.dialog.error(f("no_layers_plugin"),"lyrcompare")}))}},{key:"setFunctionsAndCompile",value:function(e){var t=this,r={jsonp:!0,vars:{options:this.layers.map((function(e){return e instanceof Object?{name:e.name,legend:e.legend}:{name:e,legend:e}})),comparisonMode:this.comparisonMode,translations:{tooltip_vcurtain:f("tooltip_vcurtain"),tooltip_hcurtain:f("tooltip_hcurtain"),tooltip_multicurtain:f("tooltip_multicurtain"),opacity:f("opacity"),static:f("static"),dynamic:f("dynamic"),mixed:f("mixed"),layer:f("layer"),opacity_tooltip:f("opacity_tooltip"),static_tooltip:f("static_tooltip"),dynamic_tooltip:f("dynamic_tooltip"),mixed_tooltip:f("mixed_tooltip"),lyrLeftSelect_tooltip:f("lyrLeftSelect_tooltip"),lyrRightSelect_tooltip:f("lyrRightSelect_tooltip")}}};return Handlebars.registerHelper("ifCond",(function(e,t,r){return e===t?r.fn(this):r.inverse(this)})),this.template=M.template.compileSync(Se.a,r),this.setEventsAndValues(),this.updateControls(),0==this.layers.length?M.dialog.error(f("no_layers_plugin")):this.template.querySelectorAll('button[id^="m-lyrcompare-"]').forEach((function(e,r){e.addEventListener("click",(function(e){return 0===t.comparisonMode?(t.comparisonMode=r+1,void t.activateCurtain()):t.comparisonMode===r+1?(t.comparisonMode=0,void t.deactivateCurtain()):(t.comparisonMode=r+1,t.updateControls(),void t.getImpl().setComparisonMode(t.comparisonMode))}))})),e(this.template)}},{key:"setEventsAndValues",value:function(){var e=this;this.template.querySelector("#input-transparent-opacity").value=this.opacityVal,this.template.querySelector("#input-transparent-opacity").addEventListener("input",(function(t){e.opacityVal=Number(t.target.value),e.getImpl().setOpacity(e.opacityVal)})),1===this.staticDivision?this.template.querySelector("#div-m-lyrcompare-transparent-static").checked=!0:0===this.staticDivision?this.template.querySelector("#div-m-lyrcompare-transparent-dynamic").checked=!0:this.template.querySelector("#div-m-lyrcompare-transparent-mixed").checked=!0,this.template.querySelector("#div-m-lyrcompare-transparent-dynamic").addEventListener("change",(function(t){e.staticDivision=Number(t.target.value),e.getImpl().setStaticDivision(e.staticDivision)})),this.template.querySelector("#div-m-lyrcompare-transparent-static").addEventListener("change",(function(t){e.staticDivision=Number(t.target.value),e.getImpl().setStaticDivision(e.staticDivision)})),this.template.querySelector("#div-m-lyrcompare-transparent-mixed").addEventListener("change",(function(t){e.staticDivision=Number(t.target.value),e.getImpl().setStaticDivision(e.staticDivision)})),this.template.querySelectorAll('select[id^="m-lyrcompare-"]').forEach((function(t){t.addEventListener("change",(function(r){var i=e.layers.filter((function(e){return e.name===r.target.value})),o=[];if("m-lyrcompare-lyrA"===t.id?o=[i[0].name,e.layerSelectedB.name,e.layerSelectedC.name,e.layerSelectedD.name]:"m-lyrcompare-lyrB"===t.id?o=[e.layerSelectedA.name,i[0].name,e.layerSelectedC.name,e.layerSelectedD.name]:"m-lyrcompare-lyrC"===t.id?o=[e.layerSelectedA.name,e.layerSelectedB.name,i[0].name,e.layerSelectedD.name]:"m-lyrcompare-lyrD"===t.id&&(o=[e.layerSelectedA.name,e.layerSelectedB.name,e.layerSelectedC.name,i[0].name]),!1===e.checkLayersAreDifferent.apply(e,Me(o)))return M.dialog.info(f("advice_sameLayer")),"m-lyrcompare-lyrA"===t.id?e.template.querySelector("#"+t.id).value=e.layerSelectedA.name:"m-lyrcompare-lyrB"===t.id?e.template.querySelector("#"+t.id).value=e.layerSelectedB.name:"m-lyrcompare-lyrC"===t.id?e.template.querySelector("#"+t.id).value=e.layerSelectedC.name:"m-lyrcompare-lyrD"===t.id&&(e.template.querySelector("#"+t.id).value=e.layerSelectedD.name),!1;"m-lyrcompare-lyrA"===t.id?(i[0].name===e.layerSelectedC.name&&(e.layerSelectedC.setVisible(!1),e.layerSelectedC=e.layerSelectedA,e.template.querySelector("#m-lyrcompare-lyrC").value=e.layerSelectedA.name),i[0].name===e.layerSelectedD.name&&(e.layerSelectedD.setVisible(!1),e.layerSelectedD=e.layerSelectedA,e.template.querySelector("#m-lyrcompare-lyrD").value=e.layerSelectedA.name)):"m-lyrcompare-lyrB"===t.id&&(i[0].name===e.layerSelectedC.name&&(e.layerSelectedC.setVisible(!1),e.layerSelectedC=e.layerSelectedB,e.template.querySelector("#m-lyrcompare-lyrC").value=e.layerSelectedB.name),i[0].name===e.layerSelectedD.name&&(e.layerSelectedD.setVisible(!1),e.layerSelectedD=e.layerSelectedB,e.template.querySelector("#m-lyrcompare-lyrD").value=e.layerSelectedB.name)),"m-lyrcompare-lyrA"===t.id?(e.layerSelectedA.setVisible(!1),e.layerSelectedA=i[0]):"m-lyrcompare-lyrB"===t.id?(e.layerSelectedB.setVisible(!1),e.layerSelectedB=i[0]):"m-lyrcompare-lyrC"===t.id?(e.layerSelectedC.setVisible(!1),e.layerSelectedC=i[0]):"m-lyrcompare-lyrD"===t.id&&(e.layerSelectedD.setVisible(!1),e.layerSelectedD=i[0]),e.removeEffectsComparison(),e.getImpl().effectSelectedCurtain(e.layerSelectedA,e.layerSelectedB,e.layerSelectedC,e.layerSelectedD,e.opacityVal,e.staticDivision,e.comparisonMode)}))}))}},{key:"checkLayersAreDifferent",value:function(e,t,r,i){if(1===this.comparisonMode||2===this.comparisonMode){if(e===t)return!1}else{var o=[e,t,r,i];if(o.length!==o.unique().length)return!1}return!0}},{key:"activateCurtain",value:function(){this.activeDefault(),this.getImpl().effectSelectedCurtain(this.layerSelectedA,this.layerSelectedB,this.layerSelectedC,this.layerSelectedD,this.opacityVal,this.staticDivision,this.comparisonMode),this.updateControls()}},{key:"activeDefault",value:function(){null===this.layerSelectedA&&(this.layerSelectedA=this.layers[this.defaultLyrA],this.template.querySelector("#m-lyrcompare-lyrA").selectedIndex=this.defaultLyrA),null===this.layerSelectedB&&(this.layerSelectedB=this.layers[this.defaultLyrB],this.template.querySelector("#m-lyrcompare-lyrB").selectedIndex=this.defaultLyrB),null===this.layerSelectedC&&(this.layerSelectedC=this.layers[this.defaultLyrC],this.template.querySelector("#m-lyrcompare-lyrC").selectedIndex=this.defaultLyrC),null===this.layerSelectedD&&(this.layerSelectedD=this.layers[this.defaultLyrD],this.template.querySelector("#m-lyrcompare-lyrD").selectedIndex=this.defaultLyrD)}},{key:"deactivateCurtain",value:function(){var e=document.querySelector(".lyrcompare-swipe-control");e&&(e.classList.display="none !important"),this.comparisonMode=0,null!==this.layerSelectedA&&null!==this.layerSelectedB&&(this.layerSelectedA.setVisible(!1),this.layerSelectedB.setVisible(!1)),null!==this.layerSelectedC&&null!==this.layerSelectedD&&void 0!==this.layerSelectedC&&void 0!==this.layerSelectedD&&(this.layerSelectedC.setVisible(!1),this.layerSelectedD.setVisible(!1)),this.removeEffectsComparison(),this.updateControls()}},{key:"removeEffectsComparison",value:function(){this.getImpl().removeEffectsCurtain()}},{key:"updateControls",value:function(){this.removeActivate(),this.activateByMode();var e=document.querySelector(".lyrcompare-swipe-control");if(0==this.comparisonMode)return this.template.querySelectorAll('select[id^="m-lyrcompare-"]').forEach((function(e){e.disabled=!0})),void(this.template.querySelector("input").disabled=!0);1===this.comparisonMode?(e&&(e.style.opacity="1"),this.template.querySelector("#m-lyrcompare-lyrA-lbl").classList.add("cp-columns-2"),this.template.querySelector("#m-lyrcompare-lyrB-lbl").classList.add("cp-columns-1"),this.template.querySelector("#m-lyrcompare-lyrA-cont").style.display="block",this.template.querySelector("#m-lyrcompare-lyrB-cont").style.display="block",this.template.querySelector("#m-lyrcompare-lyrA").disabled=!1,this.template.querySelector("#m-lyrcompare-lyrB").disabled=!1):2===this.comparisonMode?(e&&(e.style.opacity="1"),this.template.querySelector("#m-lyrcompare-lyrA-lbl").classList.add("cp-columns-4"),this.template.querySelector("#m-lyrcompare-lyrB-lbl").classList.add("cp-columns-3"),this.template.querySelector("#m-lyrcompare-lyrA-cont").style.display="block",this.template.querySelector("#m-lyrcompare-lyrB-cont").style.display="block",this.template.querySelector("#m-lyrcompare-lyrA").disabled=!1,this.template.querySelector("#m-lyrcompare-lyrB").disabled=!1):3===this.comparisonMode&&(e&&(e.style.opacity="1"),this.template.querySelectorAll('select[id^="m-lyrcompare-"]').forEach((function(e){e.disabled=!1})),this.template.querySelector("#m-lyrcompare-lyrA-lbl").classList.add("cp-th-large-1"),this.template.querySelector("#m-lyrcompare-lyrB-lbl").classList.add("cp-th-large-2"),this.template.querySelector("#m-lyrcompare-lyrC-lbl").classList.add("cp-th-large-3"),this.template.querySelector("#m-lyrcompare-lyrD-lbl").classList.add("cp-th-large-4"),this.template.querySelector("#m-lyrcompare-lyrA-cont").style.display="block",this.template.querySelector("#m-lyrcompare-lyrB-cont").style.display="block",this.template.querySelector("#m-lyrcompare-lyrC-cont").style.display="block",this.template.querySelector("#m-lyrcompare-lyrD-cont").style.display="block"),this.template.querySelector("input").disabled=!1}},{key:"activateByMode",value:function(){1===this.comparisonMode?this.template.querySelector("#m-lyrcompare-vcurtain").classList.add("buttom-pressed-vcurtain"):2===this.comparisonMode?this.template.querySelector("#m-lyrcompare-hcurtain").classList.add("buttom-pressed-hcurtain"):3===this.comparisonMode&&this.template.querySelector("#m-lyrcompare-multicurtain").classList.add("buttom-pressed-multicurtain")}},{key:"removeActivate",value:function(){this.template.querySelector("#m-lyrcompare-vcurtain").classList.remove("buttom-pressed-vcurtain"),this.template.querySelector("#m-lyrcompare-hcurtain").classList.remove("buttom-pressed-hcurtain"),this.template.querySelector("#m-lyrcompare-multicurtain").classList.remove("buttom-pressed-multicurtain"),this.template.querySelectorAll('select[id^="m-lyrcompare-"]').disabled=!0,this.template.querySelector("#m-lyrcompare-lyrA-cont").style.display="none",this.template.querySelector("#m-lyrcompare-lyrB-cont").style.display="none",this.template.querySelector("#m-lyrcompare-lyrC-cont").style.display="none",this.template.querySelector("#m-lyrcompare-lyrD-cont").style.display="none",this.template.querySelector("#m-lyrcompare-lyrA-lbl").classList="",this.template.querySelector("#m-lyrcompare-lyrB-lbl").classList="";var e=document.querySelector(".lyrcompare-swipe-control");e&&(e.style.opacity="0")}},{key:"removeCurtainLayers",value:function(e){var t=this;e.forEach((function(e){if(e instanceof Object){if(e instanceof Object){var r=t.map.getLayers().filter((function(t){return e.name.includes(t.name)}))[t.map.getLayers().filter((function(t){return e.name.includes(t.name)})).length-1];t.map.removeLayers(r)}}else if(e.indexOf("*")>=0){var i=e.split("*")[3],o=t.map.getLayers().filter((function(e){return i.includes(e.name)}))[t.map.getLayers().filter((function(e){return i.includes(e.name)})).length-1];t.map.removeLayers(o)}else{var n=t.map.getLayers().filter((function(t){return e.includes(t.name)}))[t.map.getLayers().filter((function(t){return e.includes(t.name)})).length-1];t.map.removeLayers(n)}}))}},{key:"allLayerLoad",value:function(){return void 0!==this.layers[0].load&&(void 0!==this.layers[1].load||void 0===this.layers[2]||void 0===this.layers[3]||void 0!==this.layers[2].load&&void 0!==this.layers[3].load)}},{key:"transformToLayers",value:function(e){var t=e.map((function(e){var t=null;if(e instanceof Object){if(e instanceof Object){var r=this.map.getLayers().filter((function(t){return e.name.includes(t.name)}))[0];t=this.isValidLayer(r)?r:null}}else if(e.indexOf("*")>=0){var i=e.split("*");"WMS"==i[0].toUpperCase()?(t=new M.layer.WMS({url:i[2],name:i[3]}),this.map.getLayers().filter((function(e){return t.name.includes(e.name)})).length>0?t=this.map.getLayers().filter((function(e){return t.name.includes(e.name)}))[0]:this.map.addLayers(t)):"WMTS"==i[0].toUpperCase()&&(t=new M.layer.WMTS({url:i[1],name:i[2]}),this.map.addLayers(t))}else{var o=this.map.getLayers().filter((function(t){return e.includes(t.name)}))[0];t=this.isValidLayer(o)?o:null}if(null!==t)return null===t.getImpl().getOL3Layer()?setTimeout((function(){"WMS"===t.type?t.load=!0:"WMTS"===t.type&&(t.facadeLayer_.load=!0)}),1e3):t.load=!0,t.displayInLayerSwitcher=!1,t.setVisible(!1),t;this.layers.remove(e)}),this);return void 0===t[0]?[]:t}},{key:"isValidLayer",value:function(e){return"WMTS"===e.type||"WMS"===e.type}},{key:"equals",value:function(e){return e instanceof t}},{key:"getLayersNames",value:function(){return this.layers.map((function(e){return e.name}))}}])&&Ce(r.prototype,i),o&&Ce(r,o),t}();function Ve(e){return(Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Be(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function De(e,t){return!t||"object"!==Ve(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qe(e){return(qe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ae(e,t){return(Ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ie=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=De(this,qe(t).call(this))).name_="lyrcompare",e.error_=!1,e.layers=[],void 0===r.layers||r.layers.length<2?(M.dialog.error(f("no_layers_plugin"),"lyrcompare"),e.error_=!0):Array.isArray(r.layers)?e.layers=r.layers:e.layers=r.layers.split(","),e.controls_=[],e.map_=null,!1===e.error_&&(e.position="TR",e.collapsed=!0,e.collapsible=!0,e.staticDivision=void 0===r.staticDivision?1:parseInt(r.staticDivision),void 0===r.opacityVal?e.opacityVal=100:(e.opacityVal=parseInt(r.opacityVal),e.opacityVal<=0?e.opacityVal=0:e.opacityVal>=100&&(e.opacityVal=100)),void 0===r.comparisonMode?e.comparisonMode=0:(e.comparisonMode=parseInt(r.comparisonMode),(e.comparisonMode<=0||e.comparisonMode>3)&&(e.comparisonMode=0)),e.metadata_=q.metadata,e.tooltip_=r.tooltip||f("tooltip"),e.interface=void 0===r.interface||r.interface,void 0===r.defaultLyrA?e.defaultLyrA=0:e.defaultLyrA=parseInt(r.defaultLyrA),void 0===r.defaultLyrB?e.defaultLyrB=0!==e.defaultLyrA?0:1:e.defaultLyrB=parseInt(r.defaultLyrB),e.defaultLyrA===e.defaultLyrB&&(M.dialog.error(f("repeated_layers"),"lyrcompare"),e.error_=!0),void 0===r.defaultLyrC?e.defaultLyrC=2:e.defaultLyrC=parseInt(r.defaultLyrC),e.defaultLyrA!==e.defaultLyrC&&e.defaultLyrB!==e.defaultLyrC||(M.dialog.error(f("repeated_layers"),"lyrcompare"),e.error_=!0),void 0===r.defaultLyrD?e.defaultLyrD=3:e.defaultLyrD=parseInt(r.defaultLyrD),e.defaultLyrA!==e.defaultLyrD&&e.defaultLyrB!==e.defaultLyrD&&e.defaultLyrC!==e.defaultLyrD||(M.dialog.error(f("repeated_layers"),"lyrcompare"),e.error_=!0)),e}var r,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ae(e,t)}(t,M.Plugin),r=t,(i=[{key:"addTo",value:function(e){this.map_=e;var t={layers:this.layers,collapsible:this.collapsible,collapsed:this.collapsed,staticDivision:this.staticDivision,opacityVal:this.opacityVal,comparisonMode:this.comparisonMode,defaultLyrA:this.defaultLyrA,defaultLyrB:this.defaultLyrB,defaultLyrC:this.defaultLyrC,defaultLyrD:this.defaultLyrD,interface:this.interface};this.control_=new je(t),this.controls_.push(this.control_),this.error_?0!==e.getPlugins("lyrcompare").length&&e.removePlugins(e.getPlugins("lyrcompare")):(this.interface?this.panel_=new M.ui.Panel("panelLyrcompare",{collapsible:this.collapsible,collapsed:this.collapsed,position:M.ui.position[this.position],className:"m-plugin-lyrcompare",collapsedButtonClass:"cp-icon",tooltip:this.tooltip_}):this.panel_=new M.ui.Panel("panelLyrcompare",{collapsible:!1,collapsed:!0,position:M.ui.position[this.position],className:"m-plugin-lyrcompare-hidden"}),this.panel_.addControls(this.controls_),e.addPanels(this.panel_))}},{key:"destroy",value:function(){this.deactivate();var e=document.querySelector(".lyrcompare-swipe-control");e&&e.remove(),this.map_.removeControls([this.control_]),this.control_.removeCurtainLayers(this.control_.getLayersNames());var t=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];this.name_=t[0],this.error_=t[1],this.layers=t[2],this.controls_=t[3],this.map_=t[4],this.position=t[5],this.collapsed=t[6],this.collapsible=t[7],this.staticDivision=t[8],this.opacityVal=t[9],this.comparisonMode=t[10],this.metadata_=t[11],this.tooltip_=t[12],this.interface=t[13],this.defaultLyrA=t[14],this.defaultLyrB=t[15],this.defaultLyrC=t[16],this.defaultLyrD=t[17]}},{key:"getMetadata",value:function(){return this.metadata_}},{key:"getAPIRest",value:function(){return"".concat(this.name,"=").concat(this.position,"*!").concat(this.layers.join(","),"*!").concat(this.collapsible,"*!").concat(this.collapsed,"*!").concat(this.staticDivision,"*!").concat(this.opacityVal,"*!").concat(this.comparisonMode,"*!").concat(this.defaultLyrA,"*!").concat(this.defaultLyrB,"*!").concat(this.defaultLyrC,"*!").concat(this.defaultLyrD,"*!").concat(this.interface)}},{key:"activate",value:function(){this.control_.activateCurtain()}},{key:"deactivate",value:function(){this.control_.deactivateCurtain()}},{key:"equals",value:function(e){return e instanceof t}},{key:"name",get:function(){return this.name_}}])&&Be(r.prototype,i),o&&Be(r,o),t}();function Ee(e){return(Ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ze(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Te(e,t){return!t||"object"!==Ee(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xe(e){return(xe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Re(e,t){return(Re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ne=function(e){function t(e){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),M.utils.isUndefined(c)&&M.exception(f("exception"));var i=new c;return(r=Te(this,xe(t).call(this,i,"Comparepanel"))).template=null,r.baseLayers=e.baseLayers,r.layers=[],r.baseLayers.forEach((function(e){return r.layers.push(e[2])})),e.mirrorpanelParams.defaultBaseLyrs=r.layers,r.mirrorpanel=new x(e.mirrorpanelParams),e.timelineParams.intervals=r.baseLayers,r.timeline=new ae(e.timelineParams),e.lyrcompareParams.layers=r.layers,r.lyrcompare=new Ie(e.lyrcompareParams),r.plugins=[r.mirrorpanel,r.timeline,r.lyrcompare],r}var r,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Re(e,t)}(t,M.Control),r=t,(i=[{key:"createView",value:function(e){var t=this;return this.map=e,new Promise((function(r,i){var o={jsonp:!0,vars:{translations:{tooltipLyr:f("tooltipLyr"),tooltipMirrorpanel:f("tooltipMirrorpanel"),tooltipTimeline:f("tooltipTimeline")}}};t.template=M.template.compileSync(u.a,o),t.addComparators(e),r(t.template)}))}},{key:"addComparators",value:function(e){var t=this;this.plugins.forEach((function(r){e.addPlugin(r);var i=document.querySelector("."+r.panel_._className+" .m-panel-controls");i.classList.add("cp-"+r.name),document.querySelector("."+r.panel_._className).remove(),t.template.querySelector("#m-cp-"+r.name).append(i)})),this.addButtonEvents()}},{key:"addButtonEvents",value:function(){var e=this;this.plugins.forEach((function(t){e.template.querySelector("#m-cp-"+t.name+" .cp-button").addEventListener("click",(function(r){e.deactivateAndActivate(t)}))}))}},{key:"deactivateAndActivate",value:function(e){var t=this;this.plugins.forEach((function(r){r!=e&&(t.template.querySelector("#m-cp-"+r.name+" .cp-"+r.name).classList.remove("hide-panel"),t.template.querySelector("#m-cp-"+r.name+" .cp-button").classList.remove("active")),r.deactivate()})),this.template.querySelector("#m-cp-"+e.name+" .cp-button").classList.toggle("active"),this.template.querySelector("#m-cp-"+e.name+" .cp-"+e.name).classList.toggle("hide-panel")}},{key:"deactivate",value:function(){this.plugins.forEach((function(e){e.deactivate()}))}},{key:"equals",value:function(e){return e instanceof t}}])&&ze(r.prototype,i),o&&ze(r,o),t}();function Fe(e){return(Fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function He(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function We(e,t){return!t||"object"!==Fe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ke(e){return(Ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ue(e,t){return(Ue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ge=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=We(this,Ke(t).call(this))).name_="comparepanel",e.map_=null,e.controls_=[],e.className="m-plugin-comparepanel";return e.position=["TR","TL","BL","BR"].includes(r.position)?r.position:"TR",e.collapsed=r.collapsed,void 0===e.collapsed&&(e.collapsed=!0),e.collapsible=r.collapsible,void 0===e.collapsible&&(e.collapsible=!0),e.vertical=r.vertical,void 0===e.vertical&&(e.vertical=!0),e.baseLayers=r.baseLayers,e.mirrorpanelParams=r.mirrorpanelParams||{},e.timelineParams=r.timelineParams||{},e.lyrcompareParams=r.lyrcompareParams||{},e.metadata_=q.metadata,e.tooltip_=r.tooltip||f("tooltip"),e}var r,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ue(e,t)}(t,M.Plugin),r=t,(i=[{key:"addTo",value:function(e){this.control_=new Ne({baseLayers:this.baseLayers,mirrorpanelParams:this.mirrorpanelParams,timelineParams:this.timelineParams,lyrcompareParams:this.lyrcompareParams}),this.controls_.push(this.control_),this.map_=e,this.panel_=new M.ui.Panel("panelComparepanel",{collapsible:this.collapsible,collapsed:this.collapsed,position:M.ui.position[this.position],className:this.className,collapsedButtonClass:"cp-icon",tooltip:this.tooltip_}),this.panel_.addControls(this.controls_),e.addPanels(this.panel_),this.panel_._element.classList.add(this.vertical?"orientation-vertical":"orientation-horizontal")}},{key:"destroy",value:function(){this.control_.deactivate(),this.map_.removeControls([this.control_]);var e=[null,null,null];this.control_=e[0],this.panel_=e[1],this.map_=e[2]}},{key:"getMetadata",value:function(){return this.metadata_}},{key:"getAPIRest",value:function(){return"".concat(this.name,"=").concat(this.position)}},{key:"activate",value:function(){this.control_.activate()}},{key:"deactivate",value:function(){this.control_.deactivate()}},{key:"equals",value:function(e){return e instanceof t}},{key:"name",get:function(){return this.name_}}])&&He(r.prototype,i),o&&He(r,o),t}();window.M.plugin||(window.M.plugin={}),window.M.control||(window.M.control={}),window.M.impl||(window.M.impl={}),window.M.impl.control||(window.M.impl.control={}),window.M.plugin.Comparepanel=Ge,window.M.control.ComparepanelControl=Ne,window.M.plugin.LyrCompare=Ie,window.M.control.LyrCompareControl=je,window.M.plugin.Mirrorpanel=x,window.M.control.CompareMirrorpanel=D,window.M.plugin.Timeline=ae,window.M.control.TimelineControl=ee,window.M.impl.control.ComparepanelControl=c,window.M.impl.control.Lyrcomparecontrol=_e,window.M.impl.control.LyrcompareInteraction=me,window.M.impl.control.CompareMirrorpanel=S,window.M.impl.control.TimelineControl=U}]);
//# sourceMappingURL=comparepanel.ol.min.js.map
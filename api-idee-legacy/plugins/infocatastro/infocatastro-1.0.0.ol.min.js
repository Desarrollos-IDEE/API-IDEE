(()=>{var t={843:t=>{t.exports='<div class="m-control m-container m-infocatastro-container">\n    <button id=\'m-infocatastro-btn\' class="m-infocatastro-btn icon-posicion4" title="{{translations.consultar}}"></button>\n</div>'}},e={};function o(n){var r=e[n];if(void 0!==r)return r.exports;var a=e[n]={exports:{}};return t[n](a,a.exports,o),a.exports}o.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return o.d(e,{a:e}),e},o.d=(t,e)=>{for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,n(r.key),r)}}function n(e){var o=function(e,o){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,o||"default");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===o?String:Number)(e)}(e,"string");return"symbol"==t(o)?o:o+""}function r(e,o,n){return o=c(o),function(e,o){if(o&&("object"==t(o)||"function"==typeof o))return o;if(void 0!==o)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e)}(e,a()?Reflect.construct(o,n||[],c(e).constructor):o.apply(e,n))}function a(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(a=function(){return!!t})()}function i(){return i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,o){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(arguments.length<3?t:o):r.value}},i.apply(null,arguments)}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}var l=function(){function t(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r(this,t,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(t,IDEE.impl.Control),o=t,n=[{key:"addTo",value:function(e,o){var n,r,a,s,l;(n=t,r="addTo",a=this,l=i(c(1&(s=3)?n.prototype:n),r,a),2&s&&"function"==typeof l?function(t){return l.apply(a,t)}:l)([e,o])}}],n&&e(o.prototype,n),a&&e(o,a),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,n,a}(),u=o(843),f=o.n(u);const p=JSON.parse('{"tooltip":"Cadastre information","informacionCatastral":"Cadastre information","errorConexion":"It is not possible to establish a connection with the Cadastre server.","consultar":"Cadastre information","infocatastro_obsolete":"Message to the developer: IDEE.plugin.InfoCatastro has been deprecated, please use IDEE.plugin.Locator instead","description":"Description","reference":"Cadastral reference","noReference":"No reference","noInfo":"NO REFERENCES AVAILABLE FOR THESE COORDINATES ","exception":{"impl":"The implementation used cannot create InfoCatastro controls."}}'),d=JSON.parse('{"tooltip":"Consultar Catastro","informacionCatastral":"Información catastral","errorConexion":"No es posible establecer conexión con el servidor de Catastro.","consultar":"Consultar Catastro","infocatastro_obsolete":"Mensaje para el desarrollador: IDEE.plugin.InfoCatastro ha quedado obsoleto, utilice en su lugar IDEE.plugin.Locator","description":"Descripción","reference":"Referencia catastral","noReference":"No hay referencia","noInfo":"PARA ESAS COORDENADAS NO HAY REFERENCIA DISPONIBLE","exception":{"impl":"La implementación no puede crear controles de InfoCatastro."}}');var y={en:p,es:d},b=function(t){var e,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e="es","function"==typeof IDEE.language.getLang&&(e=IDEE.language.getLang()),e),n=function(t){return"es"===t||"en"===t?y[t]:IDEE.language.getTranslation(t).infocatastro}(o),r="";return IDEE.utils.isNullOrEmpty(n)?console.warn("The translation '".concat(o,"' has not been defined.")):r=t.split(".").reduce((function(t,e){return t[e]}),n),r};function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function v(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,E(n.key),n)}}function E(t){var e=function(t,e){if("object"!=m(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=m(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==m(e)?e:e+""}function h(t,e,o){return e=_(e),function(t,e){if(e&&("object"==m(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,g()?Reflect.construct(e,o||[],_(t).constructor):e.apply(t,o))}function g(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(g=function(){return!!t})()}function _(t){return _=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_(t)}function w(t,e){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},w(t,e)}var O=function(){function t(e){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),(IDEE.utils.isUndefined(l)||IDEE.utils.isObject(l)&&IDEE.utils.isNullOrEmpty(Object.keys(l)))&&IDEE.exception(b("exception.impl")),(o=h(this,t,[new l,"InfoCatastro"])).facadeMap_=null,o.element_=null,o.catastroWMS=e.url,o.tooltip=e.tooltip,o.POPUP_TITLE=b("informacionCatastral"),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&w(t,e)}(t,IDEE.Control),e=t,o=[{key:"createView",value:function(t){var e=this;return this.facadeMap_=t,console.warn(b("infocatastro_obsolete")),new Promise((function(t,o){var n=IDEE.template.compileSync(f(),{vars:{translations:{consultar:e.tooltip||b("consultar")}}});e.element_=n,e.element_.querySelector("#m-infocatastro-btn").addEventListener("click",e.activate.bind(e)),t(n)}))}},{key:"activate",value:function(){this.activated?this.deactivate():(this.facadeMap_.on(IDEE.evt.CLICK,this.buildUrl_,this),this.activated=!0,this.element_.querySelector("#m-infocatastro-btn").classList.add("activated"),document.addEventListener("keydown",this.checkEscKey.bind(this)))}},{key:"checkEscKey",value:function(t){"Escape"===t.key&&(this.deactivate(),document.removeEventListener("keydown",this.checkEscKey))}},{key:"deactivate",value:function(){this.facadeMap_.removePopup(),this.facadeMap_.un(IDEE.evt.CLICK,this.buildUrl_,this),this.activated=!1,this.element_.querySelector("#m-infocatastro-btn").classList.remove("activated")}},{key:"buildUrl_",value:function(t){var e=this,o=this.facadeMap_.getProjection().code;IDEE.remote.get(this.catastroWMS,{SRS:o,Coordenada_X:t.coord[0],Coordenada_Y:t.coord[1]}).then((function(o){e.showInfoFromURL_(o,t.coord)}),{jsonp:!0})}},{key:"showInfoFromURL_",value:function(t,e){var o=this;if(200===t.code&&!1===t.error){var n=[],r=t.text,a=this.formatInfo_(r);n.push(a);var i={icon:"g-cartografia-pin",title:this.POPUP_TITLE,content:n.join("")},c=this.facadeMap_.getPopup();if(IDEE.utils.isNullOrEmpty(c))(c=new IDEE.Popup).addTab(i),this.facadeMap_.addPopup(c,e);else if(c.getCoordinate()[0]===e[0]&&c.getCoordinate()[1]===e[1]){var s=!1;c.getTabs().forEach((function(t){t.title!==o.POPUP_TITLE?s=!0:c.removeTab(t)})),s?c.addTab(i):((c=new IDEE.Popup).addTab(i),this.facadeMap_.addPopup(c,e))}else(c=new IDEE.Popup).addTab(i),this.facadeMap_.addPopup(c,e)}else this.facadeMap_.removePopup(),IDEE.dialog.error(b("errorConexion"))}},{key:"formatInfo_",value:function(t){var e,o,n,r,a="",i=(new DOMParser).parseFromString(t,"text/xml").getElementsByTagName("consulta_coordenadas")[0];if("1"===i.getElementsByTagName("control")[0].getElementsByTagName("cuerr")[0].childNodes[0].nodeValue)o=b("noInfo");else{var c=i.getElementsByTagName("coordenadas")[0].getElementsByTagName("coord")[0],s=c.getElementsByTagName("pc")[0],l=s.getElementsByTagName("pc1")[0].childNodes[0].nodeValue,u=s.getElementsByTagName("pc2")[0].childNodes[0].nodeValue;n=l.substring(0,2),r=l.substring(2,5),e=c.getElementsByTagName("ldt")[0].childNodes[0].nodeValue,o=l+u,a="https://www1.sedecatastro.gob.es/CYCBienInmueble/OVCListaBienes.aspx?del==".concat(n,"&mun=").concat(r,"&rc1=").concat(l,"&rc2=").concat(u)}var f="".concat(IDEE.utils.beautifyAttribute(b("informacionCatastral")),"\n    <div class='divinfo'>\n    <table class='api-idee-table'>\n    <tbody>\n    <tr><td class='header' colspan='4'></td></tr>\n    <tr><td class='key'><b>").concat(IDEE.utils.beautifyAttribute(b("reference")),"</b></td><td class='value'></b>\n    <a href='").concat(a,"' target='_blank'>").concat(o,"</a></td></tr>\n    <tr><td class='key'><b>").concat(IDEE.utils.beautifyAttribute(b("description")),"</b></td>\n    <td class='value'>").concat(e,"</td></tr>\n    </tbody></table></div>");return o.toLowerCase().indexOf(b("noReference"))>-1&&(f="".concat(IDEE.utils.beautifyAttribute(b("informacionCatastral")),"\n      <div class='divinfo'>\n      <table class='api-idee-table'>\n      <tbody>\n      <tr><td class='header' colspan='4'></td></tr>\n      <tr><td class='key' colspan='4'><b>").concat(o,"</b></td></tr>\n      </tbody></table>\n      </div>")),f}},{key:"equals",value:function(e){return e instanceof t}}],o&&v(e.prototype,o),n&&v(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,o,n}();const I=JSON.parse('{"Pu":{"name":"InfoCatastro","description":"Muestra referencia catastral para un punto y provee de enlace a la información de la DGC","text":"Búsqueda catastral mediante click","version":"2.0.2","date":"09/12/2019","author":"Guadaltel","org":"CNIG","tags":"api-idee,plugin","icon":"./facade/assets/icons/icon.svg"}}');function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function C(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,D(n.key),n)}}function D(t){var e=function(t,e){if("object"!=P(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=P(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==P(e)?e:e+""}function S(t,e,o){return e=T(e),function(t,e){if(e&&("object"==P(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,j()?Reflect.construct(e,o||[],T(t).constructor):e.apply(t,o))}function j(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(j=function(){return!!t})()}function T(t){return T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},T(t)}function N(t,e){return N=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},N(t,e)}var k=function(){function t(e){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),(o=S(this,t)).map_=null,o.controls_=[],o.position_=e.position||"TR",o.tooltip_=e.tooltip||b("tooltip"),o.catastroWMS=e.catastroWMS||"https://ovc.catastro.meh.es/ovcservweb/OVCSWLocalizacionRC/OVCCoordenadas.asmx/Consulta_RCCOOR",o.metadata_=I.Pu,o.name_="infocatastro",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&N(t,e)}(t,IDEE.Plugin),e=t,n=[{key:"getJSONTranslations",value:function(t){return"en"===t||"es"===t?"en"===t?p:d:IDEE.language.getTranslation(t).infocatastro}}],(o=[{key:"addTo",value:function(t){this.controls_.push(new O({url:this.catastroWMS,tooltip:this.tooltip_})),this.map_=t,this.panel_=new IDEE.ui.Panel("panelInfoCatastro",{className:"m-plugin-catastro",position:IDEE.ui.position[this.position_],tooltip:this.tooltip_,collapsedButtonClass:"icon-posicion4"}),this.panel_.addControls(this.controls_),t.addPanels(this.panel_);var e=this;this.controls_[0].on(IDEE.evt.ADDED_TO_MAP,(function(){e.fire(IDEE.evt.ADDED_TO_MAP)}))}},{key:"name",get:function(){return"infocatastro"}},{key:"position",get:function(){return this.position_}},{key:"getAPIRest",value:function(){return"".concat(this.name_,"=").concat(this.position_,"*").concat(this.tooltip_,"*").concat(this.catastroWMS)}},{key:"equals",value:function(e){return e instanceof t}},{key:"getMetadata",value:function(){return this.metadata_}},{key:"destroy",value:function(){this.map_.removeControls(this.controls_);var t=[null,null,null];this.map_=t[0],this.controls_=t[1],this.panel_=t[2]}}])&&C(e.prototype,o),n&&C(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,o,n}();window.IDEE.plugin||(window.IDEE.plugin={}),window.IDEE.control||(window.IDEE.control={}),window.IDEE.impl||(window.IDEE.impl={}),window.IDEE.impl.control||(window.IDEE.impl.control={}),window.IDEE.plugin.InfoCatastro=k,window.IDEE.control.InfoCatastroControl=O,window.IDEE.impl.control.InfoCatastroControl=l})()})();
//# sourceMappingURL=infocatastro-1.0.0.ol.min.js.map
(()=>{var t={970:t=>{t.exports='<div id="m-beautytoc-container" class="m-control m-container m-beautytoc-container m-beautytoc">\n    <div class="m-beautytoc-panel" id="m-beautytoc-panel">\n        <div class="title">{{translations.layers}}</div>\n        <ul class="m-beautytoc-content">\n            <div class="vector-container">\n                <p>{{translations.vectoriallayers}}</p>\n                {{#each layers}}\n                    {{#if isOrtofoto }}\n                    {{else}}\n                        <li class="{{#if disabled}}disabled{{/if}} {{#if visible}}visible{{/if}}">\n                            <table class="{{#if visible}}active{{^}}{{/if}}">\n                                <tbody>\n                                    <tr>\n                                        <td class="m-title"><span>{{title}}</span></td>\n                                        <td class="m-beautytoc-eye"><span data-layer-name="{{id}}" class="{{#if visible}}icon-eye active{{^}}icon-eye-off{{/if}}"></span></td>\n                                    </tr>\n                                </tbody>\n                            </table>\n                        </li>\n                    {{/if}}\n                {{/each}}\n            </div>\n            <div class="historic-container">\n                <p>{{translations.ortofotos}}</p>\n                {{#each layers}}\n                    {{#if isOrtofoto }}\n                        <li class="{{#if disabled}}disabled{{/if}} {{#if visible}}visible{{/if}}">\n                            <table class="{{#if visible}}active{{^}}{{/if}}">\n                                <tbody>\n                                    <tr>\n                                        <td class="m-title"><span>{{title}}</span></td>\n                                        <td class="m-beautytoc-eye"><span data-layer-name="{{id}}" class="{{#if visible}}icon-eye active{{^}}icon-eye-off{{/if}}"></span></td>\n                                    </tr>\n                                </tbody>\n                            </table>\n                        </li>\n                    {{/if}}\n                {{/each}}\n            </div>\n        </ul>\n    </div>\n</div>'}},e={};function n(o){var r=e[o];if(void 0!==r)return r.exports;var i=e[o]={exports:{}};return t[o](i,i.exports,n),i.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";const t=JSON.parse('{"Pu":{"name":"BeautyTOC","description":"Table of contents of the map. Pretty design version","text":"Tabla de contenidos de fototeca. Consulta cobertura de vuelo sobre la vista","version":"2.0.2","date":"18/11/2019","author":"Guadaltel","org":"CNIG","tags":"api-idee,plugin","icon":"./facade/assets/icons/icons.svg"}}');function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,r(o.key),o)}}function r(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,n||"default");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==e(n)?n:n+""}function i(t,n,o){return n=l(n),function(t,n){if(n&&("object"==e(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,a()?Reflect.construct(n,o||[],l(t).constructor):n.apply(t,o))}function a(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(a=function(){return!!t})()}function c(){return c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var o=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},c.apply(null,arguments)}function l(t){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},l(t)}function u(t,e){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},u(t,e)}var s=function(){function t(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),i(this,t,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e)}(t,IDEE.impl.Control),e=t,n=[{key:"addTo",value:function(e,n){var o,r,i,a,u;(o=t,r="addTo",i=this,u=c(l(1&(a=3)?o.prototype:o),r,i),2&a&&"function"==typeof u?function(t){return u.apply(i,t)}:u)([e,n])}},{key:"setScale",value:function(t){var e=[559082264.0287178,279541132.0143589,139770566.0071794,69885283.00358972,34942641.50179486,17471320.75089743,8735660.375448715,4367830.187724357,2183915.093862179,1091957.546931089,545978.7734655447,272989.3867327723,136494.6933663862,68247.34668319309,34123.67334159654,17061.83667079827,8530.918335399136,4265.459167699568,2132.729583849784],n=e.reduce((function(e,n){return Math.abs(n-t)<Math.abs(e-t)?n:e})),o=[156543.033928041,78271.51696402048,39135.75848201023,19567.87924100512,9783.93962050256,4891.96981025128,2445.98490512564,1222.99245256282,611.49622628141,305.7481131407048,152.8740565703525,76.43702828517624,38.21851414258813,19.10925707129406,9.554628535647032,4.777314267823516,2.388657133911758,1.194328566955879,.5971642834779395][e.indexOf(n)];this.facadeMap_.getMapImpl().getView().setResolution(o)}},{key:"reproject",value:function(t,e,n){return ol.proj.getTransform(e,n)(t)}},{key:"isLayerLoaded",value:function(t){return null!==t.getImpl().getLayer()&&null!==t.getImpl().getLayer().getSource()}},{key:"isLayerAvailable",value:function(t){var e=t.getImpl().getLayer().getExtent(),n=this.facadeMap_.getBbox();return ol.extent.intersects([n.x.min,n.y.min,n.x.max,n.y.max],e)}}],n&&o(e.prototype,n),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,r}(),f=n(970),p=n.n(f);const y=JSON.parse('{"exception":{"impl":"The implementation used cannot create BeatuyTOC controls.","cobertura":"Checking coverage in the area...","nocobertura":"This layer has no coverage in this area"},"tooltip":"Additional Layers","layers":"Additional Layers","vectoriallayers":"Vectorial layers","ortofotos":"Orthophotos","warning":"WARNING"}'),b=JSON.parse('{"exception":{"impl":"La implementaciÃ³n no puede crear controles de BeatuyTOC.","cobertura":"Comprobando cobertura en la zona...","nocobertura":"Esta capa no tiene cobertura en esta zona"},"tooltip":"Capas Adicionales","layers":"Capas Adicionales","vectoriallayers":"Capas vectoriales","ortofotos":"Ortofotos","warning":"AVISO"}');var d={en:y,es:b},v=function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e="es","function"==typeof IDEE.language.getLang&&(e=IDEE.language.getLang()),e),o=function(t){return"es"===t||"en"===t?d[t]:IDEE.language.getTranslation(t).beautytoc}(n),r="";return IDEE.utils.isNullOrEmpty(o)?console.warn("The translation '".concat(n,"' has not been defined.")):r=t.split(".").reduce((function(t,e){return t[e]}),o),r};function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function g(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,h(o.key),o)}}function h(t){var e=function(t,e){if("object"!=m(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=m(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==m(e)?e:e+""}function E(t,e,n){return e=S(e),function(t,e){if(e&&("object"==m(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,O()?Reflect.construct(e,n||[],S(t).constructor):e.apply(t,n))}function O(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(O=function(){return!!t})()}function w(t,e,n,o){var r=T(S(1&o?t.prototype:t),e,n);return 2&o&&"function"==typeof r?function(t){return r.apply(n,t)}:r}function T(){return T="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var o=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=S(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},T.apply(null,arguments)}function S(t){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},S(t)}function _(t,e){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_(t,e)}var I=function(t,e,n,o){var r=t.querySelectorAll(e);Array.prototype.forEach.call(r,(function(t){return t.addEventListener(n,(function(t){return o(t)}))}))},j=function(){function t(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),(IDEE.utils.isUndefined(s)||IDEE.utils.isObject(s)&&IDEE.utils.isNullOrEmpty(Object.keys(s)))&&IDEE.exception(v("exception.impl")),E(this,t,[new s,"BeautyTOC"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_(t,e)}(t,IDEE.Control),e=t,n=[{key:"createView",value:function(t){var e=this;return this.map_=t,new Promise((function(t,n){var o=e.getTemplateVariables(),r=IDEE.template.compileSync(p(),{vars:o});e.panelHTML_=r,t(r),I(e.panelHTML_,"li","click",(function(t){return e.toogleVisible(t)}))}))}},{key:"getTemplateVariables",value:function(){return{layers:this.map_.getWMS().concat(this.map_.getWMTS()).filter((function(t){return!1!==t.transparent&&!0===t.displayInLayerSwitcher})).map((function(t){return{visible:t instanceof IDEE.layer.WMTS?!0===t.options.visibility:t.isVisible(),id:t.name,title:t.legend||t.name,type:t.type,url:t.url,isOrtofoto:"https://www.ign.es/wms/pnoa-historico?"===t.url}})),translations:{layers:v("layers"),vectoriallayers:v("vectoriallayers"),ortofotos:v("ortofotos")}}}},{key:"getLayerDisabled",value:function(t){var e=!1;return this.getImpl().isLayerLoaded(t)&&(e=e||!t.inRange()||!this.getImpl().isLayerAvailable(t)),e}},{key:"render",value:function(t){var e=this,n=this.getTemplateVariables(),o=IDEE.template.compileSync(p(),{vars:n});this.panelHTML_.innerHTML=o.innerHTML,I(this.panelHTML_,"li","click",(function(t){return e.toogleVisible(t)})),void 0!==t&&(document.querySelector("#m-beautytoc-panel").scrollTop=t)}},{key:"toogleVisible",value:function(t){var e=this,n=this.map_.getBbox(),o=[n.x.min,n.y.min,n.x.max,n.y.max],r=document.querySelector("#m-beautytoc-panel").scrollTop,i=t.currentTarget.querySelector(".m-beautytoc-eye span").dataset.layerName,a=this.map_.getLayers({name:i}).filter((function(t){return t.displayInLayerSwitcher})),c=a.length>0?a[0]:null;if(null===c||"https://www.ign.es/wms/pnoa-historico?"!==c.url||c.isVisible()){if(null!==c){var l=c instanceof IDEE.layer.WMTS?c.options.visibility:c.isVisible();c.setVisible(!l),c.options.visibility=!l,this.render(r)}}else{var u=document.querySelector(".m-api-idee-container").offsetWidth,s=document.querySelector(".m-api-idee-container").offsetHeight,f=c.url.concat("SERVICE=WMS&VERSION=").concat(c.version).concat("&REQUEST=GetMap&FORMAT=image/png&TRANSPARENT=true&LAYERS=").concat(c.name).concat("&TILED=true&CRS=").concat(this.map_.getProjection().code).concat("&STYLES=&WIDTH=").concat(u).concat("&HEIGHT=").concat(s).concat("&BBOX=").concat(o.join(","));IDEE.dialog.info(v("exception.cobertura")),setTimeout((function(){document.querySelector("div.m-dialog > div > div > div.m-button").innerHTML=""}),10),IDEE.proxy(!1),IDEE.remote.get(f).then((function(t){IDEE.proxy(!0);var n=Buffer.from(t.text).toString("base64"),o=document.createElement("img");if(o.src="data:image/png;base64,".concat(n),o.outerHTML.length>u*s/100){var i=document.querySelectorAll("div.m-dialog");Array.prototype.forEach.call(i,(function(t){t.parentElement.removeChild(t)}));var a=c instanceof IDEE.layer.WMTS?c.options.visibility:c.isVisible();c.setVisible(!a),c.options.visibility=!a,e.render(r)}else setTimeout((function(){IDEE.dialog.error(v("exception.nocobertura"),v("warning"))}),10)})).catch((function(t){IDEE.proxy(!0)}))}}},{key:"activate",value:function(){w(t,"activate",this,3)([])}},{key:"deactivate",value:function(){w(t,"deactivate",this,3)([])}},{key:"getActivationButton",value:function(t){return t.querySelector(".m-beautytoc button")}},{key:"equals",value:function(e){return e instanceof t}}],n&&g(e.prototype,n),o&&g(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,o}();function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function D(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,x(o.key),o)}}function x(t){var e=function(t,e){if("object"!=P(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=P(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==P(e)?e:e+""}function L(t,e,n){return e=R(e),function(t,e){if(e&&("object"==P(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,k()?Reflect.construct(e,n||[],R(t).constructor):e.apply(t,n))}function k(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(k=function(){return!!t})()}function R(t){return R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},R(t)}function C(t,e){return C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},C(t,e)}var M=function(){function e(){var n,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=L(this,e)).map_=null,n.controls_=[],n.position_=o.position||"TR",n.collapsed_=!0===o.collapsed,n.metadata_=t.Pu,n.tooltip_=o.tooltip||v("tooltip"),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&C(t,e)}(e,IDEE.Plugin),n=e,r=[{key:"getJSONTranslations",value:function(t){return"en"===t||"es"===t?"en"===t?y:b:IDEE.language.getTranslation(t).beautytoc}}],(o=[{key:"addTo",value:function(t){var e=this;this.control=new j,this.map_=t,this.panel_=new IDEE.ui.Panel("panelBeautyTOC",{collapsible:!0,position:IDEE.ui.position[this.position_],collapsedButtonClass:"icon-capas2",className:"m-plugin-beautytoc",tooltip:this.tooltip_,collapsed:this.collapsed_}),this.panel_.addControls([this.control]),t.addPanels(this.panel_),t.on(IDEE.evt.ADDED_LAYER,(function(){e.control.render()})),t.on(IDEE.evt.COMPLETED,(function(){e.control.render()}))}},{key:"position",get:function(){return this.position_}},{key:"name",get:function(){return"beautytoc"}},{key:"collapsed",get:function(){return this.panel_.isCollapsed()}},{key:"getAPIRest",value:function(){return"".concat(this.name,"=").concat(this.position,"*").concat(this.collapsed)}},{key:"equals",value:function(t){return t instanceof e}},{key:"getMetadata",value:function(){return this.metadata_}},{key:"destroy",value:function(){this.map_.removeControls(this.control);var t=[null,null,null];this.map_=t[0],this.control=t[1],this.panel_=t[2]}}])&&D(n.prototype,o),r&&D(n,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,o,r}();window.IDEE.plugin||(window.IDEE.plugin={}),window.IDEE.control||(window.IDEE.control={}),window.IDEE.plugin.BeautyTOC=M,window.IDEE.control.BeautyTOCControl=j})()})();
//# sourceMappingURL=beautytoc.ol.min.js.map